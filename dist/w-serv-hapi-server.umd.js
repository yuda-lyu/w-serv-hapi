/*!
 * w-serv-hapi-server v1.0.35
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("@hapi/hapi"),require("@hapi/inert"),require("path"),require("fs"),require("stream"),require("crypto"),require("worker_threads")):"function"==typeof define&&define.amd?define(["@hapi/hapi","@hapi/inert","path","fs","stream","crypto","worker_threads"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["w-serv-hapi-server"]=t(e["@hapi/hapi"],e["@hapi/inert"],e.path,e.fs,e.stream,e.crypto,e.require$$0)}(this,(function(e,t,n,r,o,i,c){"use strict";var a=Array.isArray,u="object"==typeof global&&global&&global.Object===Object&&global,l="object"==typeof self&&self&&self.Object===Object&&self,s=u||l||Function("return this")(),d=s.Symbol,f=Object.prototype,g=f.hasOwnProperty,p=f.toString,I=d?d.toStringTag:void 0;var h=Object.prototype.toString;var y="[object Null]",C="[object Undefined]",m=d?d.toStringTag:void 0;function b(e){return null==e?void 0===e?C:y:m&&m in Object(e)?function(e){var t=g.call(e,I),n=e[I];try{e[I]=void 0;var r=!0}catch(e){}var o=p.call(e);return r&&(t?e[I]=n:delete e[I]),o}(e):function(e){return h.call(e)}(e)}function v(e){return null!=e&&"object"==typeof e}var A="[object Symbol]";function Z(e){return"symbol"==typeof e||v(e)&&b(e)==A}var X=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,K=/^\w*$/;function w(e,t){if(a(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Z(e))||(K.test(e)||!X.test(e)||null!=t&&e in Object(t))}function j(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var W="[object AsyncFunction]",G="[object Function]",S="[object GeneratorFunction]",H="[object Proxy]";function V(e){if(!j(e))return!1;var t=b(e);return t==G||t==S||t==W||t==H}var x,T=s["__core-js_shared__"],Y=(x=/[^.]+$/.exec(T&&T.keys&&T.keys.IE_PROTO||""))?"Symbol(src)_1."+x:"";var J=Function.prototype.toString;function B(e){if(null!=e){try{return J.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var O=/^\[object .+?Constructor\]$/,k=Function.prototype,R=Object.prototype,N=k.toString,P=R.hasOwnProperty,Q=RegExp("^"+N.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function L(e){return!(!j(e)||(t=e,Y&&Y in t))&&(V(e)?Q:O).test(B(e));var t}function _(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return L(n)?n:void 0}var F=_(Object,"create");var U=Object.prototype.hasOwnProperty;var M=Object.prototype.hasOwnProperty;function z(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function E(e,t){return e===t||e!=e&&t!=t}function D(e,t){for(var n=e.length;n--;)if(E(e[n][0],t))return n;return-1}z.prototype.clear=function(){this.__data__=F?F(null):{},this.size=0},z.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},z.prototype.get=function(e){var t=this.__data__;if(F){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return U.call(t,e)?t[e]:void 0},z.prototype.has=function(e){var t=this.__data__;return F?void 0!==t[e]:M.call(t,e)},z.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=F&&void 0===t?"__lodash_hash_undefined__":t,this};var $=Array.prototype.splice;function q(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}q.prototype.clear=function(){this.__data__=[],this.size=0},q.prototype.delete=function(e){var t=this.__data__,n=D(t,e);return!(n<0)&&(n==t.length-1?t.pop():$.call(t,n,1),--this.size,!0)},q.prototype.get=function(e){var t=this.__data__,n=D(t,e);return n<0?void 0:t[n][1]},q.prototype.has=function(e){return D(this.__data__,e)>-1},q.prototype.set=function(e,t){var n=this.__data__,r=D(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var ee=_(s,"Map");function te(e,t){var n,r,o=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof t?"string":"hash"]:o.map}function ne(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ne.prototype.clear=function(){this.size=0,this.__data__={hash:new z,map:new(ee||q),string:new z}},ne.prototype.delete=function(e){var t=te(this,e).delete(e);return this.size-=t?1:0,t},ne.prototype.get=function(e){return te(this,e).get(e)},ne.prototype.has=function(e){return te(this,e).has(e)},ne.prototype.set=function(e,t){var n=te(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var re="Expected a function";function oe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(re);var n=function(){var r=arguments,o=t?t.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var c=e.apply(this,r);return n.cache=i.set(o,c)||i,c};return n.cache=new(oe.Cache||ne),n}oe.Cache=ne;var ie,ce,ae,ue=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,le=/\\(\\)?/g,se=(ie=function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ue,(function(e,n,r,o){t.push(r?o.replace(le,"$1"):n||e)})),t},ce=oe(ie,(function(e){return 500===ae.size&&ae.clear(),e})),ae=ce.cache,ce),de=se;function fe(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o}var ge=1/0,pe=d?d.prototype:void 0,Ie=pe?pe.toString:void 0;function he(e){if("string"==typeof e)return e;if(a(e))return fe(e,he)+"";if(Z(e))return Ie?Ie.call(e):"";var t=e+"";return"0"==t&&1/e==-ge?"-0":t}function ye(e){return null==e?"":he(e)}function Ce(e,t){return a(e)?e:w(e,t)?[e]:de(ye(e))}var me=1/0;function be(e){if("string"==typeof e||Z(e))return e;var t=e+"";return"0"==t&&1/e==-me?"-0":t}function ve(e,t){for(var n=0,r=(t=Ce(t,e)).length;null!=e&&n<r;)e=e[be(t[n++])];return n&&n==r?e:void 0}function Ae(e,t,n){var r=null==e?void 0:ve(e,t);return void 0===r?n:r}var Ze="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Xe={};!function(e,t){e.exports=function(){var e=1e3,t=6e4,n=36e5,r="millisecond",o="second",i="minute",c="hour",a="day",u="week",l="month",s="quarter",d="year",f="date",g="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,I=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},y=function(e,t,n){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(n)+e},C={s:y,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),r=Math.floor(n/60),o=n%60;return(t<=0?"+":"-")+y(r,2,"0")+":"+y(o,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var r=12*(n.year()-t.year())+(n.month()-t.month()),o=t.clone().add(r,l),i=n-o<0,c=t.clone().add(r+(i?-1:1),l);return+(-(r+(n-o)/(i?o-c:c-o))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:l,y:d,w:u,d:a,D:f,h:c,m:i,s:o,ms:r,Q:s}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},m="en",b={};b[m]=h;var v="$isDayjsObject",A=function(e){return e instanceof w||!(!e||!e[v])},Z=function e(t,n,r){var o;if(!t)return m;if("string"==typeof t){var i=t.toLowerCase();b[i]&&(o=i),n&&(b[i]=n,o=i);var c=t.split("-");if(!o&&c.length>1)return e(c[0])}else{var a=t.name;b[a]=t,o=a}return!r&&o&&(m=o),o||!r&&m},X=function(e,t){if(A(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new w(n)},K=C;K.l=Z,K.i=A,K.w=function(e,t){return X(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var w=function(){function h(e){this.$L=Z(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[v]=!0}var y=h.prototype;return y.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(K.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(p);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(t)}(e),this.init()},y.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},y.$utils=function(){return K},y.isValid=function(){return!(this.$d.toString()===g)},y.isSame=function(e,t){var n=X(e);return this.startOf(t)<=n&&n<=this.endOf(t)},y.isAfter=function(e,t){return X(e)<this.startOf(t)},y.isBefore=function(e,t){return this.endOf(t)<X(e)},y.$g=function(e,t,n){return K.u(e)?this[t]:this.set(n,e)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(e,t){var n=this,r=!!K.u(t)||t,s=K.p(e),g=function(e,t){var o=K.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return r?o:o.endOf(a)},p=function(e,t){return K.w(n.toDate()[e].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},I=this.$W,h=this.$M,y=this.$D,C="set"+(this.$u?"UTC":"");switch(s){case d:return r?g(1,0):g(31,11);case l:return r?g(1,h):g(0,h+1);case u:var m=this.$locale().weekStart||0,b=(I<m?I+7:I)-m;return g(r?y-b:y+(6-b),h);case a:case f:return p(C+"Hours",0);case c:return p(C+"Minutes",1);case i:return p(C+"Seconds",2);case o:return p(C+"Milliseconds",3);default:return this.clone()}},y.endOf=function(e){return this.startOf(e,!1)},y.$set=function(e,t){var n,u=K.p(e),s="set"+(this.$u?"UTC":""),g=(n={},n[a]=s+"Date",n[f]=s+"Date",n[l]=s+"Month",n[d]=s+"FullYear",n[c]=s+"Hours",n[i]=s+"Minutes",n[o]=s+"Seconds",n[r]=s+"Milliseconds",n)[u],p=u===a?this.$D+(t-this.$W):t;if(u===l||u===d){var I=this.clone().set(f,1);I.$d[g](p),I.init(),this.$d=I.set(f,Math.min(this.$D,I.daysInMonth())).$d}else g&&this.$d[g](p);return this.init(),this},y.set=function(e,t){return this.clone().$set(e,t)},y.get=function(e){return this[K.p(e)]()},y.add=function(r,s){var f,g=this;r=Number(r);var p=K.p(s),I=function(e){var t=X(g);return K.w(t.date(t.date()+Math.round(e*r)),g)};if(p===l)return this.set(l,this.$M+r);if(p===d)return this.set(d,this.$y+r);if(p===a)return I(1);if(p===u)return I(7);var h=(f={},f[i]=t,f[c]=n,f[o]=e,f)[p]||1,y=this.$d.getTime()+r*h;return K.w(y,this)},y.subtract=function(e,t){return this.add(-1*e,t)},y.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||g;var r=e||"YYYY-MM-DDTHH:mm:ssZ",o=K.z(this),i=this.$H,c=this.$m,a=this.$M,u=n.weekdays,l=n.months,s=n.meridiem,d=function(e,n,o,i){return e&&(e[n]||e(t,r))||o[n].slice(0,i)},f=function(e){return K.s(i%12||12,e,"0")},p=s||function(e,t,n){var r=e<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(I,(function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return K.s(t.$y,4,"0");case"M":return a+1;case"MM":return K.s(a+1,2,"0");case"MMM":return d(n.monthsShort,a,l,3);case"MMMM":return d(l,a);case"D":return t.$D;case"DD":return K.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(n.weekdaysMin,t.$W,u,2);case"ddd":return d(n.weekdaysShort,t.$W,u,3);case"dddd":return u[t.$W];case"H":return String(i);case"HH":return K.s(i,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return p(i,c,!0);case"A":return p(i,c,!1);case"m":return String(c);case"mm":return K.s(c,2,"0");case"s":return String(t.$s);case"ss":return K.s(t.$s,2,"0");case"SSS":return K.s(t.$ms,3,"0");case"Z":return o}return null}(e)||o.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(r,f,g){var p,I=this,h=K.p(f),y=X(r),C=(y.utcOffset()-this.utcOffset())*t,m=this-y,b=function(){return K.m(I,y)};switch(h){case d:p=b()/12;break;case l:p=b();break;case s:p=b()/3;break;case u:p=(m-C)/6048e5;break;case a:p=(m-C)/864e5;break;case c:p=m/n;break;case i:p=m/t;break;case o:p=m/e;break;default:p=m}return g?p:K.a(p)},y.daysInMonth=function(){return this.endOf(l).$D},y.$locale=function(){return b[this.$L]},y.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),r=Z(e,t,!0);return r&&(n.$L=r),n},y.clone=function(){return K.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},h}(),j=w.prototype;return X.prototype=j,[["$ms",r],["$s",o],["$m",i],["$H",c],["$W",a],["$M",l],["$y",d],["$D",f]].forEach((function(e){j[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),X.extend=function(e,t){return e.$i||(e(t,w,X),e.$i=!0),X},X.locale=Z,X.isDayjs=A,X.unix=function(e){return X(1e3*e)},X.en=b[m],X.Ls=b,X.p={},X}()}({get exports(){return Xe},set exports(e){Xe=e}});var Ke=Xe;function we(e){let t=Object.prototype.toString.call(e);return"[object Function]"===t||"[object AsyncFunction]"===t}function je(){if(!we(Ke))throw new Error("invalid dayjs");return Ke().format("YYYY-MM-DDTHH:mm:ssZ")}var We=/\s/;var Ge=/^\s+/;function Se(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&We.test(e.charAt(t)););return t}(e)+1).replace(Ge,""):e}var He=NaN,Ve=/^[-+]0x[0-9a-f]+$/i,xe=/^0b[01]+$/i,Te=/^0o[0-7]+$/i,Ye=parseInt;function Je(e){if("number"==typeof e)return e;if(Z(e))return He;if(j(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=j(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Se(e);var n=xe.test(e);return n||Te.test(e)?Ye(e.slice(2),n?2:8):Ve.test(e)?He:+e}var Be=1/0,Oe=17976931348623157e292;function ke(e){return e?(e=Je(e))===Be||e===-Be?(e<0?-1:1)*Oe:e==e?e:0:0===e?e:0}function Re(e){var t=ke(e),n=t%1;return t==t?n?t-n:t:0}function Ne(e){return"[object String]"===Object.prototype.toString.call(e)}function Pe(e){return!(!Ne(e)||""===e)}function Qe(e){return e!=e}function Le(e){let t=!1;if(Pe(e))t=!isNaN(Number(e));else if(function(e){return"[object Number]"===Object.prototype.toString.call(e)}(e)){if(Qe(e))return!1;t=!0}return t}function _e(e){if(!Le(e))return 0;return ke(e)}function Fe(e){return!!Le(e)&&(e=_e(e),"number"==typeof(t=e)&&t==Re(t));var t}var Ue=s.isFinite,Me=Math.min;var ze=function(e){var t=Math[e];return function(e,n){if(e=Je(e),(n=null==n?0:Me(Re(n),292))&&Ue(e)){var r=(ye(e)+"e").split("e");return+((r=(ye(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}("round"),Ee=ze;function De(e){if(!Le(e))return 0;e=_e(e);let t=Ee(e);return"0"===String(t)?0:t}function $e(e){if(!Fe(e))return!1;return De(e)>0}let qe="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),et=qe.length;function tt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,t=[];e=$e(e)?De(e):32;for(let n=0;n<e;n++)t[n]=qe[0|Math.random()*et];return t.join("")}function nt(e){return"[object Array]"===Object.prototype.toString.call(e)}function rt(e){return"[object Undefined]"===Object.prototype.toString.call(e)}function ot(e){return"[object Object]"===Object.prototype.toString.call(e)}function it(e){if(ot(e)){for(let t in e)return!1;return!0}return!1}function ct(e){return!!rt(e)||(!!function(e){return"[object Null]"===Object.prototype.toString.call(e)}(e)||(!!it(e)||(!!function(e){return!(!Ne(e)||""!==e)}(e)||(!!function(e){return!!nt(e)&&0===e.length}(e)||!!Qe(e)))))}function at(e){return!!nt(e)&&(0!==e.length&&(1!==e.length||!ct(e[0])))}var ut="[object Boolean]";function lt(e){return!0===(t=e)||!1===t||v(t)&&b(t)==ut;var t}var st={};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,c),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,c){var a=n?n+e:e;if(!this._events[a])return!1;var u,l,s=this._events[a],d=arguments.length;if(s.fn){switch(s.once&&this.removeListener(e,s.fn,void 0,!0),d){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,t),!0;case 3:return s.fn.call(s.context,t,r),!0;case 4:return s.fn.call(s.context,t,r,o),!0;case 5:return s.fn.call(s.context,t,r,o,i),!0;case 6:return s.fn.call(s.context,t,r,o,i,c),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];s.fn.apply(s.context,u)}else{var f,g=s.length;for(l=0;l<g;l++)switch(s[l].once&&this.removeListener(e,s[l].fn,void 0,!0),d){case 1:s[l].fn.call(s[l].context);break;case 2:s[l].fn.call(s[l].context,t);break;case 3:s[l].fn.call(s[l].context,t,r);break;case 4:s[l].fn.call(s[l].context,t,r,o);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];s[l].fn.apply(s[l].context,u)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||c(this,i);else{for(var u=0,l=[],s=a.length;u<s;u++)(a[u].fn!==t||o&&!a[u].once||r&&a[u].context!==r)&&l.push(a[u]);l.length?this._events[i]=1===l.length?l[0]:l:c(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&c(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}({get exports(){return st},set exports(e){st=e}});var dt=st;function ft(){return new dt}function gt(){let e,t,n=new Promise((function(){e=arguments[0],t=arguments[1]}));return n.resolve=e,n.reject=t,n}function pt(e){let t,n=Object.prototype.toString.call(e);if(t="[object Promise]"===n,t)return!0;if("[object Function]"!==n)return!1;try{t="function"!=typeof e.subscribe&&"function"==typeof e.then}catch(e){}return t}async function It(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=gt();if(!we(e))return r.reject("waitfunction需輸入函數f"),r;let o=async()=>{let t=e();return pt(t)&&(t=await t),t};if(n=await o(),!0===n)return r.resolve(),r;let i=Ae(t,"attemptNum",null);$e(i)||(i=200);let c=Ae(t,"timeInterval",null);$e(c)||(c=1e3);let a=0,u=setInterval((async()=>{a+=1,n=await o(),!0===n&&(clearInterval(u),r.resolve()),a>i&&(clearInterval(u),r.reject(`exceeded attemptNum[${i}]`))}),c);return r}var ht="[object Number]";function yt(e){return"number"==typeof e||v(e)&&b(e)==ht}function Ct(e){if(ot(e)){for(let t in e)return!0;return!1}return!1}function mt(e){if(!Fe(e))return!1;return De(e)>=0}function bt(e){if(!Pe(e)&&!Le(e)&&!Z(e))return"";let t="";try{t=String(e)}catch(e){}try{t=e.toString()}catch(e){}return t}var vt={};var At,Zt={},Xt={get exports(){return Zt},set exports(e){Zt=e}};function Kt(){return At||(At=1,function(e,t){var n;e.exports=(n=n||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==Ze&&Ze.crypto&&(n=Ze.crypto),!n)try{n=require("crypto")}catch(e){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(e){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(e){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},c=i.lib={},a=c.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},u=c.WordArray=a.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||s).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,o=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var c=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=c<<24-(r+i)%4*8}else for(var a=0;a<o;a+=4)t[r+a>>>2]=n[a>>>2];return this.sigBytes+=o,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new u.init(t,e)}}),l=i.enc={},s=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new u.init(n,t/2)}},d=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],o=0;o<n;o++){var i=t[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new u.init(n,t)}},f=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},g=c.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=f.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,o=r.words,i=r.sigBytes,c=this.blockSize,a=i/(4*c),l=(a=t?e.ceil(a):e.max((0|a)-this._minBufferSize,0))*c,s=e.min(4*l,i);if(l){for(var d=0;d<l;d+=c)this._doProcessBlock(o,d);n=o.splice(0,l),r.sigBytes-=s}return new u.init(n,s)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});c.Hasher=g.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){g.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new p.HMAC.init(e,n).finalize(t)}}});var p=i.algo={};return i}(Math),n)}(Xt)),Zt}!function(e,t){e.exports=Kt().enc.Utf8}({get exports(){return vt},set exports(e){vt=e}});var wt=vt,jt={};!function(e,t){var n;e.exports=(n=Kt(),function(){var e=n,t=e.lib.WordArray;function r(e,n,r){for(var o=[],i=0,c=0;c<n;c++)if(c%4){var a=r[e.charCodeAt(c-1)]<<c%4*2|r[e.charCodeAt(c)]>>>6-c%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return t.create(o,i)}e.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,r=this._map;e.clamp();for(var o=[],i=0;i<n;i+=3)for(var c=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<n;a++)o.push(r.charAt(c>>>6*(3-a)&63));var u=r.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var c=n.charAt(64);if(c){var a=e.indexOf(c);-1!==a&&(t=a)}return r(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)}({get exports(){return jt},set exports(e){jt=e}});var Wt=jt;function Gt(e){if(!Pe(e))return"";let t=wt.parse(e);return Wt.stringify(t)}function St(e,t){return!!ot(e)&&(!(!Pe(t)&&!Le(t))&&t in e)}function Ht(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}var Vt,xt=function(e,t,n){for(var r=-1,o=Object(e),i=n(e),c=i.length;c--;){var a=i[Vt?c:++r];if(!1===t(o[a],a,o))break}return e};function Tt(e){return v(e)&&"[object Arguments]"==b(e)}var Yt=Object.prototype,Jt=Yt.hasOwnProperty,Bt=Yt.propertyIsEnumerable,Ot=Tt(function(){return arguments}())?Tt:function(e){return v(e)&&Jt.call(e,"callee")&&!Bt.call(e,"callee")},kt=Ot;var Rt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Nt=Rt&&"object"==typeof module&&module&&!module.nodeType&&module,Pt=Nt&&Nt.exports===Rt?s.Buffer:void 0,Qt=(Pt?Pt.isBuffer:void 0)||function(){return!1},Lt=9007199254740991,_t=/^(?:0|[1-9]\d*)$/;function Ft(e,t){var n=typeof e;return!!(t=null==t?Lt:t)&&("number"==n||"symbol"!=n&&_t.test(e))&&e>-1&&e%1==0&&e<t}var Ut=9007199254740991;function Mt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Ut}var zt={};function Et(e){return function(t){return e(t)}}zt["[object Float32Array]"]=zt["[object Float64Array]"]=zt["[object Int8Array]"]=zt["[object Int16Array]"]=zt["[object Int32Array]"]=zt["[object Uint8Array]"]=zt["[object Uint8ClampedArray]"]=zt["[object Uint16Array]"]=zt["[object Uint32Array]"]=!0,zt["[object Arguments]"]=zt["[object Array]"]=zt["[object ArrayBuffer]"]=zt["[object Boolean]"]=zt["[object DataView]"]=zt["[object Date]"]=zt["[object Error]"]=zt["[object Function]"]=zt["[object Map]"]=zt["[object Number]"]=zt["[object Object]"]=zt["[object RegExp]"]=zt["[object Set]"]=zt["[object String]"]=zt["[object WeakMap]"]=!1;var Dt="object"==typeof exports&&exports&&!exports.nodeType&&exports,$t=Dt&&"object"==typeof module&&module&&!module.nodeType&&module,qt=$t&&$t.exports===Dt&&u.process,en=function(){try{var e=$t&&$t.require&&$t.require("util").types;return e||qt&&qt.binding&&qt.binding("util")}catch(e){}}(),tn=en&&en.isTypedArray,nn=tn?Et(tn):function(e){return v(e)&&Mt(e.length)&&!!zt[b(e)]},rn=Object.prototype.hasOwnProperty;function on(e,t){var n=a(e),r=!n&&kt(e),o=!n&&!r&&Qt(e),i=!n&&!r&&!o&&nn(e),c=n||r||o||i,u=c?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],l=u.length;for(var s in e)!t&&!rn.call(e,s)||c&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Ft(s,l))||u.push(s);return u}var cn=Object.prototype;function an(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||cn)}function un(e,t){return function(n){return e(t(n))}}var ln=un(Object.keys,Object),sn=Object.prototype.hasOwnProperty;function dn(e){if(!an(e))return ln(e);var t=[];for(var n in Object(e))sn.call(e,n)&&"constructor"!=n&&t.push(n);return t}function fn(e){return null!=e&&Mt(e.length)&&!V(e)}function gn(e){return fn(e)?on(e):dn(e)}var pn=function(e,t){return function(n,r){if(null==n)return n;if(!fn(n))return e(n,r);for(var o=n.length,i=t?o:-1,c=Object(n);(t?i--:++i<o)&&!1!==r(c[i],i,c););return n}}((function(e,t){return e&&xt(e,t,gn)})),In=pn;function hn(e){return e}function yn(e,t){var n;return(a(e)?Ht:In)(e,"function"==typeof(n=t)?n:hn)}function Cn(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}function mn(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}function bn(e){return"[object Uint16Array]"===Object.prototype.toString.call(e)}function vn(e){if(!(Cn(e)||(t=e,"[object Blob]"===Object.prototype.toString.call(t))||mn(e)||bn(e)))return null;var t;try{if(e.byteLength)return e.byteLength}catch(e){}try{if(e.length)return e.length}catch(e){}try{if(e.size)return e.size}catch(e){}return null}var An=un(Object.getPrototypeOf,Object),Zn="[object Object]",Xn=Function.prototype,Kn=Object.prototype,wn=Xn.toString,jn=Kn.hasOwnProperty,Wn=wn.call(Object);function Gn(e){if(!v(e)||b(e)!=Zn)return!1;var t=An(e);if(null===t)return!0;var n=jn.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&wn.call(n)==Wn}var Sn="[object DOMException]",Hn="[object Error]";function Vn(e){if(!ot(e))return{results:"",binarys:[]};if(it(e))return{results:"",binarys:[]};let t="",n=[];try{let r=-1;t=JSON.stringify(e,(function(e,t){if(mn(t)){r+=1;let e=`[Uint8Array]::${r}`;return n.push(t),e}if(bn(t)){r+=1;let e=`[Uint16Array]::${r}`;return n.push(t),e}if(Cn(t)){r+=1;let e=`[ArrayBuffer]::${r}`;return n.push(t),e}return function(e){if(!v(e))return!1;var t=b(e);return t==Hn||t==Sn||"string"==typeof e.message&&"string"==typeof e.name&&!Gn(e)}(t)&&(t=t.toString()),t}))}catch(e){}return{results:t,binarys:n}}function xn(e){if(!Pe(e))return new Uint8Array;let t;try{t=function(e){if(!Ne(e))return new Uint8Array;let t=Wt.parse(e),n=t.words,r=t.sigBytes,o=new Uint8Array(r);for(let e=0;e<r;e++){let t=n[e>>>2]>>>24-e%4*8&255;o[e]=t}return o}(Gt(e))}catch(e){return new Uint8Array}return t}function Tn(e,t){return function(e,t,n,r,o,i){if(!Le(e))return null;if(!mn(t))return null;if(!Fe(n))return null;if(!lt(r))return null;if(!Fe(o))return null;if(!Fe(i))return null;let c,a,u;e=_e(e);let l=8*i-o-1,s=(1<<l)-1,d=s>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?i-1:0,p=r?-1:1,I=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,c=s):(c=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-c))<1&&(c--,u*=2),(e+=c+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(c++,u/=2),c+d>=s?(a=0,c=s):c+d>=1?(a=(e*u-1)*Math.pow(2,o),c+=d):(a=e*Math.pow(2,d-1)*Math.pow(2,o),c=0));o>=8;t[n+g]=255&a,g+=p,a/=256,o-=8);for(c=c<<o|a,l+=o;l>0;t[n+g]=255&c,g+=p,c/=256,l-=8);return t[n+g-p]|=128*I,null}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,!(arguments.length>3&&void 0!==arguments[3])||arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:52,arguments.length>5&&void 0!==arguments[5]?arguments[5]:8)}function Yn(e){let t=[],n=[];if(!at(e)&&!Ct(e))return null;let r=[],o=[];function i(e){r.push(vn(e)),o.push(e)}try{let c=Vn(e);i(xn(c.results)),yn(c.binarys,(e=>{i(e)}));let a=r,u=xn(JSON.stringify(a)),l=new Uint8Array(8);Tn(vn(u),l),t.push(l),t.push(u),yn(o,(e=>{t.push(e)})),yn(t,(e=>{n=function(e,t){let n=vn(e),r=vn(t),o=new Uint8Array(n+r);return o.set(new Uint8Array(e),0),o.set(new Uint8Array(t),n),o}(n,e)}))}catch(e){return null}return n}function Jn(e){return function(e,t,n,r,o){if(!mn(e))return null;if(!Fe(t))return null;if(!lt(n))return null;if(!Fe(r))return null;if(!Fe(o))return null;let i,c,a=8*o-r-1,u=(1<<a)-1,l=u>>1,s=-7,d=n?0:o-1,f=n?1:-1,g=e[t+d];for(d+=f,i=g&(1<<-s)-1,g>>=-s,s+=a;s>0;i=256*i+e[t+d],d+=f,s-=8);for(c=i&(1<<-s)-1,i>>=-s,s+=r;s>0;c=256*c+e[t+d],d+=f,s-=8);if(0===i)i=1-l;else{if(i===u)return c?NaN:1/0*(g?-1:1);c+=Math.pow(2,r),i-=l}return(g?-1:1)*c*Math.pow(2,i-r)}(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!(arguments.length>2&&void 0!==arguments[2])||arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:52,arguments.length>4&&void 0!==arguments[4]?arguments[4]:8)}var Bn={};!function(e,t){var n;e.exports=(n=Kt(),function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init,r=e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=e[o]<<24-o%4*8;t.call(this,r,n)}else t.apply(this,arguments)};r.prototype=e}}(),n.lib.WordArray)}({get exports(){return Bn},set exports(e){Bn=e}});var On=Bn;function kn(e){if(!mn(e))return"";let t;try{n=function(e){return mn(e)?On.create(e).toString(Wt):""}(e),t=Pe(n)?Wt.parse(n).toString(wt):""}catch(e){return""}var n;return t}function Rn(e){let t=null;if(!mn(e))return null;try{let n=8,r=e.slice(0,n),o=e.slice(n,vn(e)),i=Jn(r),c=o.slice(0,i),a=o.slice(i,vn(o)),u=kn(c),l=function(e,t){let n=0,r=0,o=[];return yn(t,(t=>{r=n+t;let i=e.slice(n,r);n=r,o.push(i)})),o}(a,JSON.parse(u));t=function(e){if(!Ct(e))return{};let{results:t,binarys:n}=e;if(!Pe(t))return{};if(!nt(n))return{};let r={};try{r=JSON.parse(t,(function(e,t){if(Pe(t)){if(t.indexOf("[Uint8Array]::")>=0){let e=De(t.replace("[Uint8Array]::",""));return n[e]}if(t.indexOf("[Uint16Array]::")>=0){let e=De(t.replace("[Uint16Array]::",""));return n[e]}if(t.indexOf("[ArrayBuffer]::")>=0){let e=De(t.replace("[ArrayBuffer]::",""));return n[e]}}return t}))}catch(e){}return r}({results:kn(l.shift()),binarys:l})}catch(e){}return t}function Nn(e){return!!r.existsSync(e)&&(!r.lstatSync(e).isDirectory()&&!r.lstatSync(e).isSymbolicLink())}function Pn(e){return!!r.existsSync(e)&&(!r.lstatSync(e).isFile()&&!r.lstatSync(e).isSymbolicLink())}function Qn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ae(t,"type","");Pe(n)||(n="sha512");let o=Ae(t,"useSync","");lt(o)||(o=!0);let c="";return c=o?function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sha512";if(!Nn(e))throw new Error(`fp[${e}] is not a file`);let n=r.readFileSync(e),o=i.createHash(t);return o.update(n,"utf8"),o.digest("hex")}(e,n):function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sha512",n=gt();Nn(e)||n.reject(`fp[${e}] is not a file`);try{let o=i.createHash(t),c=r.createReadStream(e);c.on("readable",(()=>{let e=c.read();e?o.update(e):n.resolve(o.digest("hex"))})),c.on("error",(e=>{n.reject(e.toString())}))}catch(e){n.reject(e.toString())}return n}(e,n),c}var Ln={};!function(e,t){e.exports=function(e){var t={};!function(t,n){t.exports=function(e){var t={};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,c),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,c){var a=n?n+e:e;if(!this._events[a])return!1;var u,l,s=this._events[a],d=arguments.length;if(s.fn){switch(s.once&&this.removeListener(e,s.fn,void 0,!0),d){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,t),!0;case 3:return s.fn.call(s.context,t,r),!0;case 4:return s.fn.call(s.context,t,r,o),!0;case 5:return s.fn.call(s.context,t,r,o,i),!0;case 6:return s.fn.call(s.context,t,r,o,i,c),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];s.fn.apply(s.context,u)}else{var f,g=s.length;for(l=0;l<g;l++)switch(s[l].once&&this.removeListener(e,s[l].fn,void 0,!0),d){case 1:s[l].fn.call(s[l].context);break;case 2:s[l].fn.call(s[l].context,t);break;case 3:s[l].fn.call(s[l].context,t,r);break;case 4:s[l].fn.call(s[l].context,t,r,o);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];s[l].fn.apply(s[l].context,u)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||c(this,i);else{for(var u=0,l=[],s=a.length;u<s;u++)(a[u].fn!==t||o&&!a[u].once||r&&a[u].context!==r)&&l.push(a[u]);l.length?this._events[i]=1===l.length?l[0]:l:c(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&c(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}({get exports(){return t},set exports(e){t=e}});var n=t;let r;!function(){if("nodejs"!=("undefined"!=typeof window&&void 0!==window.document?"browser":"nodejs"))return null;let t=(o="CgogICAgICAgIC8vaW1wb3J0IHsgcGFyZW50UG9ydCB9IGZyb20gJ3dvcmtlcl90aHJlYWRzJwogICAgICAgIGxldCB7IHBhcmVudFBvcnQgfSA9IHJlcXVpcmUoJ3dvcmtlcl90aHJlYWRzJykgLy/lm6BwYWNrYWdlLmpzb27kuI3ntaZ0eXBlPW1vZHVsZeaVheeEoeazleaUr+aPtGVzNiBpbXBvcnQsIOW+l+S9v+eUqHJlcXVpcmUKICAgICAgICAvL+iLpeimgeaWvG5vZGVqcyB3b3JrZXLlhafkvb/nlKjnhKHms5Xnt6jora/nmoTljp/nlJ/lpZfku7bkvovlpoJmcywg6YG/5YWN5L2/55So6aCC5bGkaW1wb3J05Yqg6LyJ5L2/55SoLCDlm6DnhKHms5Xnt6jora/mnIPnm7TmjqXkv53nlZkKICAgICAgICAvL+S4puWboGltcG9ydOS9jeaWvHdvcmtlcuWkluWxpOmZkOWumueCunJlcXVpcmXljYAocGFja2FnZS5qc29u5LiN57WmdHlwZT1tb2R1bGUpLCDmlYXlh7rnj77pjK/oqqTnhKHms5Xnt6jora8KICAgICAgICAKCiJ1c2Ugc3RyaWN0Ijt2YXIgdD1yZXF1aXJlKCJwYXRoIikscj1yZXF1aXJlKCJmcyIpO2Z1bmN0aW9uIGUoKXtsZXQgdCxyLGU9bmV3IFByb21pc2UoKGZ1bmN0aW9uKCl7dD1hcmd1bWVudHNbMF0scj1hcmd1bWVudHNbMV19KSk7cmV0dXJuIGUucmVzb2x2ZT10LGUucmVqZWN0PXIsZX1mdW5jdGlvbiBuKHQpe3JldHVybiJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gaSh0KXtpZihmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBPYmplY3RdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCkpe2ZvcihsZXQgciBpbiB0KXJldHVybiExO3JldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIG8odCl7cmV0dXJuIltvYmplY3QgU3RyaW5nXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gdSh0KXtyZXR1cm4gdCE9dH1mdW5jdGlvbiBjKHQpe3JldHVybiEhZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgVW5kZWZpbmVkXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9KHQpfHwoISFmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBOdWxsXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9KHQpfHwoISFpKHQpfHwoISFmdW5jdGlvbih0KXtyZXR1cm4hKCFvKHQpfHwiIiE9PXQpfSh0KXx8KCEhZnVuY3Rpb24odCl7cmV0dXJuISFuKHQpJiYwPT09dC5sZW5ndGh9KHQpfHwhIXUodCkpKSkpfWZ1bmN0aW9uIGYodCl7cmV0dXJuISghbyh0KXx8IiI9PT10KX12YXIgbD0vXHMvO3ZhciBhPS9eXHMrLztmdW5jdGlvbiBzKHQpe3JldHVybiB0P3Quc2xpY2UoMCxmdW5jdGlvbih0KXtmb3IodmFyIHI9dC5sZW5ndGg7ci0tJiZsLnRlc3QodC5jaGFyQXQocikpOyk7cmV0dXJuIHJ9KHQpKzEpLnJlcGxhY2UoYSwiIik6dH1mdW5jdGlvbiBwKHQpe3ZhciByPXR5cGVvZiB0O3JldHVybiBudWxsIT10JiYoIm9iamVjdCI9PXJ8fCJmdW5jdGlvbiI9PXIpfXZhciB5PSJvYmplY3QiPT10eXBlb2YgZ2xvYmFsJiZnbG9iYWwmJmdsb2JhbC5PYmplY3Q9PT1PYmplY3QmJmdsb2JhbCxiPSJvYmplY3QiPT10eXBlb2Ygc2VsZiYmc2VsZiYmc2VsZi5PYmplY3Q9PT1PYmplY3QmJnNlbGYsaD15fHxifHxGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpLHY9aC5TeW1ib2wsZz1PYmplY3QucHJvdG90eXBlLGo9Zy5oYXNPd25Qcm9wZXJ0eSxTPWcudG9TdHJpbmcsZD12P3YudG9TdHJpbmdUYWc6dm9pZCAwO3ZhciBtPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7dmFyIE89IltvYmplY3QgTnVsbF0iLHg9IltvYmplY3QgVW5kZWZpbmVkXSIsUj12P3YudG9TdHJpbmdUYWc6dm9pZCAwO2Z1bmN0aW9uIHcodCl7cmV0dXJuIG51bGw9PXQ/dm9pZCAwPT09dD94Ok86UiYmUiBpbiBPYmplY3QodCk/ZnVuY3Rpb24odCl7dmFyIHI9ai5jYWxsKHQsZCksZT10W2RdO3RyeXt0W2RdPXZvaWQgMDt2YXIgbj0hMH1jYXRjaCh0KXt9dmFyIGk9Uy5jYWxsKHQpO3JldHVybiBuJiYocj90W2RdPWU6ZGVsZXRlIHRbZF0pLGl9KHQpOmZ1bmN0aW9uKHQpe3JldHVybiBtLmNhbGwodCl9KHQpfXZhciBOPSJbb2JqZWN0IFN5bWJvbF0iO2Z1bmN0aW9uICQodCl7cmV0dXJuInN5bWJvbCI9PXR5cGVvZiB0fHxmdW5jdGlvbih0KXtyZXR1cm4gbnVsbCE9dCYmIm9iamVjdCI9PXR5cGVvZiB0fSh0KSYmdyh0KT09Tn12YXIgQT1OYU4saz0vXlstK10weFswLTlhLWZdKyQvaSxGPS9eMGJbMDFdKyQvaSxJPS9eMG9bMC03XSskL2kscT1wYXJzZUludDtmdW5jdGlvbiBFKHQpe2lmKCJudW1iZXIiPT10eXBlb2YgdClyZXR1cm4gdDtpZigkKHQpKXJldHVybiBBO2lmKHAodCkpe3ZhciByPSJmdW5jdGlvbiI9PXR5cGVvZiB0LnZhbHVlT2Y/dC52YWx1ZU9mKCk6dDt0PXAocik/cisiIjpyfWlmKCJzdHJpbmciIT10eXBlb2YgdClyZXR1cm4gMD09PXQ/dDordDt0PXModCk7dmFyIGU9Ri50ZXN0KHQpO3JldHVybiBlfHxJLnRlc3QodCk/cSh0LnNsaWNlKDIpLGU/Mjo4KTprLnRlc3QodCk/QTordH12YXIgTD0xLzAsTT0xNzk3NjkzMTM0ODYyMzE1N2UyOTI7ZnVuY3Rpb24gUCh0KXtyZXR1cm4gdD8odD1FKHQpKT09PUx8fHQ9PT0tTD8odDwwPy0xOjEpKk06dD09dD90OjA6MD09PXQ/dDowfWZ1bmN0aW9uIFQodCl7dmFyIHI9UCh0KSxlPXIlMTtyZXR1cm4gcj09cj9lP3ItZTpyOjB9ZnVuY3Rpb24gVSh0KXtsZXQgcj0hMTtpZihmKHQpKXI9IWlzTmFOKE51bWJlcih0KSk7ZWxzZSBpZihmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBOdW1iZXJdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCkpe2lmKHUodCkpcmV0dXJuITE7cj0hMH1yZXR1cm4gcn1mdW5jdGlvbiBEKHQpe2lmKCFVKHQpKXJldHVybiAwO3JldHVybiBQKHQpfWZ1bmN0aW9uIFcodCl7cmV0dXJuISFVKHQpJiYodD1EKHQpLCJudW1iZXIiPT10eXBlb2Yocj10KSYmcj09VChyKSk7dmFyIHJ9dmFyIF89QXJyYXkuaXNBcnJheSx6PTEvMCxCPXY/di5wcm90b3R5cGU6dm9pZCAwLEM9Qj9CLnRvU3RyaW5nOnZvaWQgMDtmdW5jdGlvbiBHKHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdClyZXR1cm4gdDtpZihfKHQpKXJldHVybiBmdW5jdGlvbih0LHIpe2Zvcih2YXIgZT0tMSxuPW51bGw9PXQ/MDp0Lmxlbmd0aCxpPUFycmF5KG4pOysrZTxuOylpW2VdPXIodFtlXSxlLHQpO3JldHVybiBpfSh0LEcpKyIiO2lmKCQodCkpcmV0dXJuIEM/Qy5jYWxsKHQpOiIiO3ZhciByPXQrIiI7cmV0dXJuIjAiPT1yJiYxL3Q9PS16PyItMCI6cn1mdW5jdGlvbiBIKHQpe3JldHVybiBudWxsPT10PyIiOkcodCl9dmFyIEo9aC5pc0Zpbml0ZSxLPU1hdGgubWluO3ZhciBRLFY9KFE9TWF0aFsicm91bmQiXSxmdW5jdGlvbih0LHIpe2lmKHQ9RSh0KSwocj1udWxsPT1yPzA6SyhUKHIpLDI5MikpJiZKKHQpKXt2YXIgZT0oSCh0KSsiZSIpLnNwbGl0KCJlIik7cmV0dXJuKygoZT0oSChRKGVbMF0rImUiKygrZVsxXStyKSkpKyJlIikuc3BsaXQoImUiKSlbMF0rImUiKygrZVsxXS1yKSl9cmV0dXJuIFEodCl9KTtmdW5jdGlvbiBYKHQpe2lmKCFVKHQpKXJldHVybiAwO3Q9RCh0KTtsZXQgcj1WKHQpO3JldHVybiIwIj09PVN0cmluZyhyKT8wOnJ9ZnVuY3Rpb24gWSh0KXtpZighVyh0KSlyZXR1cm4hMTtyZXR1cm4gWCh0KT49MH1mdW5jdGlvbiBaKHQscil7aWYoIWYodCkpcmV0dXJuIiI7aWYoIVkocikpcmV0dXJuIiI7aWYoMD09PShyPVgocikpKXJldHVybiIiO2xldCBlPXQubGVuZ3RoLXI7cmV0dXJuIGU8MCYmKGU9MCksdC5zdWJzdHJpbmcoZSxlK3IpfWZ1bmN0aW9uIHR0KHQscil7cmV0dXJuIGYodCkmJlkocik/MD09PShyPVgocikpP3Q6ZnVuY3Rpb24odCxyKXtyZXR1cm4gZih0KSYmWShyKT8wPT09KHI9WChyKSk/IiI6dC5zdWJzdHJpbmcoMCxyKToiIn0odCx0Lmxlbmd0aC1yKToiIn1mdW5jdGlvbiBydCh0KXtpZighZih0KSlyZXR1cm57cGF0aDoiIixpc1Jvb3Q6ITF9O2Zvcig7dC5pbmRleE9mKCJcXFxcIik+PTA7KXQ9dC5yZXBsYWNlKCJcXFxcIiwiXFwiKTtmb3IoO3QuaW5kZXhPZigiLy8iKT49MDspdD10LnJlcGxhY2UoIi8vIiwiLyIpO2lmKCI6Ij09PVoodCwxKSlyZXR1cm57cGF0aDpgJHt0fVxcYCxpc1Jvb3Q6ITB9O2lmKCJcXCI9PT1aKHQsMSkpe2xldCByPXR0KHQsMSk7cmV0dXJuIjoiPT09WihyLDEpP3twYXRoOnQsaXNSb290OiEwfTp7cGF0aDpyLGlzUm9vdDohMX19aWYoIi8iPT09Wih0LDEpKXtsZXQgcj10dCh0LDEpO3JldHVybiAwPT09ci5sZW5ndGg/e3BhdGg6dCxpc1Jvb3Q6ITB9OntwYXRoOnIsaXNSb290OiExfX1yZXR1cm57cGF0aDp0LGlzUm9vdDohMX19ZnVuY3Rpb24gZXQodCl7aWYoIWYodCkpcmV0dXJuIiI7bGV0IHI9cnQodCk7aWYoci5pc1Jvb3QpcmV0dXJuIHIucGF0aDtsZXQgZT1mdW5jdGlvbih0KXtpZighZih0KSlyZXR1cm4iIjtsZXQgcj1ydCh0KTtpZihyLmlzUm9vdClyZXR1cm4gci5wYXRoO2xldCBlPXIucGF0aDt0cnl7ZT1lLnNwbGl0KCJcXCIpLnBvcCgpLnNwbGl0KCIvIikucG9wKCl9Y2F0Y2godCl7fXJldHVybiBlfSh0PXIucGF0aCk7aWYoIWYoZSkpcmV0dXJuIHQ7bGV0IG49cnQodD10dCh0LGUubGVuZ3RoKSk7cmV0dXJuIG4uaXNSb290LG4ucGF0aH1mdW5jdGlvbiBudCh0KXtyZXR1cm4hIXIuZXhpc3RzU3luYyh0KSYmKCFyLmxzdGF0U3luYyh0KS5pc0ZpbGUoKSYmIXIubHN0YXRTeW5jKHQpLmlzU3ltYm9saWNMaW5rKCkpfWZ1bmN0aW9uIGl0KHQpe3JldHVybiEhci5leGlzdHNTeW5jKHQpJiYoIXIubHN0YXRTeW5jKHQpLmlzRGlyZWN0b3J5KCkmJiFyLmxzdGF0U3luYyh0KS5pc1N5bWJvbGljTGluaygpKX1mdW5jdGlvbiBvdCh0KXtpZighci5leGlzdHNTeW5jKHQpKXJldHVybntzdWNjZXNzOiJmaWxlIGRvZXMgbm90IGV4aXN0OiAiK3R9O2lmKCFpdCh0KSlyZXR1cm57ZXJyb3I6ImlucHV0IHBhdGggaXMgbm90IGEgZmlsZTogIit0fTt0cnl7ci51bmxpbmtTeW5jKHQpfWNhdGNoKHQpe3JldHVybntlcnJvcjp0fX1yZXR1cm57c3VjY2VzczoiZG9uZTogIit0fX1hc3luYyBmdW5jdGlvbiB1dCh0LGksbyl7bGV0IHU9IiI7aWYoIW4oZj1pKXx8MD09PWYubGVuZ3RofHwxPT09Zi5sZW5ndGgmJmMoZlswXSkpdGhyb3cgbmV3IEVycm9yKCJmcHNJbiBpbiBub3QgYW4gZWZmZWN0aXZlIGFycmF5Iik7dmFyIGY7bGV0IGw9ZXQobyk7bnQobCl8fGZ1bmN0aW9uKHQpe2lmKG50KHQpKXJldHVybntzdWNjZXNzOiJpbnB1dCBmb2xkZXIgaXMgYWxyZWFkeSBleGlzdHM6ICIrdH07aWYoci5leGlzdHNTeW5jKHQpKXJldHVybntlcnJvcjoiaW5wdXQgcGF0aCBhbHJlYWR5IGV4aXN0czogIit0fTt0cnl7ci5ta2RpclN5bmModCx7cmVjdXJzaXZlOiEwfSl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fX0obCk7bGV0IGE9ZSgpO3RyeXtsZXQgbj1yLmNyZWF0ZVdyaXRlU3RyZWFtKG8pO2ZvcihsZXQgdD0wO3Q8aS5sZW5ndGg7dCsrKXtsZXQgbz1pW3RdO2lmKCFpdChvKSl0aHJvdyBuZXcgRXJyb3IoYGZwSW5bJHtvfV0gaXMgbm90IGEgZmlsZWApO2xldCBjPSgpPT57bGV0IHQ9ZSgpLGk9ci5jcmVhdGVSZWFkU3RyZWFtKG8pO3JldHVybiBpLm9uKCJlcnJvciIsKHI9Pnt1PXIubWVzc2FnZSx0LnJlamVjdChyKX0pKSxpLm9uKCJlbmQiLCgoKT0+e290KG8pLHQucmVzb2x2ZSgpfSkpLGkucGlwZShuLHtlbmQ6ITF9KSx0fTthd2FpdCBjKCl9bi5lbmQoKSxuLm9uKCJlcnJvciIsKHQ9Pnt1PXQubWVzc2FnZSxhLnJlamVjdCh1KX0pKSxuLm9uKCJmaW5pc2giLCgoKT0+e2xldCByPXtmaWxlbmFtZTp0LHBhdGg6b307YS5yZXNvbHZlKHIpfSkpfWNhdGNoKHQpe3U9dC5tZXNzYWdlLGEucmVqZWN0KHUpfXJldHVybiBhfWxldCBtZXJnZUZpbGVzPWFzeW5jKHIsZSxuLGkpPT57bGV0IG89W107Zm9yKGxldCBpPTA7aTxuO2krKyl7bGV0IG49dC5qb2luKHIsYCR7ZX1fJHtpfWApO28ucHVzaChuKX1sZXQgdT10LmpvaW4ocixlKTtyZXR1cm4gYXdhaXQgdXQoaSxvLHUpfTsKCgpsZXQgaW5zdGFuY2UgPSBudWxsCmZ1bmN0aW9uIGluaXQoaW5wdXQpewoKICAgIC8vaW5pdAogICAgbGV0IHIKICAgIAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIG1haW46IG1lcmdlRmlsZXMKICAgICAgICB9CiAgICAgICAgCgogICAgLy9vbgogICAgCgogICAgLy9zYXZlCiAgICBpbnN0YW5jZSA9IHIKCn0KCmZ1bmN0aW9uIHNlbmRNZXNzYWdlKGRhdGEpIHsKICAgIAogICAgICAgIHBhcmVudFBvcnQucG9zdE1lc3NhZ2UoZGF0YSkKICAgICAgICAKfQoKYXN5bmMgZnVuY3Rpb24gcnVuKGRhdGEpIHsKICAgIC8vIGNvbnNvbGUubG9nKCdpbm5lciB3b3JrZXIgcnVuJyxkYXRhKQoKICAgIC8vbW9kZQogICAgbGV0IG1vZGUgPSBkYXRhLm1vZGUKCiAgICAvL2NoZWNrCiAgICBpZihtb2RlICE9PSAnaW5pdCcgJiYgbW9kZSAhPT0gJ2NhbGwnKXsKICAgICAgICByZXR1cm4KICAgIH0KCiAgICAvL2luaXQKICAgIGlmKG1vZGUgPT09ICdpbml0Jyl7CiAgICAgICAgCiAgICAgICAgdHJ5ewoKICAgICAgICAgICAgLy90eXBlCiAgICAgICAgICAgIGxldCB0eXBlID0gZGF0YS50eXBlCgogICAgICAgICAgICAvL2lucHV0CiAgICAgICAgICAgIGxldCBpbnB1dCA9IGRhdGEuaW5wdXQKICAgIAogICAgICAgICAgICAvL2luc3RhbmNlCiAgICAgICAgICAgIGlmKHR5cGUgPT09ICdmdW5jdGlvbicpewogICAgICAgICAgICAgICAgaW5pdCguLi5pbnB1dCkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKHR5cGUgPT09ICdvYmplY3QnKXsKICAgICAgICAgICAgICAgIGluc3RhbmNlID0gbWVyZ2VGaWxlcwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICBjYXRjaChlcnIpewogICAgICAgIAogICAgICAgICAgICAvL3NlbmRNZXNzYWdlCiAgICAgICAgICAgIGxldCByZXMgPSB7CiAgICAgICAgICAgICAgICBtb2RlOiAnZW1pdCcsCiAgICAgICAgICAgICAgICBldk5hbWU6ICdlcnJvcicsCiAgICAgICAgICAgICAgICBtc2c6IGVyciwKICAgICAgICAgICAgfQogICAgICAgICAgICBzZW5kTWVzc2FnZShyZXMpCgogICAgICAgIH0KICAgICAgICAgICAgCiAgICB9CgogICAgLy9jaGVjawogICAgaWYobW9kZSA9PT0gJ2NhbGwnKXsKICAgICAgICBsZXQgc3RhdGUgPSAnJwogICAgICAgIGxldCBtc2cgPSBudWxsCgogICAgICAgIHRyeXsKCiAgICAgICAgICAgIC8vZnVuCiAgICAgICAgICAgIGxldCBmdW4gPSBpbnN0YW5jZVtkYXRhLmZ1bl0KCiAgICAgICAgICAgIC8vaW5wdXQKICAgICAgICAgICAgbGV0IGlucHV0ID0gZGF0YS5pbnB1dAoKICAgICAgICAgICAgLy9leGVjCiAgICAgICAgICAgIGF3YWl0IGZ1biguLi5pbnB1dCkKICAgICAgICAgICAgICAgIC50aGVuKChzdWMpID0+IHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZT0nc3VjY2VzcycKICAgICAgICAgICAgICAgICAgICBtc2c9c3VjCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZT0nZXJyb3InCiAgICAgICAgICAgICAgICAgICAgbXNnPWVycgogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgfQogICAgICAgIGNhdGNoKGVycil7CiAgICAgICAgICAgIHN0YXRlID0gJ2Vycm9yJwogICAgICAgICAgICBtc2cgPSBlcnIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy9zZW5kTWVzc2FnZQogICAgICAgIGxldCByZXMgPSB7CiAgICAgICAgICAgIG1vZGU6ICdyZXR1cm4nLAogICAgICAgICAgICBpZDogZGF0YS5pZCwKICAgICAgICAgICAgZnVuOiBkYXRhLmZ1biwKICAgICAgICAgICAgc3RhdGUsCiAgICAgICAgICAgIG1zZywKICAgICAgICB9CiAgICAgICAgc2VuZE1lc3NhZ2UocmVzKQoKICAgIH0KCn0KCmZ1bmN0aW9uIHJlY3ZNZXNzYWdlKGRhdGEpIHsKICAgIC8vIGNvbnNvbGUubG9nKCdpbm5lciB3b3JrZXIgcmVjdjonLCBkYXRhKQoKICAgIC8vZGF0YVJlY3YKICAgIGxldCBkYXRhUmVjdiA9IGRhdGEKCiAgICAvL3J1bgogICAgcnVuKGRhdGFSZWN2KQoKfQoKCiAgICAgICAgcGFyZW50UG9ydC5vbignbWVzc2FnZScsIHJlY3ZNZXNzYWdlKQogICAgICAgIAoKdHJ5ewogICAgcHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKGVycikgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdpbm5lcjp1bmhhbmRsZWRSZWplY3Rpb24nLCBlcnIpCiAgICB9KQogICAgcHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb24nLCAoZXJyKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ2lubmVyOnVuY2F1Z2h0RXhjZXB0aW9uJywgZXJyKQogICAgfSkKICAgIHByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uTW9uaXRvcicsIChlcnIpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygnaW5uZXI6dW5jYXVnaHRFeGNlcHRpb25Nb25pdG9yJywgZXJyKQogICAgfSkKfQpjYXRjaChlcnIpe30KCg==",Buffer.from(o,"base64").toString("utf8"));var o;function i(){let r=new n,o=function(t){try{return new e.Worker(t,{eval:!0})}catch(e){c(e)}}(t);if(!o)return c("invalid worker"),null;function i(){let e=function(){let e,t,n=new Promise((function(){e=arguments[0],t=arguments[1]}));return n.resolve=e,n.reject=t,n}(),t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=[],n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=n.length;for(let o=0;o<e;o++)t[o]=n[0|Math.random()*r];return t.join("")}(),n={mode:"call",id:t,fun:"main",input:[...arguments]};return o.postMessage(n),r.once(t,(t=>{"success"===t.state?e.resolve(t.msg):e.reject(t.msg)})),e}function c(e){r.emit("error",e)}return o.on("message",(function(e){let t=e,n=t.mode;"emit"!==n&&"return"!==n||("emit"===n&&r.emit(t.evName,t.msg),"return"===n&&r.emit(t.id,t))})),o.on("error",c),o.on("exit",(e=>{1!==e&&c("exit code["+e+"] !== 1")})),function(){let e={mode:"init",type:"function",input:[...arguments]};o.postMessage(e)}([...arguments]),r.main=i,r.main=i,r.terminate=function(){o?(o.terminate(),o=void 0):c("worker has been terminated")},r}r=async function(){let e=[...arguments],t=i();return await t.main(...e).finally((()=>{t.terminate()}))}}();try{process.on("unhandledRejection",(e=>{console.log("outer:unhandledRejection",e)})),process.on("uncaughtException",(e=>{console.log("outer:uncaughtException",e)})),process.on("uncaughtExceptionMonitor",(e=>{console.log("outer:uncaughtExceptionMonitor",e)}))}catch(e){}return r}(e)}({get exports(){return t},set exports(e){t=e}});var n=t,r={};!function(e,t){e.exports=function(){const e="function"==typeof Buffer,t="function"==typeof TextDecoder?new TextDecoder:void 0,n=(e=>{let t={};return e.forEach(((e,n)=>t[e]=n)),t})(("function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="))),r=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,o=String.fromCharCode.bind(String),i="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),c=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),a=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,u=e=>{switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return o(55296+(t>>>10))+o(56320+(1023&t));case 3:return o((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return o((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},l=e=>e.replace(a,u),s=e=>{if(e=e.replace(/\s+/g,""),!r.test(e))throw new TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let t,i,c,a="";for(let r=0;r<e.length;)t=n[e.charAt(r++)]<<18|n[e.charAt(r++)]<<12|(i=n[e.charAt(r++)])<<6|(c=n[e.charAt(r++)]),a+=64===i?o(t>>16&255):64===c?o(t>>16&255,t>>8&255):o(t>>16&255,t>>8&255,255&t);return a},d="function"==typeof atob?e=>atob(c(e)):e?e=>Buffer.from(e,"base64").toString("binary"):s,f=e?e=>i(Buffer.from(e,"base64")):e=>i(d(e).split("").map((e=>e.charCodeAt(0)))),g=e?e=>Buffer.from(e,"base64").toString("utf8"):t?e=>t.decode(f(e)):e=>l(d(e)),p=e=>c(e.replace(/[-_]/g,(e=>"-"==e?"+":"/"))),I=e=>g(p(e)),h=I;var y={};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}function o(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||e,c),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],a]:e._events[u].push(a):(e._events[u]=a,e._eventsCount++),e}function c(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var e,r,o=[];if(0===this._eventsCount)return o;for(r in e=this._events)t.call(e,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(e)):o},a.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},a.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},a.prototype.emit=function(e,t,r,o,i,c){var a=n?n+e:e;if(!this._events[a])return!1;var u,l,s=this._events[a],d=arguments.length;if(s.fn){switch(s.once&&this.removeListener(e,s.fn,void 0,!0),d){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,t),!0;case 3:return s.fn.call(s.context,t,r),!0;case 4:return s.fn.call(s.context,t,r,o),!0;case 5:return s.fn.call(s.context,t,r,o,i),!0;case 6:return s.fn.call(s.context,t,r,o,i,c),!0}for(l=1,u=new Array(d-1);l<d;l++)u[l-1]=arguments[l];s.fn.apply(s.context,u)}else{var f,g=s.length;for(l=0;l<g;l++)switch(s[l].once&&this.removeListener(e,s[l].fn,void 0,!0),d){case 1:s[l].fn.call(s[l].context);break;case 2:s[l].fn.call(s[l].context,t);break;case 3:s[l].fn.call(s[l].context,t,r);break;case 4:s[l].fn.call(s[l].context,t,r,o);break;default:if(!u)for(f=1,u=new Array(d-1);f<d;f++)u[f-1]=arguments[f];s[l].fn.apply(s[l].context,u)}}return!0},a.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},a.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},a.prototype.removeListener=function(e,t,r,o){var i=n?n+e:e;if(!this._events[i])return this;if(!t)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||r&&a.context!==r||c(this,i);else{for(var u=0,l=[],s=a.length;u<s;u++)(a[u].fn!==t||o&&!a[u].once||r&&a[u].context!==r)&&l.push(a[u]);l.length?this._events[i]=1===l.length?l[0]:l:c(this,i)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&c(this,t)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,e.exports=a}({get exports(){return y},set exports(e){y=e}});var C=y;let m;!function(){if("browser"!=("undefined"!=typeof window&&void 0!==window.document?"browser":"nodejs"))return null;let e=h("CgoKInVzZSBzdHJpY3QiO3ZhciB0PXJlcXVpcmUoInBhdGgiKSxyPXJlcXVpcmUoImZzIik7ZnVuY3Rpb24gZSgpe2xldCB0LHIsZT1uZXcgUHJvbWlzZSgoZnVuY3Rpb24oKXt0PWFyZ3VtZW50c1swXSxyPWFyZ3VtZW50c1sxXX0pKTtyZXR1cm4gZS5yZXNvbHZlPXQsZS5yZWplY3Q9cixlfWZ1bmN0aW9uIG4odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX1mdW5jdGlvbiBpKHQpe2lmKGZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE9iamVjdF0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSh0KSl7Zm9yKGxldCByIGluIHQpcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuITF9ZnVuY3Rpb24gbyh0KXtyZXR1cm4iW29iamVjdCBTdHJpbmddIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX1mdW5jdGlvbiB1KHQpe3JldHVybiB0IT10fWZ1bmN0aW9uIGModCl7cmV0dXJuISFmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBVbmRlZmluZWRdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCl8fCghIWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE51bGxdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCl8fCghIWkodCl8fCghIWZ1bmN0aW9uKHQpe3JldHVybiEoIW8odCl8fCIiIT09dCl9KHQpfHwoISFmdW5jdGlvbih0KXtyZXR1cm4hIW4odCkmJjA9PT10Lmxlbmd0aH0odCl8fCEhdSh0KSkpKSl9ZnVuY3Rpb24gZih0KXtyZXR1cm4hKCFvKHQpfHwiIj09PXQpfXZhciBsPS9ccy87dmFyIGE9L15ccysvO2Z1bmN0aW9uIHModCl7cmV0dXJuIHQ/dC5zbGljZSgwLGZ1bmN0aW9uKHQpe2Zvcih2YXIgcj10Lmxlbmd0aDtyLS0mJmwudGVzdCh0LmNoYXJBdChyKSk7KTtyZXR1cm4gcn0odCkrMSkucmVwbGFjZShhLCIiKTp0fWZ1bmN0aW9uIHAodCl7dmFyIHI9dHlwZW9mIHQ7cmV0dXJuIG51bGwhPXQmJigib2JqZWN0Ij09cnx8ImZ1bmN0aW9uIj09cil9dmFyIHk9Im9iamVjdCI9PXR5cGVvZiBnbG9iYWwmJmdsb2JhbCYmZ2xvYmFsLk9iamVjdD09PU9iamVjdCYmZ2xvYmFsLGI9Im9iamVjdCI9PXR5cGVvZiBzZWxmJiZzZWxmJiZzZWxmLk9iamVjdD09PU9iamVjdCYmc2VsZixoPXl8fGJ8fEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCksdj1oLlN5bWJvbCxnPU9iamVjdC5wcm90b3R5cGUsaj1nLmhhc093blByb3BlcnR5LFM9Zy50b1N0cmluZyxkPXY/di50b1N0cmluZ1RhZzp2b2lkIDA7dmFyIG09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzt2YXIgTz0iW29iamVjdCBOdWxsXSIseD0iW29iamVjdCBVbmRlZmluZWRdIixSPXY/di50b1N0cmluZ1RhZzp2b2lkIDA7ZnVuY3Rpb24gdyh0KXtyZXR1cm4gbnVsbD09dD92b2lkIDA9PT10P3g6TzpSJiZSIGluIE9iamVjdCh0KT9mdW5jdGlvbih0KXt2YXIgcj1qLmNhbGwodCxkKSxlPXRbZF07dHJ5e3RbZF09dm9pZCAwO3ZhciBuPSEwfWNhdGNoKHQpe312YXIgaT1TLmNhbGwodCk7cmV0dXJuIG4mJihyP3RbZF09ZTpkZWxldGUgdFtkXSksaX0odCk6ZnVuY3Rpb24odCl7cmV0dXJuIG0uY2FsbCh0KX0odCl9dmFyIE49IltvYmplY3QgU3ltYm9sXSI7ZnVuY3Rpb24gJCh0KXtyZXR1cm4ic3ltYm9sIj09dHlwZW9mIHR8fGZ1bmN0aW9uKHQpe3JldHVybiBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHR9KHQpJiZ3KHQpPT1OfXZhciBBPU5hTixrPS9eWy0rXTB4WzAtOWEtZl0rJC9pLEY9L14wYlswMV0rJC9pLEk9L14wb1swLTddKyQvaSxxPXBhcnNlSW50O2Z1bmN0aW9uIEUodCl7aWYoIm51bWJlciI9PXR5cGVvZiB0KXJldHVybiB0O2lmKCQodCkpcmV0dXJuIEE7aWYocCh0KSl7dmFyIHI9ImZ1bmN0aW9uIj09dHlwZW9mIHQudmFsdWVPZj90LnZhbHVlT2YoKTp0O3Q9cChyKT9yKyIiOnJ9aWYoInN0cmluZyIhPXR5cGVvZiB0KXJldHVybiAwPT09dD90Oit0O3Q9cyh0KTt2YXIgZT1GLnRlc3QodCk7cmV0dXJuIGV8fEkudGVzdCh0KT9xKHQuc2xpY2UoMiksZT8yOjgpOmsudGVzdCh0KT9BOit0fXZhciBMPTEvMCxNPTE3OTc2OTMxMzQ4NjIzMTU3ZTI5MjtmdW5jdGlvbiBQKHQpe3JldHVybiB0Pyh0PUUodCkpPT09THx8dD09PS1MPyh0PDA/LTE6MSkqTTp0PT10P3Q6MDowPT09dD90OjB9ZnVuY3Rpb24gVCh0KXt2YXIgcj1QKHQpLGU9ciUxO3JldHVybiByPT1yP2U/ci1lOnI6MH1mdW5jdGlvbiBVKHQpe2xldCByPSExO2lmKGYodCkpcj0haXNOYU4oTnVtYmVyKHQpKTtlbHNlIGlmKGZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE51bWJlcl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSh0KSl7aWYodSh0KSlyZXR1cm4hMTtyPSEwfXJldHVybiByfWZ1bmN0aW9uIEQodCl7aWYoIVUodCkpcmV0dXJuIDA7cmV0dXJuIFAodCl9ZnVuY3Rpb24gVyh0KXtyZXR1cm4hIVUodCkmJih0PUQodCksIm51bWJlciI9PXR5cGVvZihyPXQpJiZyPT1UKHIpKTt2YXIgcn12YXIgXz1BcnJheS5pc0FycmF5LHo9MS8wLEI9dj92LnByb3RvdHlwZTp2b2lkIDAsQz1CP0IudG9TdHJpbmc6dm9pZCAwO2Z1bmN0aW9uIEcodCl7aWYoInN0cmluZyI9PXR5cGVvZiB0KXJldHVybiB0O2lmKF8odCkpcmV0dXJuIGZ1bmN0aW9uKHQscil7Zm9yKHZhciBlPS0xLG49bnVsbD09dD8wOnQubGVuZ3RoLGk9QXJyYXkobik7KytlPG47KWlbZV09cih0W2VdLGUsdCk7cmV0dXJuIGl9KHQsRykrIiI7aWYoJCh0KSlyZXR1cm4gQz9DLmNhbGwodCk6IiI7dmFyIHI9dCsiIjtyZXR1cm4iMCI9PXImJjEvdD09LXo/Ii0wIjpyfWZ1bmN0aW9uIEgodCl7cmV0dXJuIG51bGw9PXQ/IiI6Ryh0KX12YXIgSj1oLmlzRmluaXRlLEs9TWF0aC5taW47dmFyIFEsVj0oUT1NYXRoWyJyb3VuZCJdLGZ1bmN0aW9uKHQscil7aWYodD1FKHQpLChyPW51bGw9PXI/MDpLKFQociksMjkyKSkmJkoodCkpe3ZhciBlPShIKHQpKyJlIikuc3BsaXQoImUiKTtyZXR1cm4rKChlPShIKFEoZVswXSsiZSIrKCtlWzFdK3IpKSkrImUiKS5zcGxpdCgiZSIpKVswXSsiZSIrKCtlWzFdLXIpKX1yZXR1cm4gUSh0KX0pO2Z1bmN0aW9uIFgodCl7aWYoIVUodCkpcmV0dXJuIDA7dD1EKHQpO2xldCByPVYodCk7cmV0dXJuIjAiPT09U3RyaW5nKHIpPzA6cn1mdW5jdGlvbiBZKHQpe2lmKCFXKHQpKXJldHVybiExO3JldHVybiBYKHQpPj0wfWZ1bmN0aW9uIFoodCxyKXtpZighZih0KSlyZXR1cm4iIjtpZighWShyKSlyZXR1cm4iIjtpZigwPT09KHI9WChyKSkpcmV0dXJuIiI7bGV0IGU9dC5sZW5ndGgtcjtyZXR1cm4gZTwwJiYoZT0wKSx0LnN1YnN0cmluZyhlLGUrcil9ZnVuY3Rpb24gdHQodCxyKXtyZXR1cm4gZih0KSYmWShyKT8wPT09KHI9WChyKSk/dDpmdW5jdGlvbih0LHIpe3JldHVybiBmKHQpJiZZKHIpPzA9PT0ocj1YKHIpKT8iIjp0LnN1YnN0cmluZygwLHIpOiIifSh0LHQubGVuZ3RoLXIpOiIifWZ1bmN0aW9uIHJ0KHQpe2lmKCFmKHQpKXJldHVybntwYXRoOiIiLGlzUm9vdDohMX07Zm9yKDt0LmluZGV4T2YoIlxcXFwiKT49MDspdD10LnJlcGxhY2UoIlxcXFwiLCJcXCIpO2Zvcig7dC5pbmRleE9mKCIvLyIpPj0wOyl0PXQucmVwbGFjZSgiLy8iLCIvIik7aWYoIjoiPT09Wih0LDEpKXJldHVybntwYXRoOmAke3R9XFxgLGlzUm9vdDohMH07aWYoIlxcIj09PVoodCwxKSl7bGV0IHI9dHQodCwxKTtyZXR1cm4iOiI9PT1aKHIsMSk/e3BhdGg6dCxpc1Jvb3Q6ITB9OntwYXRoOnIsaXNSb290OiExfX1pZigiLyI9PT1aKHQsMSkpe2xldCByPXR0KHQsMSk7cmV0dXJuIDA9PT1yLmxlbmd0aD97cGF0aDp0LGlzUm9vdDohMH06e3BhdGg6cixpc1Jvb3Q6ITF9fXJldHVybntwYXRoOnQsaXNSb290OiExfX1mdW5jdGlvbiBldCh0KXtpZighZih0KSlyZXR1cm4iIjtsZXQgcj1ydCh0KTtpZihyLmlzUm9vdClyZXR1cm4gci5wYXRoO2xldCBlPWZ1bmN0aW9uKHQpe2lmKCFmKHQpKXJldHVybiIiO2xldCByPXJ0KHQpO2lmKHIuaXNSb290KXJldHVybiByLnBhdGg7bGV0IGU9ci5wYXRoO3RyeXtlPWUuc3BsaXQoIlxcIikucG9wKCkuc3BsaXQoIi8iKS5wb3AoKX1jYXRjaCh0KXt9cmV0dXJuIGV9KHQ9ci5wYXRoKTtpZighZihlKSlyZXR1cm4gdDtsZXQgbj1ydCh0PXR0KHQsZS5sZW5ndGgpKTtyZXR1cm4gbi5pc1Jvb3Qsbi5wYXRofWZ1bmN0aW9uIG50KHQpe3JldHVybiEhci5leGlzdHNTeW5jKHQpJiYoIXIubHN0YXRTeW5jKHQpLmlzRmlsZSgpJiYhci5sc3RhdFN5bmModCkuaXNTeW1ib2xpY0xpbmsoKSl9ZnVuY3Rpb24gaXQodCl7cmV0dXJuISFyLmV4aXN0c1N5bmModCkmJighci5sc3RhdFN5bmModCkuaXNEaXJlY3RvcnkoKSYmIXIubHN0YXRTeW5jKHQpLmlzU3ltYm9saWNMaW5rKCkpfWZ1bmN0aW9uIG90KHQpe2lmKCFyLmV4aXN0c1N5bmModCkpcmV0dXJue3N1Y2Nlc3M6ImZpbGUgZG9lcyBub3QgZXhpc3Q6ICIrdH07aWYoIWl0KHQpKXJldHVybntlcnJvcjoiaW5wdXQgcGF0aCBpcyBub3QgYSBmaWxlOiAiK3R9O3RyeXtyLnVubGlua1N5bmModCl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fXJldHVybntzdWNjZXNzOiJkb25lOiAiK3R9fWFzeW5jIGZ1bmN0aW9uIHV0KHQsaSxvKXtsZXQgdT0iIjtpZighbihmPWkpfHwwPT09Zi5sZW5ndGh8fDE9PT1mLmxlbmd0aCYmYyhmWzBdKSl0aHJvdyBuZXcgRXJyb3IoImZwc0luIGluIG5vdCBhbiBlZmZlY3RpdmUgYXJyYXkiKTt2YXIgZjtsZXQgbD1ldChvKTtudChsKXx8ZnVuY3Rpb24odCl7aWYobnQodCkpcmV0dXJue3N1Y2Nlc3M6ImlucHV0IGZvbGRlciBpcyBhbHJlYWR5IGV4aXN0czogIit0fTtpZihyLmV4aXN0c1N5bmModCkpcmV0dXJue2Vycm9yOiJpbnB1dCBwYXRoIGFscmVhZHkgZXhpc3RzOiAiK3R9O3RyeXtyLm1rZGlyU3luYyh0LHtyZWN1cnNpdmU6ITB9KX1jYXRjaCh0KXtyZXR1cm57ZXJyb3I6dH19fShsKTtsZXQgYT1lKCk7dHJ5e2xldCBuPXIuY3JlYXRlV3JpdGVTdHJlYW0obyk7Zm9yKGxldCB0PTA7dDxpLmxlbmd0aDt0Kyspe2xldCBvPWlbdF07aWYoIWl0KG8pKXRocm93IG5ldyBFcnJvcihgZnBJblske299XSBpcyBub3QgYSBmaWxlYCk7bGV0IGM9KCk9PntsZXQgdD1lKCksaT1yLmNyZWF0ZVJlYWRTdHJlYW0obyk7cmV0dXJuIGkub24oImVycm9yIiwocj0+e3U9ci5tZXNzYWdlLHQucmVqZWN0KHIpfSkpLGkub24oImVuZCIsKCgpPT57b3QobyksdC5yZXNvbHZlKCl9KSksaS5waXBlKG4se2VuZDohMX0pLHR9O2F3YWl0IGMoKX1uLmVuZCgpLG4ub24oImVycm9yIiwodD0+e3U9dC5tZXNzYWdlLGEucmVqZWN0KHUpfSkpLG4ub24oImZpbmlzaCIsKCgpPT57bGV0IHI9e2ZpbGVuYW1lOnQscGF0aDpvfTthLnJlc29sdmUocil9KSl9Y2F0Y2godCl7dT10Lm1lc3NhZ2UsYS5yZWplY3QodSl9cmV0dXJuIGF9bGV0IG1lcmdlRmlsZXM9YXN5bmMocixlLG4saSk9PntsZXQgbz1bXTtmb3IobGV0IGk9MDtpPG47aSsrKXtsZXQgbj10LmpvaW4ocixgJHtlfV8ke2l9YCk7by5wdXNoKG4pfWxldCB1PXQuam9pbihyLGUpO3JldHVybiBhd2FpdCB1dChpLG8sdSl9OwoKCmxldCBpbnN0YW5jZSA9IG51bGwKZnVuY3Rpb24gaW5pdChpbnB1dCl7CgogICAgLy9pbml0CiAgICBsZXQgcgogICAgCiAgICAgICAgciA9IHsKICAgICAgICAgICAgbWFpbjogbWVyZ2VGaWxlcwogICAgICAgIH0KICAgICAgICAKCiAgICAvL29uCiAgICAKCiAgICAvL3NhdmUKICAgIGluc3RhbmNlID0gcgoKfQoKZnVuY3Rpb24gc2VuZE1lc3NhZ2UoZGF0YSkgewogICAgCiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShkYXRhKQogICAgICAgIAp9Cgphc3luYyBmdW5jdGlvbiBydW4oZGF0YSkgewogICAgLy8gY29uc29sZS5sb2coJ2lubmVyIHdvcmtlciBydW4nLGRhdGEpCgogICAgLy9tb2RlCiAgICBsZXQgbW9kZSA9IGRhdGEubW9kZQoKICAgIC8vY2hlY2sKICAgIGlmKG1vZGUgIT09ICdpbml0JyAmJiBtb2RlICE9PSAnY2FsbCcpewogICAgICAgIHJldHVybgogICAgfQoKICAgIC8vaW5pdAogICAgaWYobW9kZSA9PT0gJ2luaXQnKXsKICAgICAgICAKICAgICAgICB0cnl7CgogICAgICAgICAgICAvL3R5cGUKICAgICAgICAgICAgbGV0IHR5cGUgPSBkYXRhLnR5cGUKCiAgICAgICAgICAgIC8vaW5wdXQKICAgICAgICAgICAgbGV0IGlucHV0ID0gZGF0YS5pbnB1dAogICAgCiAgICAgICAgICAgIC8vaW5zdGFuY2UKICAgICAgICAgICAgaWYodHlwZSA9PT0gJ2Z1bmN0aW9uJyl7CiAgICAgICAgICAgICAgICBpbml0KC4uLmlucHV0KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYodHlwZSA9PT0gJ29iamVjdCcpewogICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBtZXJnZUZpbGVzCiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgIGNhdGNoKGVycil7CiAgICAgICAgCiAgICAgICAgICAgIC8vc2VuZE1lc3NhZ2UKICAgICAgICAgICAgbGV0IHJlcyA9IHsKICAgICAgICAgICAgICAgIG1vZGU6ICdlbWl0JywKICAgICAgICAgICAgICAgIGV2TmFtZTogJ2Vycm9yJywKICAgICAgICAgICAgICAgIG1zZzogZXJyLAogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbmRNZXNzYWdlKHJlcykKCiAgICAgICAgfQogICAgICAgICAgICAKICAgIH0KCiAgICAvL2NoZWNrCiAgICBpZihtb2RlID09PSAnY2FsbCcpewogICAgICAgIGxldCBzdGF0ZSA9ICcnCiAgICAgICAgbGV0IG1zZyA9IG51bGwKCiAgICAgICAgdHJ5ewoKICAgICAgICAgICAgLy9mdW4KICAgICAgICAgICAgbGV0IGZ1biA9IGluc3RhbmNlW2RhdGEuZnVuXQoKICAgICAgICAgICAgLy9pbnB1dAogICAgICAgICAgICBsZXQgaW5wdXQgPSBkYXRhLmlucHV0CgogICAgICAgICAgICAvL2V4ZWMKICAgICAgICAgICAgYXdhaXQgZnVuKC4uLmlucHV0KQogICAgICAgICAgICAgICAgLnRoZW4oKHN1YykgPT4gewogICAgICAgICAgICAgICAgICAgIHN0YXRlPSdzdWNjZXNzJwogICAgICAgICAgICAgICAgICAgIG1zZz1zdWMKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgIHN0YXRlPSdlcnJvcicKICAgICAgICAgICAgICAgICAgICBtc2c9ZXJyCiAgICAgICAgICAgICAgICB9KQoKICAgICAgICB9CiAgICAgICAgY2F0Y2goZXJyKXsKICAgICAgICAgICAgc3RhdGUgPSAnZXJyb3InCiAgICAgICAgICAgIG1zZyA9IGVycgogICAgICAgIH0KICAgICAgICAKICAgICAgICAvL3NlbmRNZXNzYWdlCiAgICAgICAgbGV0IHJlcyA9IHsKICAgICAgICAgICAgbW9kZTogJ3JldHVybicsCiAgICAgICAgICAgIGlkOiBkYXRhLmlkLAogICAgICAgICAgICBmdW46IGRhdGEuZnVuLAogICAgICAgICAgICBzdGF0ZSwKICAgICAgICAgICAgbXNnLAogICAgICAgIH0KICAgICAgICBzZW5kTWVzc2FnZShyZXMpCgogICAgfQoKfQoKZnVuY3Rpb24gcmVjdk1lc3NhZ2UoZGF0YSkgewogICAgLy8gY29uc29sZS5sb2coJ2lubmVyIHdvcmtlciByZWN2OicsIGRhdGEpCgogICAgLy9kYXRhUmVjdgogICAgbGV0IGRhdGFSZWN2ID0gZGF0YQoKICAgIC8vcnVuCiAgICBydW4oZGF0YVJlY3YpCgp9CgoKICAgICAgICBzZWxmLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHJlY3ZNZXNzYWdlKGUuZGF0YSkKICAgICAgICB9CiAgICAgICAgCgp0cnl7CiAgICBwcm9jZXNzLm9uKCd1bmhhbmRsZWRSZWplY3Rpb24nLCAoZXJyKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ2lubmVyOnVuaGFuZGxlZFJlamVjdGlvbicsIGVycikKICAgIH0pCiAgICBwcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIChlcnIpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygnaW5uZXI6dW5jYXVnaHRFeGNlcHRpb24nLCBlcnIpCiAgICB9KQogICAgcHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb25Nb25pdG9yJywgKGVycikgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdpbm5lcjp1bmNhdWdodEV4Y2VwdGlvbk1vbml0b3InLCBlcnIpCiAgICB9KQp9CmNhdGNoKGVycil7fQoK");function t(){let t=new C,n=function(e){try{let t=new Blob([e]),n=window.URL||window.webkitURL;return new Worker(n.createObjectURL(t))}catch(e){o(e)}}(e);if(!n)return o("invalid worker"),null;function r(){let e=function(){let e,t,n=new Promise((function(){e=arguments[0],t=arguments[1]}));return n.resolve=e,n.reject=t,n}(),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=[],n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=n.length;for(let o=0;o<e;o++)t[o]=n[0|Math.random()*r];return t.join("")}(),o={mode:"call",id:r,fun:"main",input:[...arguments]};return n.postMessage(o),t.once(r,(t=>{"success"===t.state?e.resolve(t.msg):e.reject(t.msg)})),e}function o(e){t.emit("error",e)}return n.onmessage=function(e){!function(e){let n=e,r=n.mode;"emit"!==r&&"return"!==r||("emit"===r&&t.emit(n.evName,n.msg),"return"===r&&t.emit(n.id,n))}(e.data)},n.onerror=o,n.onmessageerror=function(e){o(e.data)},function(){let e={mode:"init",type:"function",input:[...arguments]};n.postMessage(e)}([...arguments]),t.main=r,t.main=r,t.terminate=function(){n?(n.terminate(),n=void 0):o("worker has been terminated")},t}m=async function(){let e=[...arguments],n=t();return await n.main(...e).finally((()=>{n.terminate()}))}}();try{process.on("unhandledRejection",(e=>{console.log("outer:unhandledRejection",e)})),process.on("uncaughtException",(e=>{console.log("outer:uncaughtException",e)})),process.on("uncaughtExceptionMonitor",(e=>{console.log("outer:uncaughtExceptionMonitor",e)}))}catch(e){}return m}()}({get exports(){return r},set exports(e){r=e}});var o=r;let i;return i="undefined"!=typeof window&&void 0!==window.document?o:n,i}(c)}({get exports(){return Ln},set exports(e){Ln=e}});var _n=Ln;function Fn(){let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=Ae(i,"port");$e(c)||(c=8080);let a=Ae(i,"useInert");lt(a)||(a=!0);let u=Ae(i,"pathStaticFiles");Pe(u)||(u="dist");let l=Ae(i,"apiName");Pe(l)||(l="api");let s=Ae(i,"pathUploadTemp");Pe(s)||(s="./uploadTemp"),Pn(s)||function(e){if(Pn(e))return{success:"input folder is already exists: "+e};if(r.existsSync(e))return{error:"input path already exists: "+e};try{r.mkdirSync(e,{recursive:!0})}catch(e){return{error:e}}}(s);let d=Ae(i,"tokenType");Pe(d)||(d="Bearer");let f=Ae(i,"verifyConn");we(f)||(f=()=>!0);let g=Ae(i,"corsOrigins",[]);at(g)||(g=["*"]);let p=Ae(i,"delayForBasic","");mt(p)||(p=0),p=De(p);let I=Ae(i,"delayForSlice","");mt(I)||(I=100),I=De(I);let h=null;h=Ae(i,"serverHapi")?i.serverHapi:e.server({port:c,routes:{timeout:{server:!1,socket:!1},cors:{origin:g,credentials:!1}}});let y=ft(),C=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];setTimeout((()=>{y.emit(e,...n)}),1)};async function m(e){let t=gt(),n=gt();return n.then((e=>{t.resolve(e)})).catch((e=>{t.reject(e)})),C("download",e,n),t}function b(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=new o.Readable;r._read=()=>{},r.push(t),r.push(null);let i=Ae(n,"returnType",""),c=Ae(n,"returnMsg",""),a=e.response(r).header("Cache-Control","no-cache, no-store, must-revalidate").header("Content-Type","application/octet-stream").header("Content-Length",r.readableLength);return Pe(i)&&a.header("Return-Type",i),Pe(c)&&a.header("Return-Msg",c),a}function v(e,t){return Pe(t)||(console.log("msg",t),console.log("msg is not an effective string, set msg=''"),t=""),b(e,Yn({error:t}),{returnType:"error",returnMsg:t})}let A={path:`/${l}`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,output:"stream",parse:!1},timeout:{server:!1,socket:!1}},handler:async function(e,t){let n=Ae(e,"headers");n=Ct(n)?n:"";let r=Ae(e,"query");r=Ct(r)?r:"";let i=Ae(n,"authorization","");i=Pe(i)?i:"";{let e=f({apiType:"main",authorization:i,headers:n,query:r});if(pt(e)&&(e=await e),!0!==e)return v(t,"permission denied")}C("handler",{api:"apiMain",headers:n,query:r});let c=await(()=>{let t=gt(),n=[],r=new o.Writable({write(e,t,r){n.push(e),setTimeout((()=>{r()}),p)}});return e.payload.pipe(r),e.payload.on("end",(()=>{let e=Buffer.concat(n);n=[],t.resolve(e)})),e.payload.on("error",(e=>{C("error","receive payload err"),t.reject(e.message)})),t})(),a=Rn(new Uint8Array(c)),u={},l="",s="";return await async function(e){let t=gt(),n=gt();n.then((n=>{e.output=n,delete e.input,t.resolve(e)})).catch((e=>{t.reject(e)}));{let t=Ae(e,"func",""),r=Ae(e,"input",null);C("execute",t,r,n)}return t}(a).then((e=>{u.success=e,l="success",s="need to parse"})).catch((e=>{u.error=e,l="error",s="need to parse"})),b(t,Yn(u),{returnType:l,returnMsg:s})}},Z={path:`/${l}ulckh`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,parse:!0},timeout:{server:!1,socket:!1}},handler:async function(e,t){let r=Ae(e,"headers");r=Ct(r)?r:"";let o=Ae(e,"query");o=Ct(o)?o:"";let i=Ae(r,"authorization","");i=Pe(i)?i:"";{let e=f({apiType:"upload-check-slice-hash",authorization:i,headers:r,query:o});if(pt(e)&&(e=await e),!0!==e)return v(t,"permission denied")}C("handler",{api:"apiUploadCheckHash",headers:r,query:o});let c=Ae(e,"payload.filename",""),a=Ae(e,"payload.fileHash","");if(!Pe(c))return v(t,"invalid filename in payload");if(!Pe(a))return v(t,"invalid fileHash in payload");let u=n.join(s,c);if(!Nn(u)){return b(t,Yn({success:{existed:!1,msg:"not exist"}}),{returnType:"success",returnMsg:"need to parse"})}if(a!==await Qn(u,{useSync:!1,type:"sha256"})){return b(t,Yn({success:{existed:!1,msg:"not equal"}}),{returnType:"success",returnMsg:"need to parse"})}return b(t,Yn({success:{existed:!0,msg:"equal",path:u}}),{returnType:"success",returnMsg:"need to parse"})}},X={path:`/${l}slc`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,output:"stream",parse:!1},timeout:{server:!1,socket:!1}},handler:async function(e,t){let o=Ae(e,"headers");o=Ct(o)?o:"";let i=Ae(e,"query");i=Ct(i)?i:"";let c=Ae(o,"authorization","");c=Pe(c)?c:"";{let e=f({apiType:"upload-slice",authorization:c,headers:o,query:i});if(pt(e)&&(e=await e),!0!==e)return v(t,"permission denied")}C("handler",{api:"apiUploadSlice",headers:o,query:i});let a=Ae(o,"chunk-index",""),u=Ae(o,"chunk-total",""),l=Ae(o,"package-id","");if(!mt(a))return console.log("invalid chunkIndex in headers"),t.response({error:"invalid chunkIndex in headers"}).code(400);if(a=De(a),!mt(u))return console.log("invalid chunkTotal in headers"),t.response({error:"invalid chunkTotal in headers"}).code(400);if(u=De(u),!Pe(l))return console.log("invalid packageId in headers"),t.response({error:"invalid packageId in headers"}).code(400);let d=n.join(s,`${l}_${a}`),g=r.createWriteStream(d),p={},h="",y="";return await(()=>{let t=gt();return e.payload.pipe(g),e.payload.on("end",(()=>{setTimeout((()=>{t.resolve(`chunk[${a}/${u}] of packageId[${l}] done`)}),I)})),e.payload.on("error",(e=>{C("error",`receive chunk[${a}/${u}] of packageId[${l}] err`),t.reject(`apiUploadSlice receive error: ${e.message}`)})),t})().then((e=>{p.success=e,h="success",y="need to parse"})).catch((e=>{p.error=e,h="error",y="need to parse",C("error",e)})),b(t,Yn(p),{returnType:h,returnMsg:y})}},K={path:`/${l}slcm`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,parse:!0},timeout:{server:!1,socket:!1}},handler:async function(e,t){let n=Ae(e,"headers");n=Ct(n)?n:"";let r=Ae(e,"query");r=Ct(r)?r:"";let o=Ae(n,"authorization","");o=Pe(o)?o:"";{let e=f({apiType:"upload-slice-merge",authorization:o,headers:n,query:r});if(pt(e)&&(e=await e),!0!==e)return v(t,"permission denied")}C("handler",{api:"apiUploadSliceMerge",headers:n,query:r});let i=Ae(e,"payload.filename",""),c=Ae(e,"payload.chunk-total",""),a=Ae(e,"payload.package-id","");if(!Pe(i))return console.log("invalid filename in payload"),t.response({error:"invalid filename in payload"}).code(400);if(!mt(c))return console.log("invalid chunkTotal in payload"),t.response({error:"invalid chunkTotal in payload"}).code(400);if(c=De(c),!Pe(a))return console.log("invalid packageId in payload"),t.response({error:"invalid packageId in payload"}).code(400);let u={},l="",d="";return await(async()=>{let e=await _n(s,a,c,i);return await async function(e){let t=gt(),n=gt();return n.then((e=>{t.resolve(e)})).catch((e=>{t.reject(e)})),C("upload",e,n),t}(e)})().then((e=>{u.success=e,l="success",d="need to parse"})).catch((e=>{u.error=e,l="error",d="need to parse",C("error",`${e.message}`)})),b(t,Yn(u),{returnType:l,returnMsg:d})}},w={path:`/${l}dwgfn`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,parse:!0},timeout:{server:!1,socket:!1}},handler:async function(e,t){let n=Ae(e,"headers");n=Ct(n)?n:"";let r=Ae(e,"query");r=Ct(r)?r:"";let o=Ae(n,"authorization","");o=Pe(o)?o:"";{let e=f({apiType:"download-get-filename",authorization:o,headers:n,query:r});if(pt(e)&&(e=await e),!0!==e)return v(t,"permission denied")}C("handler",{api:"apiDownloadGetFilename",headers:n,query:r});let i=Ae(e,"payload.fileId","");if(!Pe(i))return v(t,"invalid fileId in payload");let c={fileId:i},a={},u="",l="";await m(c).then((e=>{a.success=e,u="success",l="need to parse"})).catch((e=>{a.error=e,u="error",l="need to parse"}));let s=Ae(a,"success"),d=Ae(s,"streamRead");try{d.destroy()}catch(e){}let g=Ae(s,"filename");return Pe(g)?(a={success:{filename:g}},b(t,Yn(a),{returnType:u,returnMsg:l})):v(t,"invalid filename")}},j={path:`/${l}dwgf`,method:"GET",options:{timeout:{server:!1,socket:!1}},handler:async function(e,t){let n=Ae(e,"headers");n=Ct(n)?n:"";let r=Ae(e,"query");r=Ct(r)?r:"";let o=Ae(r,"token","");o=Pe(o)?o:"";let i="";Pe(o)&&(i=`${d} ${o}`);{let e=f({apiType:"download-get-file",authorization:i,headers:n,query:r});if(pt(e)&&(e=await e),!0!==e)return v(t,"permission denied")}C("handler",{api:"apiDownloadGetFilename",headers:n,query:r});let c=Ae(r,"fileId","");if(c=Pe(c)?c:"",!Pe(c))return v(t,"invalid fileId in query");let a={fileId:c},u={};if(await m(a).then((e=>{u.success=e})).catch((e=>{u.error=e})),St(u,"error"))return v(t,"can not get file from fileId");let l=Ae(u,"success"),s=Ae(l,"streamRead"),g=Ae(l,"fileSize");if(!yt(g)){try{s.destroy()}catch(e){}return v(t,"invalid fileSize")}let p=Ae(l,"fileType");if(!Pe(p)){try{s.destroy()}catch(e){}return v(t,"invalid fileType")}return p=bt(p),t.response(s).type(p).header("Content-Length",g)}},W={path:`/${l}dw`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,parse:!0},timeout:{server:!1,socket:!1}},handler:async function(e,t){let n=Ae(e,"headers");n=Ct(n)?n:"";let r=Ae(e,"query");r=Ct(r)?r:"";let o=Ae(n,"authorization","");o=Pe(o)?o:"";{let e=f({apiType:"download",authorization:o,headers:n,query:r});if(pt(e)&&(e=await e),!0!==e)return v(t,"permission denied")}C("handler",{api:"apiDownload",headers:n,query:r});let i=Ae(e,"payload.fileId","");if(!Pe(i))return v(t,"invalid fileId in payload");let c={fileId:i},a={};if(await m(c).then((e=>{a.success=e})).catch((e=>{a.error=e})),St(a,"error"))return v(t,"can not get file from fileId");let u=Ae(a,"success"),l=Ae(u,"streamRead"),s=Ae(u,"filename");if(!Pe(s)){try{l.destroy()}catch(e){}return v(t,"invalid filename")}s=Gt(s);let d=Ae(u,"fileSize");if(!yt(d)){try{l.destroy()}catch(e){}return v(t,"invalid fileSize")}let g=Ae(u,"fileType");if(!Pe(g)){try{l.destroy()}catch(e){}return v(t,"invalid fileType")}return g=bt(g),t.response(l).type(g).header("Content-Disposition",`attachment; filename="${s}"`).header("Content-Length",d)}};Ae(i,"serverHapi")?h.route([A,Z,X,K,w,j,W]):async function(){a&&await h.register(t);let e=[];if(a){let t={method:"GET",path:"/{file*}",handler:{directory:{path:`${u}/`}}};e=[...e,t]}e=[...e,A,Z,X,K,w,j,W],h.route(e),await h.start(),console.log(`Server running at: ${h.info.uri}`)}();return y.stop=()=>{h.stop()},y}function Un(e){return Un="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Un(e)}function Mn(e){var t=function(e,t){if("object"!==Un(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==Un(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===Un(t)?t:String(t)}function zn(e,t,n){return(t=Mn(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var En=function(){return s.Date.now()},Dn="Expected a function",$n=Math.max,qn=Math.min;function er(e,t,n){var r,o,i,c,a,u,l=0,s=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError(Dn);function g(t){var n=r,i=o;return r=o=void 0,l=t,c=e.apply(i,n)}function p(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-l>=i}function I(){var e=En();if(p(e))return h(e);a=setTimeout(I,function(e){var n=t-(e-u);return d?qn(n,i-(e-l)):n}(e))}function h(e){return a=void 0,f&&r?g(e):(r=o=void 0,c)}function y(){var e=En(),n=p(e);if(r=arguments,o=this,u=e,n){if(void 0===a)return function(e){return l=e,a=setTimeout(I,t),s?g(e):c}(u);if(d)return clearTimeout(a),a=setTimeout(I,t),g(u)}return void 0===a&&(a=setTimeout(I,t)),c}return t=Je(t)||0,j(n)&&(s=!!n.leading,i=(d="maxWait"in n)?$n(Je(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f),y.cancel=function(){void 0!==a&&clearTimeout(a),l=0,r=u=o=a=void 0},y.flush=function(){return void 0===a?c:h(En())},y}function tr(e){var t=this.__data__=new q(e);this.size=t.size}tr.prototype.clear=function(){this.__data__=new q,this.size=0},tr.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},tr.prototype.get=function(e){return this.__data__.get(e)},tr.prototype.has=function(e){return this.__data__.has(e)},tr.prototype.set=function(e,t){var n=this.__data__;if(n instanceof q){var r=n.__data__;if(!ee||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ne(r)}return n.set(e,t),this.size=n.size,this};var nr=function(){try{var e=_(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),rr=nr;function or(e,t,n){"__proto__"==t&&rr?rr(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ir(e,t,n){(void 0!==n&&!E(e[t],n)||void 0===n&&!(t in e))&&or(e,t,n)}var cr="object"==typeof exports&&exports&&!exports.nodeType&&exports,ar=cr&&"object"==typeof module&&module&&!module.nodeType&&module,ur=ar&&ar.exports===cr?s.Buffer:void 0,lr=ur?ur.allocUnsafe:void 0;function sr(e,t){if(t)return e.slice();var n=e.length,r=lr?lr(n):new e.constructor(n);return e.copy(r),r}var dr=s.Uint8Array;function fr(e){var t=new e.constructor(e.byteLength);return new dr(t).set(new dr(e)),t}function gr(e,t){var n=t?fr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function pr(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var Ir=Object.create,hr=function(){function e(){}return function(t){if(!j(t))return{};if(Ir)return Ir(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),yr=hr;function Cr(e){return"function"!=typeof e.constructor||an(e)?{}:yr(An(e))}function mr(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var br=Object.prototype.hasOwnProperty;function vr(e,t,n){var r=e[t];br.call(e,t)&&E(r,n)&&(void 0!==n||t in e)||or(e,t,n)}function Ar(e,t,n,r){var o=!n;n||(n={});for(var i=-1,c=t.length;++i<c;){var a=t[i],u=r?r(n[a],e[a],a,n,e):void 0;void 0===u&&(u=e[a]),o?or(n,a,u):vr(n,a,u)}return n}var Zr=Object.prototype.hasOwnProperty;function Xr(e){if(!j(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=an(e),n=[];for(var r in e)("constructor"!=r||!t&&Zr.call(e,r))&&n.push(r);return n}function Kr(e){return fn(e)?on(e,!0):Xr(e)}function wr(e,t,n,r,o,i,c){var u=mr(e,n),l=mr(t,n),s=c.get(l);if(s)ir(e,n,s);else{var d,f=i?i(u,l,n+"",e,t,c):void 0,g=void 0===f;if(g){var p=a(l),I=!p&&Qt(l),h=!p&&!I&&nn(l);f=l,p||I||h?a(u)?f=u:v(d=u)&&fn(d)?f=pr(u):I?(g=!1,f=sr(l,!0)):h?(g=!1,f=gr(l,!0)):f=[]:Gn(l)||kt(l)?(f=u,kt(u)?f=function(e){return Ar(e,Kr(e))}(u):j(u)&&!V(u)||(f=Cr(l))):g=!1}g&&(c.set(l,f),o(f,l,r,i,c),c.delete(l)),ir(e,n,f)}}function jr(e,t,n,r,o){e!==t&&xt(t,(function(i,c){if(o||(o=new tr),j(i))wr(e,t,c,n,jr,r,o);else{var a=r?r(mr(e,c),i,c+"",e,t,o):void 0;void 0===a&&(a=i),ir(e,c,a)}}),Kr)}var Wr=Math.max;var Gr=rr?function(e,t){return rr(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:hn,Sr=Gr,Hr=Date.now;var Vr=function(e){var t=0,n=0;return function(){var r=Hr(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Sr),xr=Vr;function Tr(e,t){return xr(function(e,t,n){return t=Wr(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=Wr(r.length-t,0),c=Array(i);++o<i;)c[o]=r[t+o];o=-1;for(var a=Array(t+1);++o<t;)a[o]=r[o];return a[t]=n(c),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,a)}}(e,t,hn),e+"")}var Yr,Jr=(Yr=function(e,t,n){jr(e,t,n)},Tr((function(e,t){var n=-1,r=t.length,o=r>1?t[r-1]:void 0,i=r>2?t[2]:void 0;for(o=Yr.length>3&&"function"==typeof o?(r--,o):void 0,i&&function(e,t,n){if(!j(n))return!1;var r=typeof t;return!!("number"==r?fn(n)&&Ft(t,n.length):"string"==r&&t in n)&&E(n[t],e)}(t[0],t[1],i)&&(o=r<3?void 0:o,r=1),e=Object(e);++n<r;){var c=t[n];c&&Yr(e,c,n,o)}return e})));function Br(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={};if(Ct(e)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),e=ft()),!St(e,"emit"))throw new Error("instWConverServer is not an EventEmitter");let o=Ae(t,"fpTableTags","");Pe(o)||(o="./tableTags.json");let i=Ae(t,"genTag");we(i)||(i=()=>je()+"|"+tt(6));let c=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];setTimeout((()=>{e.emit(t,...r)}),1)};function a(){let e={};try{if(r.existsSync(o)){let t=function(e){if(!Pe(e))return{};let t={};try{t=JSON.parse(e)}catch(e){t={}}return t}(r.readFileSync(o,"utf8"));Ct(t)&&(e=t)}}catch(e){c("error",{msg:"readTableTags catch",err:e})}return e}function u(){try{let e=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(rt(e))return"";let n="";try{n=t?JSON.stringify(e,null,2):JSON.stringify(e)}catch(e){n=""}return n}(n);r.writeFileSync(o,e,"utf8")}catch(e){c("error",{msg:"writeTableTags catch",err:e})}}let l=er((()=>{u(),c("changeTableTags",n)}),200);return e.readTableTags=a,e.writeTableTags=u,e.initTableTags=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"useInputFirst";if("useInputOnly"===t)n=e;else if("useStorageOnly"===t)n=a();else if("useInputFirst"===t)n=Jr(a(),e);else{if("useStorageFirst"!==t)throw new Error(`invalid mode[${t}]`);n=Jr(e,a())}u()},e.setTableTags=function(){n=Jr(n,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),u()},e.getTableTags=function(){return n},e.updateTableTag=function(e){n[e]=i(),l()},e}function Or(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new ne;++t<n;)this.add(e[t])}function kr(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function Rr(e,t){return e.has(t)}Or.prototype.add=Or.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Or.prototype.has=function(e){return this.__data__.has(e)};var Nr=1,Pr=2;function Qr(e,t,n,r,o,i){var c=n&Nr,a=e.length,u=t.length;if(a!=u&&!(c&&u>a))return!1;var l=i.get(e),s=i.get(t);if(l&&s)return l==t&&s==e;var d=-1,f=!0,g=n&Pr?new Or:void 0;for(i.set(e,t),i.set(t,e);++d<a;){var p=e[d],I=t[d];if(r)var h=c?r(I,p,d,t,e,i):r(p,I,d,e,t,i);if(void 0!==h){if(h)continue;f=!1;break}if(g){if(!kr(t,(function(e,t){if(!Rr(g,t)&&(p===e||o(p,e,n,r,i)))return g.push(t)}))){f=!1;break}}else if(p!==I&&!o(p,I,n,r,i)){f=!1;break}}return i.delete(e),i.delete(t),f}function Lr(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function _r(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Fr=1,Ur=2,Mr="[object Boolean]",zr="[object Date]",Er="[object Error]",Dr="[object Map]",$r="[object Number]",qr="[object RegExp]",eo="[object Set]",to="[object String]",no="[object Symbol]",ro="[object ArrayBuffer]",oo="[object DataView]",io=d?d.prototype:void 0,co=io?io.valueOf:void 0;function ao(e,t){for(var n=-1,r=t.length,o=e.length;++n<r;)e[o+n]=t[n];return e}function uo(e,t,n){var r=t(e);return a(e)?r:ao(r,n(e))}function lo(){return[]}var so=Object.prototype.propertyIsEnumerable,fo=Object.getOwnPropertySymbols,go=fo?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,o=0,i=[];++n<r;){var c=e[n];t(c,n,e)&&(i[o++]=c)}return i}(fo(e),(function(t){return so.call(e,t)})))}:lo,po=go;function Io(e){return uo(e,gn,po)}var ho=1,yo=Object.prototype.hasOwnProperty;var Co=_(s,"DataView"),mo=_(s,"Promise"),bo=_(s,"Set"),vo=_(s,"WeakMap"),Ao="[object Map]",Zo="[object Promise]",Xo="[object Set]",Ko="[object WeakMap]",wo="[object DataView]",jo=B(Co),Wo=B(ee),Go=B(mo),So=B(bo),Ho=B(vo),Vo=b;(Co&&Vo(new Co(new ArrayBuffer(1)))!=wo||ee&&Vo(new ee)!=Ao||mo&&Vo(mo.resolve())!=Zo||bo&&Vo(new bo)!=Xo||vo&&Vo(new vo)!=Ko)&&(Vo=function(e){var t=b(e),n="[object Object]"==t?e.constructor:void 0,r=n?B(n):"";if(r)switch(r){case jo:return wo;case Wo:return Ao;case Go:return Zo;case So:return Xo;case Ho:return Ko}return t});var xo=Vo,To=1,Yo="[object Arguments]",Jo="[object Array]",Bo="[object Object]",Oo=Object.prototype.hasOwnProperty;function ko(e,t,n,r,o,i){var c=a(e),u=a(t),l=c?Jo:xo(e),s=u?Jo:xo(t),d=(l=l==Yo?Bo:l)==Bo,f=(s=s==Yo?Bo:s)==Bo,g=l==s;if(g&&Qt(e)){if(!Qt(t))return!1;c=!0,d=!1}if(g&&!d)return i||(i=new tr),c||nn(e)?Qr(e,t,n,r,o,i):function(e,t,n,r,o,i,c){switch(n){case oo:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case ro:return!(e.byteLength!=t.byteLength||!i(new dr(e),new dr(t)));case Mr:case zr:case $r:return E(+e,+t);case Er:return e.name==t.name&&e.message==t.message;case qr:case to:return e==t+"";case Dr:var a=Lr;case eo:var u=r&Fr;if(a||(a=_r),e.size!=t.size&&!u)return!1;var l=c.get(e);if(l)return l==t;r|=Ur,c.set(e,t);var s=Qr(a(e),a(t),r,o,i,c);return c.delete(e),s;case no:if(co)return co.call(e)==co.call(t)}return!1}(e,t,l,n,r,o,i);if(!(n&To)){var p=d&&Oo.call(e,"__wrapped__"),I=f&&Oo.call(t,"__wrapped__");if(p||I){var h=p?e.value():e,y=I?t.value():t;return i||(i=new tr),o(h,y,n,r,i)}}return!!g&&(i||(i=new tr),function(e,t,n,r,o,i){var c=n&ho,a=Io(e),u=a.length;if(u!=Io(t).length&&!c)return!1;for(var l=u;l--;){var s=a[l];if(!(c?s in t:yo.call(t,s)))return!1}var d=i.get(e),f=i.get(t);if(d&&f)return d==t&&f==e;var g=!0;i.set(e,t),i.set(t,e);for(var p=c;++l<u;){var I=e[s=a[l]],h=t[s];if(r)var y=c?r(h,I,s,t,e,i):r(I,h,s,e,t,i);if(!(void 0===y?I===h||o(I,h,n,r,i):y)){g=!1;break}p||(p="constructor"==s)}if(g&&!p){var C=e.constructor,m=t.constructor;C==m||!("constructor"in e)||!("constructor"in t)||"function"==typeof C&&C instanceof C&&"function"==typeof m&&m instanceof m||(g=!1)}return i.delete(e),i.delete(t),g}(e,t,n,r,o,i))}function Ro(e,t,n,r,o){return e===t||(null==e||null==t||!v(e)&&!v(t)?e!=e&&t!=t:ko(e,t,n,r,Ro,o))}var No=1,Po=2;function Qo(e){return e==e&&!j(e)}function Lo(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function _o(e){var t=function(e){for(var t=gn(e),n=t.length;n--;){var r=t[n],o=e[r];t[n]=[r,o,Qo(o)]}return t}(e);return 1==t.length&&t[0][2]?Lo(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,r){var o=n.length,i=o,c=!r;if(null==e)return!i;for(e=Object(e);o--;){var a=n[o];if(c&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++o<i;){var u=(a=n[o])[0],l=e[u],s=a[1];if(c&&a[2]){if(void 0===l&&!(u in e))return!1}else{var d=new tr;if(r)var f=r(l,s,u,e,t,d);if(!(void 0===f?Ro(s,l,No|Po,r,d):f))return!1}}return!0}(n,e,t)}}function Fo(e,t){return null!=e&&t in Object(e)}function Uo(e,t){return null!=e&&function(e,t,n){for(var r=-1,o=(t=Ce(t,e)).length,i=!1;++r<o;){var c=be(t[r]);if(!(i=null!=e&&n(e,c)))break;e=e[c]}return i||++r!=o?i:!!(o=null==e?0:e.length)&&Mt(o)&&Ft(c,o)&&(a(e)||kt(e))}(e,t,Fo)}var Mo=1,zo=2;function Eo(e){return function(t){return null==t?void 0:t[e]}}function Do(e){return w(e)?Eo(be(e)):function(e){return function(t){return ve(t,e)}}(e)}function $o(e){return"function"==typeof e?e:null==e?hn:"object"==typeof e?a(e)?function(e,t){return w(e)&&Qo(t)?Lo(be(e),t):function(n){var r=Ae(n,e);return void 0===r&&r===t?Uo(n,e):Ro(t,r,Mo|zo)}}(e[0],e[1]):_o(e):Do(e)}function qo(e,t){var n=-1,r=fn(e)?Array(e.length):[];return In(e,(function(e,o,i){r[++n]=t(e,o,i)})),r}var ei=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)ao(t,po(e)),e=An(e);return t}:lo,ti=ei;function ni(e){return uo(e,Kr,ti)}var ri=Object.prototype.hasOwnProperty;var oi=/\w*$/;var ii=d?d.prototype:void 0,ci=ii?ii.valueOf:void 0;var ai="[object Boolean]",ui="[object Date]",li="[object Map]",si="[object Number]",di="[object RegExp]",fi="[object Set]",gi="[object String]",pi="[object Symbol]",Ii="[object ArrayBuffer]",hi="[object DataView]",yi="[object Float32Array]",Ci="[object Float64Array]",mi="[object Int8Array]",bi="[object Int16Array]",vi="[object Int32Array]",Ai="[object Uint8Array]",Zi="[object Uint8ClampedArray]",Xi="[object Uint16Array]",Ki="[object Uint32Array]";function wi(e,t,n){var r,o=e.constructor;switch(t){case Ii:return fr(e);case ai:case ui:return new o(+e);case hi:return function(e,t){var n=t?fr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case yi:case Ci:case mi:case bi:case vi:case Ai:case Zi:case Xi:case Ki:return gr(e,n);case li:return new o;case si:case gi:return new o(e);case di:return function(e){var t=new e.constructor(e.source,oi.exec(e));return t.lastIndex=e.lastIndex,t}(e);case fi:return new o;case pi:return r=e,ci?Object(ci.call(r)):{}}}var ji=en&&en.isMap,Wi=ji?Et(ji):function(e){return v(e)&&"[object Map]"==xo(e)};var Gi=en&&en.isSet,Si=Gi?Et(Gi):function(e){return v(e)&&"[object Set]"==xo(e)},Hi=1,Vi=2,xi=4,Ti="[object Arguments]",Yi="[object Function]",Ji="[object GeneratorFunction]",Bi="[object Object]",Oi={};function ki(e,t,n,r,o,i){var c,u=t&Hi,l=t&Vi,s=t&xi;if(n&&(c=o?n(e,r,o,i):n(e)),void 0!==c)return c;if(!j(e))return e;var d=a(e);if(d){if(c=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ri.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!u)return pr(e,c)}else{var f=xo(e),g=f==Yi||f==Ji;if(Qt(e))return sr(e,u);if(f==Bi||f==Ti||g&&!o){if(c=l||g?{}:Cr(e),!u)return l?function(e,t){return Ar(e,ti(e),t)}(e,function(e,t){return e&&Ar(t,Kr(t),e)}(c,e)):function(e,t){return Ar(e,po(e),t)}(e,function(e,t){return e&&Ar(t,gn(t),e)}(c,e))}else{if(!Oi[f])return o?e:{};c=wi(e,f,u)}}i||(i=new tr);var p=i.get(e);if(p)return p;i.set(e,c),Si(e)?e.forEach((function(r){c.add(ki(r,t,n,r,e,i))})):Wi(e)&&e.forEach((function(r,o){c.set(o,ki(r,t,n,o,e,i))}));var I=d?void 0:(s?l?ni:Io:l?Kr:gn)(e);return Ht(I||e,(function(r,o){I&&(r=e[o=r]),vr(c,o,ki(r,t,n,o,e,i))})),c}Oi[Ti]=Oi["[object Array]"]=Oi["[object ArrayBuffer]"]=Oi["[object DataView]"]=Oi["[object Boolean]"]=Oi["[object Date]"]=Oi["[object Float32Array]"]=Oi["[object Float64Array]"]=Oi["[object Int8Array]"]=Oi["[object Int16Array]"]=Oi["[object Int32Array]"]=Oi["[object Map]"]=Oi["[object Number]"]=Oi[Bi]=Oi["[object RegExp]"]=Oi["[object Set]"]=Oi["[object String]"]=Oi["[object Symbol]"]=Oi["[object Uint8Array]"]=Oi["[object Uint8ClampedArray]"]=Oi["[object Uint16Array]"]=Oi["[object Uint32Array]"]=!0,Oi["[object Error]"]=Oi[Yi]=Oi["[object WeakMap]"]=!1;var Ri=1,Ni=4;function Pi(e){return ki(e,Ri|Ni)}var Qi="[object String]";var Li=Eo("length"),_i=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Fi="\\ud800-\\udfff",Ui="["+Fi+"]",Mi="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",zi="\\ud83c[\\udffb-\\udfff]",Ei="[^"+Fi+"]",Di="(?:\\ud83c[\\udde6-\\uddff]){2}",$i="[\\ud800-\\udbff][\\udc00-\\udfff]",qi="(?:"+Mi+"|"+zi+")"+"?",ec="[\\ufe0e\\ufe0f]?",tc=ec+qi+("(?:\\u200d(?:"+[Ei,Di,$i].join("|")+")"+ec+qi+")*"),nc="(?:"+[Ei+Mi+"?",Mi,Di,$i,Ui].join("|")+")",rc=RegExp(zi+"(?="+zi+")|"+nc+tc,"g");function oc(e){return function(e){return _i.test(e)}(e)?function(e){for(var t=rc.lastIndex=0;rc.test(e);)++t;return t}(e):Li(e)}var ic="[object Map]",cc="[object Set]";function ac(e){if(null==e)return 0;if(fn(e))return"string"==typeof(t=e)||!a(t)&&v(t)&&b(t)==Qi?oc(e):e.length;var t,n=xo(e);return n==ic||n==cc?e.size:dn(e).length}function uc(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=ft(),n={},r=null,o=Ae(e,"timeAlive");$e(o)||(o=1e4),o=De(o);let i=Ae(e,"timeDetect");return $e(i)||(i=50),i=De(i),t.trigger=function(e,c){Pe(e)?(St(n,e)||setTimeout((()=>{t.emit("message",{eventName:"enter",key:e,data:c,now:ac(n)})}),1),n[e]={data:c,time:Date.now()},null===r&&(r=setInterval((()=>{yn(n,((e,r)=>{if(Date.now()-e.time>o){let e=Pi(n[r]);delete n[r],t.emit("message",{eventName:"leave",key:r,data:e.data,now:ac(n)})}})),Ct(n)||(clearInterval(r),r=null)}),i))):console.log("trigger need key")},t.get=function(){let e=[];return yn(n,((t,n)=>{e.push({key:n,data:t.data})})),e=Pi(e),e},t}function lc(e){let t={};if(Ct(e)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),e=ft()),!St(e,"emit"))throw new Error("instWConverServer is not an EventEmitter");let n=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];setTimeout((()=>{e.emit(t,...r)}),1)},r=uc(),o=setInterval((()=>{let e=r.get(),n=(i="key",(a(o=e)?fe:qo)(o,$o(i)));var o,i;let c={};yn(n,(e=>{c[e]=Ae(t,e,[])})),t=c}),1e3);r.on("message",(function(e){let{eventName:t,key:r,data:o,now:i}=e;"enter"===t?n("clientEnter",r,o):"leave"===t&&n("clientLeave",r,o),n("clientChange",i)})),e.on("execute",(function(e,o,i){if("[sys:polling]"===e)try{let e=Ae(o,"clientId",""),n=Ae(t,e,[]);n=Pi(n),t[e]=[],r.trigger(e,o),i.resolve(n)}catch(e){n("error",e),i.reject("[sys:polling] error")}}));return e.getClients=r.get,e.getMessages=()=>Pi(t),e.broadcast=e=>{if(!Ct(t))return;let n={};yn(t,((t,r)=>{t.push({mode:"broadcast",data:e}),n[r]=t})),t=n},e.clearBroadcast=()=>{clearInterval(o)},e}let sc=(e,t)=>{let n={};return yn(e,(e=>{let r=e,o=Ae(t,e,"");Pe(o)&&(n[r]=o)})),n};function dc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!Ct(e))throw new Error("invalid instWConverServer");if(0===ac(t))return e;if(!Ct(n))return e;let o=Ae(r,"genTag");we(o)||(o=()=>je()+"|"+tt(6));let i={};return yn(t,(e=>{i[e]=o()})),e.initTableTags(i,"useInputOnly"),yn(t,(t=>{let r=n[t];if(!r)throw new Error(`invalid kpOrm[${t}]`);try{r.on("change",(()=>{e.updateTableTag(t)}))}catch(e){throw new Error(`kpOrm[${t}] can not listen to change events`)}})),e.on("changeTableTags",(n=>{e.broadcast({mode:"syncKpTable",data:sc(t,n)})})),e}function fc(e){return e!=e}function gc(e,t,n){return t==t?function(e,t,n){for(var r=n-1,o=e.length;++r<o;)if(e[r]===t)return r;return-1}(e,t,n):function(e,t,n,r){for(var o=e.length,i=n+(r?1:-1);r?i--:++i<o;)if(t(e[i],i,e))return i;return-1}(e,fc,n)}function pc(e,t,n,r){for(var o=n-1,i=e.length;++o<i;)if(r(e[o],t))return o;return-1}var Ic=Array.prototype.splice;function hc(e,t){return e&&e.length&&t&&t.length?function(e,t,n,r){var o=r?pc:gc,i=-1,c=t.length,a=e;for(e===t&&(t=pr(t)),n&&(a=fe(e,Et(n)));++i<c;)for(var u=0,l=t[i],s=n?n(l):l;(u=o(a,s,u,r))>-1;)a!==e&&Ic.call(a,u,1),Ic.call(e,u,1);return e}(e,t):e}let yc=function(e){if(!we(e))throw new Error("fn is not a function");return function(){let t=gt(),n=null,r=null;try{n=e.apply(this,arguments)}catch(e){r=e}return null!==r?t.resolve({state:"error",msg:r}):pt(n)?n.then((e=>{t.resolve({state:"success",msg:e})})).catch((e=>{"cancelled"===Ae(e,"reason")?t.resolve({state:"cancelled",msg:""}):t.resolve({state:"error",msg:e})})):t.resolve({state:"success",msg:n}),t}};function Cc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Ct(e))throw new Error("invalid instWConverServer");let n=Ae(t,"getUserIdByToken",null);we(n)||(n=async()=>"");let r=Ae(t,"useDbOrm",null);lt(r)||(r=!1);let o=null;if(r&&(o=Ae(t,"operOrm",null),!we(o)))throw new Error("invalid opt.operOrm when useDbOrm=true");let i=[];if(r&&(i=Ae(t,"tableNames",null),!nt(i)))throw new Error("invalid opt.tableNames when useDbOrm=true");let c=[];r&&(c=Ae(t,"methods",null),nt(c)||(c=["select","insert","save","del"]));let a=Ae(t,"kpFunExt",null);let u={};async function l(e,t,r){let o="";if(!St(t,"__sysToken__"))return r.resolve({state:"error",msg:"invalid token"}),r;if(o=bt(t.__sysToken__),!St(t,"__sysInputArgs__"))return r.resolve({state:"error",msg:"invalid input"}),r;t=t.__sysInputArgs__;let i="";if(i=n(o),pt(i)&&(i=await i),Pe(i)||(i=""),"[sys:getFuncList]"===e){let e=gn(u);e=function(e,t){if(!at(e))return[];if((ot(t)||Le(t)||Ne(t)||lt(t))&&(t=[t]),!at(t))return e;let n=Pi(e);return hc(n,t),n}(e,"[sys:getTableTags]");let t={state:"success",msg:e};return r.resolve(t),r}if(!St(u,e))return r.resolve({state:"error",msg:`invalid func[${e}]`}),r;let c=u[e];try{let e=await yc(c)(i,...t);r.resolve(e)}catch(t){r.resolve({state:"error",msg:`call func[${e}] has an error: ${t.message}`})}return r}return r&&(i=Pi(i),u=function(e,t,n){let r={};return yn(e,(e=>{yn(t,(t=>{r[`${e}.${t}`]=async function(r,o){return await n(r,e,t,o)}}))})),r}(i,c,o)),Ct(a)&&yn(a,((e,t)=>{u[t]=e})),e.on("execute",(async function(t,n,r){await l(t,n,r).catch((n=>{e.emit("error",n),r.resolve({state:"error",msg:`execFun func[${t}] has an error: ${n.message}`})}))})),e}function mc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mc(Object(n),!0).forEach((function(t){zn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Ct(e)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),e=ft()),!St(e,"emit"))throw new Error("instWConverServer is not an EventEmitter");let n=Ae(t,"fpTableTags",null);Pe(n)||(n="./tableTags.json");let r=Ae(t,"genTag");we(r)||(r=()=>je()+"|"+tt(6)),e=new lc(e=new Br(e,{fpTableTags:n,genTag:r}));let o=Ae(t,"useDbOrm",null);lt(o)||(o=!0);let i=Ae(t,"kpOrm",null),c=Ae(t,"operOrm",null),a=Ae(t,"tableNamesExec",null),u=Ae(t,"methodsExec",null),l=Ae(t,"tableNamesSync",null),s=Ae(t,"getUserIdByToken",null),d=Ae(t,"kpFunExt",null);if(Ct(d)||(d={}),d=bc(bc({},d),{},{"[sys:getTableTags]":()=>{let t=e.getTableTags();return{mode:"syncKpTable",data:sc(l,t)}}}),e=new Cc(e,{getUserIdByToken:s,useDbOrm:o,operOrm:c,tableNames:a,methods:u,kpFunExt:d}),o){if(!ot(i))return e.emit("error","invalid opt.kpOrm when useDbOrm=true"),e;e=new dc(e,l,i,{genTag:r})}return e}return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=ft(),o=null,i=null,c=Ae(n,"port");Fe(c)||(c=8080);let a=Ae(n,"corsOrigins",[]);at(a)||(a=["http://localhost"]);let u=Ae(n,"useInert");lt(u)||(u=!0);let l=Ae(n,"pathStaticFiles");Pe(l)||(l="dist");let s=Ae(n,"apis");at(s)||(s=[]);let d=Ae(n,"verifyConn");we(d)||(d=()=>!0);let f=Ae(n,"apiName");Pe(f)||(f="api");let g=Ae(n,"getUserIdByToken",null),p=Ae(n,"useDbOrm",null);lt(p)||(p=!0);let I=Ae(n,"kpOrm",null),h=Ae(n,"operOrm",null),y=Ae(n,"tableNamesExec",null),C=Ae(n,"methodsExec",null),m=Ae(n,"tableNamesSync",null),b=Ae(n,"kpFunExt",null),v=Ae(n,"fnTableTags",null),A=Ae(n,"genTag");we(A)||(A=()=>je()+"|"+tt(6));let Z=Ae(n,"showLog");return lt(Z)||(Z=!0),(async()=>{await(async()=>{o=new e.Server({port:c,routes:{timeout:{server:!1,socket:!1},cors:{origin:a,credentials:!1}}}),u&&await o.register(t);let n=[];u&&(n=[{method:"GET",path:"/{file*}",handler:{directory:{path:`${l}/`}}}]),n=[...n,...s],o.route(n)})(),await(async()=>{i=new Fn({serverHapi:o,verifyConn:d,apiName:f}),i.on("open",(function(){Z&&console.log(`Server[port:${c}]: open`)})),i.on("clientChange",(function(e){Z&&console.log(`Server[port:${c}]: now clients: ${e}`)}))})(),await(async()=>{i=new vc(i,{getUserIdByToken:g,useDbOrm:p,kpOrm:I,operOrm:h,tableNamesExec:y,tableNamesSync:m,methodsExec:C,kpFunExt:b,fnTableTags:v,genTag:A}),i.on("error",(e=>{r.emit("error",e)}))})(),await o.start(),Z&&console.log(`Server running at: ${o.info.uri}`)})().catch((e=>{r.emit("error",e)})),process.on("unhandledRejection",(e=>{console.log("unhandledRejection",e),r.emit("error",{mode:"unhandledRejection",err:e})})),process.on("uncaughtException",(e=>{console.log("uncaughtException",e),r.emit("error",{mode:"uncaughtException",err:e})})),r.getServer=async()=>(await It((()=>null!==o)),o),r.getInstWConverServer=async()=>(await It((()=>null!==i)),i),r}}));
//# sourceMappingURL=w-serv-hapi-server.umd.js.map
