/*!
 * w-serv-hapi-server v1.0.29
 * (c) 2018-2021 yuda-lyu(semisphere)
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("@hapi/hapi"),require("@hapi/inert"),require("fs"),require("stream"),require("worker_threads")):"function"==typeof define&&define.amd?define(["@hapi/hapi","@hapi/inert","fs","stream","worker_threads"],e):(t="undefined"!=typeof globalThis?globalThis:t||self)["w-serv-hapi-server"]=e(t["@hapi/hapi"],t["@hapi/inert"],t.fs,t.stream,t.require$$0)}(this,(function(t,e,n,r,o){"use strict";var i=Array.isArray,c="object"==typeof global&&global&&global.Object===Object&&global,a="object"==typeof self&&self&&self.Object===Object&&self,u=c||a||Function("return this")(),l=u.Symbol,s=Object.prototype,f=s.hasOwnProperty,g=s.toString,d=l?l.toStringTag:void 0;var p=Object.prototype.toString;var I="[object Null]",h="[object Undefined]",C=l?l.toStringTag:void 0;function y(t){return null==t?void 0===t?h:I:C&&C in Object(t)?function(t){var e=f.call(t,d),n=t[d];try{t[d]=void 0;var r=!0}catch(t){}var o=g.call(t);return r&&(e?t[d]=n:delete t[d]),o}(t):function(t){return p.call(t)}(t)}function m(t){return null!=t&&"object"==typeof t}var b="[object Symbol]";function v(t){return"symbol"==typeof t||m(t)&&y(t)==b}var A=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Z=/^\w*$/;function X(t,e){if(i(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!v(t))||(Z.test(t)||!A.test(t)||null!=e&&t in Object(e))}function K(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var w="[object AsyncFunction]",j="[object Function]",W="[object GeneratorFunction]",G="[object Proxy]";function S(t){if(!K(t))return!1;var e=y(t);return e==j||e==W||e==w||e==G}var H,V=u["__core-js_shared__"],x=(H=/[^.]+$/.exec(V&&V.keys&&V.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"";var Y=Function.prototype.toString;function J(t){if(null!=t){try{return Y.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var T=/^\[object .+?Constructor\]$/,B=Function.prototype,O=Object.prototype,k=B.toString,R=O.hasOwnProperty,N=RegExp("^"+k.call(R).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function P(t){return!(!K(t)||(e=t,x&&x in e))&&(S(t)?N:T).test(J(t));var e}function Q(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return P(n)?n:void 0}var L=Q(Object,"create");var _=Object.prototype.hasOwnProperty;var F=Object.prototype.hasOwnProperty;function U(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function M(t,e){return t===e||t!=t&&e!=e}function z(t,e){for(var n=t.length;n--;)if(M(t[n][0],e))return n;return-1}U.prototype.clear=function(){this.__data__=L?L(null):{},this.size=0},U.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},U.prototype.get=function(t){var e=this.__data__;if(L){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return _.call(e,t)?e[t]:void 0},U.prototype.has=function(t){var e=this.__data__;return L?void 0!==e[t]:F.call(e,t)},U.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=L&&void 0===e?"__lodash_hash_undefined__":e,this};var E=Array.prototype.splice;function D(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}D.prototype.clear=function(){this.__data__=[],this.size=0},D.prototype.delete=function(t){var e=this.__data__,n=z(e,t);return!(n<0)&&(n==e.length-1?e.pop():E.call(e,n,1),--this.size,!0)},D.prototype.get=function(t){var e=this.__data__,n=z(e,t);return n<0?void 0:e[n][1]},D.prototype.has=function(t){return z(this.__data__,t)>-1},D.prototype.set=function(t,e){var n=this.__data__,r=z(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};var $=Q(u,"Map");function q(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function tt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}tt.prototype.clear=function(){this.size=0,this.__data__={hash:new U,map:new($||D),string:new U}},tt.prototype.delete=function(t){var e=q(this,t).delete(t);return this.size-=e?1:0,e},tt.prototype.get=function(t){return q(this,t).get(t)},tt.prototype.has=function(t){return q(this,t).has(t)},tt.prototype.set=function(t,e){var n=q(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};var et="Expected a function";function nt(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(et);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var c=t.apply(this,r);return n.cache=i.set(o,c)||i,c};return n.cache=new(nt.Cache||tt),n}nt.Cache=tt;var rt,ot,it,ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,at=/\\(\\)?/g,ut=(rt=function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(ct,(function(t,n,r,o){e.push(r?o.replace(at,"$1"):n||t)})),e},ot=nt(rt,(function(t){return 500===it.size&&it.clear(),t})),it=ot.cache,ot),lt=ut;function st(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}var ft=1/0,gt=l?l.prototype:void 0,dt=gt?gt.toString:void 0;function pt(t){if("string"==typeof t)return t;if(i(t))return st(t,pt)+"";if(v(t))return dt?dt.call(t):"";var e=t+"";return"0"==e&&1/t==-ft?"-0":e}function It(t){return null==t?"":pt(t)}function ht(t,e){return i(t)?t:X(t,e)?[t]:lt(It(t))}var Ct=1/0;function yt(t){if("string"==typeof t||v(t))return t;var e=t+"";return"0"==e&&1/t==-Ct?"-0":e}function mt(t,e){for(var n=0,r=(e=ht(e,t)).length;null!=t&&n<r;)t=t[yt(e[n++])];return n&&n==r?t:void 0}function bt(t,e,n){var r=null==t?void 0:mt(t,e);return void 0===r?n:r}var vt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},At={};!function(t,e){t.exports=function(){var t=1e3,e=6e4,n=36e5,r="millisecond",o="second",i="minute",c="hour",a="day",u="week",l="month",s="quarter",f="year",g="date",d="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,I=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],n=t%100;return"["+t+(e[(n-20)%10]||e[n]||e[0])+"]"}},C=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},y={s:C,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),o=n%60;return(e<=0?"+":"-")+C(r,2,"0")+":"+C(o,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),o=e.clone().add(r,l),i=n-o<0,c=e.clone().add(r+(i?-1:1),l);return+(-(r+(n-o)/(i?o-c:c-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:l,y:f,w:u,d:a,D:g,h:c,m:i,s:o,ms:r,Q:s}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},m="en",b={};b[m]=h;var v="$isDayjsObject",A=function(t){return t instanceof w||!(!t||!t[v])},Z=function t(e,n,r){var o;if(!e)return m;if("string"==typeof e){var i=e.toLowerCase();b[i]&&(o=i),n&&(b[i]=n,o=i);var c=e.split("-");if(!o&&c.length>1)return t(c[0])}else{var a=e.name;b[a]=e,o=a}return!r&&o&&(m=o),o||!r&&m},X=function(t,e){if(A(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new w(n)},K=y;K.l=Z,K.i=A,K.w=function(t,e){return X(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var w=function(){function h(t){this.$L=Z(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[v]=!0}var C=h.prototype;return C.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(K.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(p);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(e)}(t),this.init()},C.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},C.$utils=function(){return K},C.isValid=function(){return!(this.$d.toString()===d)},C.isSame=function(t,e){var n=X(t);return this.startOf(e)<=n&&n<=this.endOf(e)},C.isAfter=function(t,e){return X(t)<this.startOf(e)},C.isBefore=function(t,e){return this.endOf(e)<X(t)},C.$g=function(t,e,n){return K.u(t)?this[e]:this.set(n,t)},C.unix=function(){return Math.floor(this.valueOf()/1e3)},C.valueOf=function(){return this.$d.getTime()},C.startOf=function(t,e){var n=this,r=!!K.u(e)||e,s=K.p(t),d=function(t,e){var o=K.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?o:o.endOf(a)},p=function(t,e){return K.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},I=this.$W,h=this.$M,C=this.$D,y="set"+(this.$u?"UTC":"");switch(s){case f:return r?d(1,0):d(31,11);case l:return r?d(1,h):d(0,h+1);case u:var m=this.$locale().weekStart||0,b=(I<m?I+7:I)-m;return d(r?C-b:C+(6-b),h);case a:case g:return p(y+"Hours",0);case c:return p(y+"Minutes",1);case i:return p(y+"Seconds",2);case o:return p(y+"Milliseconds",3);default:return this.clone()}},C.endOf=function(t){return this.startOf(t,!1)},C.$set=function(t,e){var n,u=K.p(t),s="set"+(this.$u?"UTC":""),d=(n={},n[a]=s+"Date",n[g]=s+"Date",n[l]=s+"Month",n[f]=s+"FullYear",n[c]=s+"Hours",n[i]=s+"Minutes",n[o]=s+"Seconds",n[r]=s+"Milliseconds",n)[u],p=u===a?this.$D+(e-this.$W):e;if(u===l||u===f){var I=this.clone().set(g,1);I.$d[d](p),I.init(),this.$d=I.set(g,Math.min(this.$D,I.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},C.set=function(t,e){return this.clone().$set(t,e)},C.get=function(t){return this[K.p(t)]()},C.add=function(r,s){var g,d=this;r=Number(r);var p=K.p(s),I=function(t){var e=X(d);return K.w(e.date(e.date()+Math.round(t*r)),d)};if(p===l)return this.set(l,this.$M+r);if(p===f)return this.set(f,this.$y+r);if(p===a)return I(1);if(p===u)return I(7);var h=(g={},g[i]=e,g[c]=n,g[o]=t,g)[p]||1,C=this.$d.getTime()+r*h;return K.w(C,this)},C.subtract=function(t,e){return this.add(-1*t,e)},C.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=t||"YYYY-MM-DDTHH:mm:ssZ",o=K.z(this),i=this.$H,c=this.$m,a=this.$M,u=n.weekdays,l=n.months,s=n.meridiem,f=function(t,n,o,i){return t&&(t[n]||t(e,r))||o[n].slice(0,i)},g=function(t){return K.s(i%12||12,t,"0")},p=s||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r};return r.replace(I,(function(t,r){return r||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return K.s(e.$y,4,"0");case"M":return a+1;case"MM":return K.s(a+1,2,"0");case"MMM":return f(n.monthsShort,a,l,3);case"MMMM":return f(l,a);case"D":return e.$D;case"DD":return K.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return f(n.weekdaysMin,e.$W,u,2);case"ddd":return f(n.weekdaysShort,e.$W,u,3);case"dddd":return u[e.$W];case"H":return String(i);case"HH":return K.s(i,2,"0");case"h":return g(1);case"hh":return g(2);case"a":return p(i,c,!0);case"A":return p(i,c,!1);case"m":return String(c);case"mm":return K.s(c,2,"0");case"s":return String(e.$s);case"ss":return K.s(e.$s,2,"0");case"SSS":return K.s(e.$ms,3,"0");case"Z":return o}return null}(t)||o.replace(":","")}))},C.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},C.diff=function(r,g,d){var p,I=this,h=K.p(g),C=X(r),y=(C.utcOffset()-this.utcOffset())*e,m=this-C,b=function(){return K.m(I,C)};switch(h){case f:p=b()/12;break;case l:p=b();break;case s:p=b()/3;break;case u:p=(m-y)/6048e5;break;case a:p=(m-y)/864e5;break;case c:p=m/n;break;case i:p=m/e;break;case o:p=m/t;break;default:p=m}return d?p:K.a(p)},C.daysInMonth=function(){return this.endOf(l).$D},C.$locale=function(){return b[this.$L]},C.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=Z(t,e,!0);return r&&(n.$L=r),n},C.clone=function(){return K.w(this.$d,this)},C.toDate=function(){return new Date(this.valueOf())},C.toJSON=function(){return this.isValid()?this.toISOString():null},C.toISOString=function(){return this.$d.toISOString()},C.toString=function(){return this.$d.toUTCString()},h}(),j=w.prototype;return X.prototype=j,[["$ms",r],["$s",o],["$m",i],["$H",c],["$W",a],["$M",l],["$y",f],["$D",g]].forEach((function(t){j[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),X.extend=function(t,e){return t.$i||(t(e,w,X),t.$i=!0),X},X.locale=Z,X.isDayjs=A,X.unix=function(t){return X(1e3*t)},X.en=b[m],X.Ls=b,X.p={},X}()}({get exports(){return At},set exports(t){At=t}});var Zt=At;function Xt(t){let e=Object.prototype.toString.call(t);return"[object Function]"===e||"[object AsyncFunction]"===e}function Kt(){if(!Xt(Zt))throw new Error("invalid dayjs");return Zt().format("YYYY-MM-DDTHH:mm:ssZ")}var wt=/\s/;var jt=/^\s+/;function Wt(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&wt.test(t.charAt(e)););return e}(t)+1).replace(jt,""):t}var Gt=NaN,St=/^[-+]0x[0-9a-f]+$/i,Ht=/^0b[01]+$/i,Vt=/^0o[0-7]+$/i,xt=parseInt;function Yt(t){if("number"==typeof t)return t;if(v(t))return Gt;if(K(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=K(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Wt(t);var n=Ht.test(t);return n||Vt.test(t)?xt(t.slice(2),n?2:8):St.test(t)?Gt:+t}var Jt=1/0,Tt=17976931348623157e292;function Bt(t){return t?(t=Yt(t))===Jt||t===-Jt?(t<0?-1:1)*Tt:t==t?t:0:0===t?t:0}function Ot(t){var e=Bt(t),n=e%1;return e==e?n?e-n:e:0}function kt(t){return"[object String]"===Object.prototype.toString.call(t)}function Rt(t){return!(!kt(t)||""===t)}function Nt(t){return t!=t}function Pt(t){let e=!1;if(Rt(t))e=!isNaN(Number(t));else if(function(t){return"[object Number]"===Object.prototype.toString.call(t)}(t)){if(Nt(t))return!1;e=!0}return e}function Qt(t){if(!Pt(t))return 0;return Bt(t)}function Lt(t){return!!Pt(t)&&(t=Qt(t),"number"==typeof(e=t)&&e==Ot(e));var e}var _t=u.isFinite,Ft=Math.min;var Ut=function(t){var e=Math[t];return function(t,n){if(t=Yt(t),(n=null==n?0:Ft(Ot(n),292))&&_t(t)){var r=(It(t)+"e").split("e");return+((r=(It(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}("round"),Mt=Ut;function zt(t){if(!Pt(t))return 0;t=Qt(t);let e=Mt(t);return"0"===String(e)?0:e}function Et(t){if(!Lt(t))return!1;return zt(t)>0}let Dt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),$t=Dt.length;function qt(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=[];t=Et(t)?zt(t):32;for(let n=0;n<t;n++)e[n]=Dt[0|Math.random()*$t];return e.join("")}function te(t){return"[object Array]"===Object.prototype.toString.call(t)}function ee(t){return"[object Undefined]"===Object.prototype.toString.call(t)}function ne(t){return"[object Object]"===Object.prototype.toString.call(t)}function re(t){if(ne(t)){for(let e in t)return!1;return!0}return!1}function oe(t){return!!ee(t)||(!!function(t){return"[object Null]"===Object.prototype.toString.call(t)}(t)||(!!re(t)||(!!function(t){return!(!kt(t)||""!==t)}(t)||(!!function(t){return!!te(t)&&0===t.length}(t)||!!Nt(t)))))}function ie(t){return!!te(t)&&(0!==t.length&&(1!==t.length||!oe(t[0])))}var ce="[object Boolean]";function ae(t){return!0===(e=t)||!1===e||m(e)&&y(e)==ce;var e}var ue={};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,c),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,o,i,c){var a=n?n+t:t;if(!this._events[a])return!1;var u,l,s=this._events[a],f=arguments.length;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),f){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,r),!0;case 4:return s.fn.call(s.context,e,r,o),!0;case 5:return s.fn.call(s.context,e,r,o,i),!0;case 6:return s.fn.call(s.context,e,r,o,i,c),!0}for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];s.fn.apply(s.context,u)}else{var g,d=s.length;for(l=0;l<d;l++)switch(s[l].once&&this.removeListener(t,s[l].fn,void 0,!0),f){case 1:s[l].fn.call(s[l].context);break;case 2:s[l].fn.call(s[l].context,e);break;case 3:s[l].fn.call(s[l].context,e,r);break;case 4:s[l].fn.call(s[l].context,e,r,o);break;default:if(!u)for(g=1,u=new Array(f-1);g<f;g++)u[g-1]=arguments[g];s[l].fn.apply(s[l].context,u)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||c(this,i);else{for(var u=0,l=[],s=a.length;u<s;u++)(a[u].fn!==e||o&&!a[u].once||r&&a[u].context!==r)&&l.push(a[u]);l.length?this._events[i]=1===l.length?l[0]:l:c(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&c(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}({get exports(){return ue},set exports(t){ue=t}});var le=ue;function se(){return new le}function fe(){let t,e,n=new Promise((function(){t=arguments[0],e=arguments[1]}));return n.resolve=t,n.reject=e,n}function ge(t){let e,n=Object.prototype.toString.call(t);if(e="[object Promise]"===n,e)return!0;if("[object Function]"!==n)return!1;try{e="function"!=typeof t.subscribe&&"function"==typeof t.then}catch(t){}return e}async function de(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=fe();if(!Xt(t))return r.reject("waitfunction需輸入函數f"),r;let o=async()=>{let e=t();return ge(e)&&(e=await e),e};if(n=await o(),!0===n)return r.resolve(),r;let i=bt(e,"attemptNum",null);Et(i)||(i=200);let c=bt(e,"timeInterval",null);Et(c)||(c=1e3);let a=0,u=setInterval((async()=>{a+=1,n=await o(),!0===n&&(clearInterval(u),r.resolve()),a>i&&(clearInterval(u),r.reject(`exceeded attemptNum[${i}]`))}),c);return r}var pe="[object Number]";function Ie(t){if(ne(t)){for(let e in t)return!0;return!1}return!1}function he(t){if(!Lt(t))return!1;return zt(t)>=0}function Ce(t){if(!Rt(t)&&!Pt(t)&&!v(t))return"";let e="";try{e=String(t)}catch(t){}try{e=t.toString()}catch(t){}return e}var ye={};var me,be={},ve={get exports(){return be},set exports(t){be=t}};function Ae(){return me||(me=1,function(t,e){var n;t.exports=(n=n||function(t,e){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&void 0!==vt&&vt.crypto&&(n=vt.crypto),!n)try{n=require("crypto")}catch(t){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(t){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(t){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function t(){}return function(e){var n;return t.prototype=e,n=new t,t.prototype=null,n}}(),i={},c=i.lib={},a=c.Base={extend:function(t){var e=o(this);return t&&e.mixIn(t),e.hasOwnProperty("init")&&this.init!==e.init||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},u=c.WordArray=a.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||s).stringify(this)},concat:function(t){var e=this.words,n=t.words,r=this.sigBytes,o=t.sigBytes;if(this.clamp(),r%4)for(var i=0;i<o;i++){var c=n[i>>>2]>>>24-i%4*8&255;e[r+i>>>2]|=c<<24-(r+i)%4*8}else for(var a=0;a<o;a+=4)e[r+a>>>2]=n[a>>>2];return this.sigBytes+=o,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=a.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(r());return new u.init(e,t)}}),l=i.enc={},s=l.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],o=0;o<n;o++){var i=e[o>>>2]>>>24-o%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r+=2)n[r>>>3]|=parseInt(t.substr(r,2),16)<<24-r%8*4;return new u.init(n,e/2)}},f=l.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,r=[],o=0;o<n;o++){var i=e[o>>>2]>>>24-o%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(t){for(var e=t.length,n=[],r=0;r<e;r++)n[r>>>2]|=(255&t.charCodeAt(r))<<24-r%4*8;return new u.init(n,e)}},g=l.Utf8={stringify:function(t){try{return decodeURIComponent(escape(f.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return f.parse(unescape(encodeURIComponent(t)))}},d=c.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new u.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=g.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n,r=this._data,o=r.words,i=r.sigBytes,c=this.blockSize,a=i/(4*c),l=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*c,s=t.min(4*l,i);if(l){for(var f=0;f<l;f+=c)this._doProcessBlock(o,f);n=o.splice(0,l),r.sigBytes-=s}return new u.init(n,s)},clone:function(){var t=a.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});c.Hasher=d.extend({cfg:a.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new p.HMAC.init(t,n).finalize(e)}}});var p=i.algo={};return i}(Math),n)}(ve)),be}!function(t,e){t.exports=Ae().enc.Utf8}({get exports(){return ye},set exports(t){ye=t}});var Ze=ye,Xe={};!function(t,e){var n;t.exports=(n=Ae(),function(){var t=n,e=t.lib.WordArray;function r(t,n,r){for(var o=[],i=0,c=0;c<n;c++)if(c%4){var a=r[t.charCodeAt(c-1)]<<c%4*2|r[t.charCodeAt(c)]>>>6-c%4*2;o[i>>>2]|=a<<24-i%4*8,i++}return e.create(o,i)}t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,r=this._map;t.clamp();for(var o=[],i=0;i<n;i+=3)for(var c=(e[i>>>2]>>>24-i%4*8&255)<<16|(e[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|e[i+2>>>2]>>>24-(i+2)%4*8&255,a=0;a<4&&i+.75*a<n;a++)o.push(r.charAt(c>>>6*(3-a)&63));var u=r.charAt(64);if(u)for(;o.length%4;)o.push(u);return o.join("")},parse:function(t){var e=t.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var c=n.charAt(64);if(c){var a=t.indexOf(c);-1!==a&&(e=a)}return r(t,e,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),n.enc.Base64)}({get exports(){return Xe},set exports(t){Xe=t}});var Ke=Xe;function we(t){if(!Rt(t))return"";let e=Ze.parse(t);return Ke.stringify(e)}function je(t,e){return!!ne(t)&&(!(!Rt(e)&&!Pt(e))&&e in t)}function We(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}var Ge,Se=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),c=i.length;c--;){var a=i[Ge?c:++r];if(!1===e(o[a],a,o))break}return t};function He(t){return m(t)&&"[object Arguments]"==y(t)}var Ve=Object.prototype,xe=Ve.hasOwnProperty,Ye=Ve.propertyIsEnumerable,Je=He(function(){return arguments}())?He:function(t){return m(t)&&xe.call(t,"callee")&&!Ye.call(t,"callee")},Te=Je;var Be="object"==typeof exports&&exports&&!exports.nodeType&&exports,Oe=Be&&"object"==typeof module&&module&&!module.nodeType&&module,ke=Oe&&Oe.exports===Be?u.Buffer:void 0,Re=(ke?ke.isBuffer:void 0)||function(){return!1},Ne=9007199254740991,Pe=/^(?:0|[1-9]\d*)$/;function Qe(t,e){var n=typeof t;return!!(e=null==e?Ne:e)&&("number"==n||"symbol"!=n&&Pe.test(t))&&t>-1&&t%1==0&&t<e}var Le=9007199254740991;function _e(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Le}var Fe={};function Ue(t){return function(e){return t(e)}}Fe["[object Float32Array]"]=Fe["[object Float64Array]"]=Fe["[object Int8Array]"]=Fe["[object Int16Array]"]=Fe["[object Int32Array]"]=Fe["[object Uint8Array]"]=Fe["[object Uint8ClampedArray]"]=Fe["[object Uint16Array]"]=Fe["[object Uint32Array]"]=!0,Fe["[object Arguments]"]=Fe["[object Array]"]=Fe["[object ArrayBuffer]"]=Fe["[object Boolean]"]=Fe["[object DataView]"]=Fe["[object Date]"]=Fe["[object Error]"]=Fe["[object Function]"]=Fe["[object Map]"]=Fe["[object Number]"]=Fe["[object Object]"]=Fe["[object RegExp]"]=Fe["[object Set]"]=Fe["[object String]"]=Fe["[object WeakMap]"]=!1;var Me="object"==typeof exports&&exports&&!exports.nodeType&&exports,ze=Me&&"object"==typeof module&&module&&!module.nodeType&&module,Ee=ze&&ze.exports===Me&&c.process,De=function(){try{var t=ze&&ze.require&&ze.require("util").types;return t||Ee&&Ee.binding&&Ee.binding("util")}catch(t){}}(),$e=De&&De.isTypedArray,qe=$e?Ue($e):function(t){return m(t)&&_e(t.length)&&!!Fe[y(t)]},tn=Object.prototype.hasOwnProperty;function en(t,e){var n=i(t),r=!n&&Te(t),o=!n&&!r&&Re(t),c=!n&&!r&&!o&&qe(t),a=n||r||o||c,u=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],l=u.length;for(var s in t)!e&&!tn.call(t,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||c&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||Qe(s,l))||u.push(s);return u}var nn=Object.prototype;function rn(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||nn)}function on(t,e){return function(n){return t(e(n))}}var cn=on(Object.keys,Object),an=Object.prototype.hasOwnProperty;function un(t){if(!rn(t))return cn(t);var e=[];for(var n in Object(t))an.call(t,n)&&"constructor"!=n&&e.push(n);return e}function ln(t){return null!=t&&_e(t.length)&&!S(t)}function sn(t){return ln(t)?en(t):un(t)}var fn=function(t,e){return function(n,r){if(null==n)return n;if(!ln(n))return t(n,r);for(var o=n.length,i=e?o:-1,c=Object(n);(e?i--:++i<o)&&!1!==r(c[i],i,c););return n}}((function(t,e){return t&&Se(t,e,sn)})),gn=fn;function dn(t){return t}function pn(t,e){var n;return(i(t)?We:gn)(t,"function"==typeof(n=e)?n:dn)}function In(t){return"[object ArrayBuffer]"===Object.prototype.toString.call(t)}function hn(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)}function Cn(t){return"[object Uint16Array]"===Object.prototype.toString.call(t)}function yn(t){if(!(In(t)||(e=t,"[object Blob]"===Object.prototype.toString.call(e))||hn(t)||Cn(t)))return null;var e;try{if(t.byteLength)return t.byteLength}catch(t){}try{if(t.length)return t.length}catch(t){}try{if(t.size)return t.size}catch(t){}return null}var mn=on(Object.getPrototypeOf,Object),bn="[object Object]",vn=Function.prototype,An=Object.prototype,Zn=vn.toString,Xn=An.hasOwnProperty,Kn=Zn.call(Object);function wn(t){if(!m(t)||y(t)!=bn)return!1;var e=mn(t);if(null===e)return!0;var n=Xn.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Zn.call(n)==Kn}var jn="[object DOMException]",Wn="[object Error]";function Gn(t){if(!ne(t))return{results:"",binarys:[]};if(re(t))return{results:"",binarys:[]};let e="",n=[];try{let r=-1;e=JSON.stringify(t,(function(t,e){if(hn(e)){r+=1;let t=`[Uint8Array]::${r}`;return n.push(e),t}if(Cn(e)){r+=1;let t=`[Uint16Array]::${r}`;return n.push(e),t}if(In(e)){r+=1;let t=`[ArrayBuffer]::${r}`;return n.push(e),t}return function(t){if(!m(t))return!1;var e=y(t);return e==Wn||e==jn||"string"==typeof t.message&&"string"==typeof t.name&&!wn(t)}(e)&&(e=e.toString()),e}))}catch(t){}return{results:e,binarys:n}}function Sn(t){if(!Rt(t))return new Uint8Array;let e;try{e=function(t){if(!kt(t))return new Uint8Array;let e=Ke.parse(t),n=e.words,r=e.sigBytes,o=new Uint8Array(r);for(let t=0;t<r;t++){let e=n[t>>>2]>>>24-t%4*8&255;o[t]=e}return o}(we(t))}catch(t){return new Uint8Array}return e}function Hn(t,e){return function(t,e,n,r,o,i){if(!Pt(t))return null;if(!hn(e))return null;if(!Lt(n))return null;if(!ae(r))return null;if(!Lt(o))return null;if(!Lt(i))return null;let c,a,u;t=Qt(t);let l=8*i-o-1,s=(1<<l)-1,f=s>>1,g=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?i-1:0,p=r?-1:1,I=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,c=s):(c=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-c))<1&&(c--,u*=2),(t+=c+f>=1?g/u:g*Math.pow(2,1-f))*u>=2&&(c++,u/=2),c+f>=s?(a=0,c=s):c+f>=1?(a=(t*u-1)*Math.pow(2,o),c+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,o),c=0));o>=8;e[n+d]=255&a,d+=p,a/=256,o-=8);for(c=c<<o|a,l+=o;l>0;e[n+d]=255&c,d+=p,c/=256,l-=8);return e[n+d-p]|=128*I,null}(t,e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,!(arguments.length>3&&void 0!==arguments[3])||arguments[3],arguments.length>4&&void 0!==arguments[4]?arguments[4]:52,arguments.length>5&&void 0!==arguments[5]?arguments[5]:8)}function Vn(t){let e=[],n=[];if(!ie(t)&&!Ie(t))return null;let r=[],o=[];function i(t){r.push(yn(t)),o.push(t)}try{let c=Gn(t);i(Sn(c.results)),pn(c.binarys,(t=>{i(t)}));let a=r,u=Sn(JSON.stringify(a)),l=new Uint8Array(8);Hn(yn(u),l),e.push(l),e.push(u),pn(o,(t=>{e.push(t)})),pn(e,(t=>{n=function(t,e){let n=yn(t),r=yn(e),o=new Uint8Array(n+r);return o.set(new Uint8Array(t),0),o.set(new Uint8Array(e),n),o}(n,t)}))}catch(t){return null}return n}function xn(t){return function(t,e,n,r,o){if(!hn(t))return null;if(!Lt(e))return null;if(!ae(n))return null;if(!Lt(r))return null;if(!Lt(o))return null;let i,c,a=8*o-r-1,u=(1<<a)-1,l=u>>1,s=-7,f=n?0:o-1,g=n?1:-1,d=t[e+f];for(f+=g,i=d&(1<<-s)-1,d>>=-s,s+=a;s>0;i=256*i+t[e+f],f+=g,s-=8);for(c=i&(1<<-s)-1,i>>=-s,s+=r;s>0;c=256*c+t[e+f],f+=g,s-=8);if(0===i)i=1-l;else{if(i===u)return c?NaN:1/0*(d?-1:1);c+=Math.pow(2,r),i-=l}return(d?-1:1)*c*Math.pow(2,i-r)}(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,!(arguments.length>2&&void 0!==arguments[2])||arguments[2],arguments.length>3&&void 0!==arguments[3]?arguments[3]:52,arguments.length>4&&void 0!==arguments[4]?arguments[4]:8)}var Yn={};!function(t,e){var n;t.exports=(n=Ae(),function(){if("function"==typeof ArrayBuffer){var t=n.lib.WordArray,e=t.init,r=t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var n=t.byteLength,r=[],o=0;o<n;o++)r[o>>>2]|=t[o]<<24-o%4*8;e.call(this,r,n)}else e.apply(this,arguments)};r.prototype=t}}(),n.lib.WordArray)}({get exports(){return Yn},set exports(t){Yn=t}});var Jn=Yn;function Tn(t){if(!hn(t))return"";let e;try{n=function(t){return hn(t)?Jn.create(t).toString(Ke):""}(t),e=Rt(n)?Ke.parse(n).toString(Ze):""}catch(t){return""}var n;return e}function Bn(t){let e=null;if(!hn(t))return null;try{let n=8,r=t.slice(0,n),o=t.slice(n,yn(t)),i=xn(r),c=o.slice(0,i),a=o.slice(i,yn(o)),u=Tn(c),l=function(t,e){let n=0,r=0,o=[];return pn(e,(e=>{r=n+e;let i=t.slice(n,r);n=r,o.push(i)})),o}(a,JSON.parse(u));e=function(t){if(!Ie(t))return{};let{results:e,binarys:n}=t;if(!Rt(e))return{};if(!te(n))return{};let r={};try{r=JSON.parse(e,(function(t,e){if(Rt(e)){if(e.indexOf("[Uint8Array]::")>=0){let t=zt(e.replace("[Uint8Array]::",""));return n[t]}if(e.indexOf("[Uint16Array]::")>=0){let t=zt(e.replace("[Uint16Array]::",""));return n[t]}if(e.indexOf("[ArrayBuffer]::")>=0){let t=zt(e.replace("[ArrayBuffer]::",""));return n[t]}}return e}))}catch(t){}return r}({results:Tn(l.shift()),binarys:l})}catch(t){}return e}function On(t){return!!n.existsSync(t)&&(!n.lstatSync(t).isFile()&&!n.lstatSync(t).isSymbolicLink())}var kn={};!function(t,e){t.exports=function(t){var e={};!function(e,n){e.exports=function(t){var e={};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,c),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,o,i,c){var a=n?n+t:t;if(!this._events[a])return!1;var u,l,s=this._events[a],f=arguments.length;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),f){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,r),!0;case 4:return s.fn.call(s.context,e,r,o),!0;case 5:return s.fn.call(s.context,e,r,o,i),!0;case 6:return s.fn.call(s.context,e,r,o,i,c),!0}for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];s.fn.apply(s.context,u)}else{var g,d=s.length;for(l=0;l<d;l++)switch(s[l].once&&this.removeListener(t,s[l].fn,void 0,!0),f){case 1:s[l].fn.call(s[l].context);break;case 2:s[l].fn.call(s[l].context,e);break;case 3:s[l].fn.call(s[l].context,e,r);break;case 4:s[l].fn.call(s[l].context,e,r,o);break;default:if(!u)for(g=1,u=new Array(f-1);g<f;g++)u[g-1]=arguments[g];s[l].fn.apply(s[l].context,u)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||c(this,i);else{for(var u=0,l=[],s=a.length;u<s;u++)(a[u].fn!==e||o&&!a[u].once||r&&a[u].context!==r)&&l.push(a[u]);l.length?this._events[i]=1===l.length?l[0]:l:c(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&c(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}({get exports(){return e},set exports(t){e=t}});var n=e;let r;!function(){if("nodejs"!=("undefined"!=typeof window&&void 0!==window.document?"browser":"nodejs"))return null;let e=(o="CgogICAgICAgIC8vaW1wb3J0IHsgcGFyZW50UG9ydCB9IGZyb20gJ3dvcmtlcl90aHJlYWRzJwogICAgICAgIGxldCB7IHBhcmVudFBvcnQgfSA9IHJlcXVpcmUoJ3dvcmtlcl90aHJlYWRzJykgLy/lm6BwYWNrYWdlLmpzb27kuI3ntaZ0eXBlPW1vZHVsZeaVheeEoeazleaUr+aPtGVzNiBpbXBvcnQsIOW+l+S9v+eUqHJlcXVpcmUKICAgICAgICAvL+iLpeimgeaWvG5vZGVqcyB3b3JrZXLlhafkvb/nlKjnhKHms5Xnt6jora/nmoTljp/nlJ/lpZfku7bkvovlpoJmcywg6YG/5YWN5L2/55So6aCC5bGkaW1wb3J05Yqg6LyJ5L2/55SoLCDlm6DnhKHms5Xnt6jora/mnIPnm7TmjqXkv53nlZkKICAgICAgICAvL+S4puWboGltcG9ydOS9jeaWvHdvcmtlcuWkluWxpOmZkOWumueCunJlcXVpcmXljYAocGFja2FnZS5qc29u5LiN57WmdHlwZT1tb2R1bGUpLCDmlYXlh7rnj77pjK/oqqTnhKHms5Xnt6jora8KICAgICAgICAKCiJ1c2Ugc3RyaWN0Ijt2YXIgdD1yZXF1aXJlKCJwYXRoIikscj1yZXF1aXJlKCJmcyIpO2Z1bmN0aW9uIGUoKXtsZXQgdCxyLGU9bmV3IFByb21pc2UoKGZ1bmN0aW9uKCl7dD1hcmd1bWVudHNbMF0scj1hcmd1bWVudHNbMV19KSk7cmV0dXJuIGUucmVzb2x2ZT10LGUucmVqZWN0PXIsZX1mdW5jdGlvbiBuKHQpe3JldHVybiJbb2JqZWN0IEFycmF5XSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gaSh0KXtpZihmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBPYmplY3RdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCkpe2ZvcihsZXQgciBpbiB0KXJldHVybiExO3JldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIG8odCl7cmV0dXJuIltvYmplY3QgU3RyaW5nXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9ZnVuY3Rpb24gdSh0KXtyZXR1cm4gdCE9dH1mdW5jdGlvbiBjKHQpe3JldHVybiEhZnVuY3Rpb24odCl7cmV0dXJuIltvYmplY3QgVW5kZWZpbmVkXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9KHQpfHwoISFmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBOdWxsXSI9PT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodCl9KHQpfHwoISFpKHQpfHwoISFmdW5jdGlvbih0KXtyZXR1cm4hKCFvKHQpfHwiIiE9PXQpfSh0KXx8KCEhZnVuY3Rpb24odCl7cmV0dXJuISFuKHQpJiYwPT09dC5sZW5ndGh9KHQpfHwhIXUodCkpKSkpfWZ1bmN0aW9uIGYodCl7cmV0dXJuISghbyh0KXx8IiI9PT10KX12YXIgbD0vXHMvO3ZhciBhPS9eXHMrLztmdW5jdGlvbiBzKHQpe3JldHVybiB0P3Quc2xpY2UoMCxmdW5jdGlvbih0KXtmb3IodmFyIHI9dC5sZW5ndGg7ci0tJiZsLnRlc3QodC5jaGFyQXQocikpOyk7cmV0dXJuIHJ9KHQpKzEpLnJlcGxhY2UoYSwiIik6dH1mdW5jdGlvbiBwKHQpe3ZhciByPXR5cGVvZiB0O3JldHVybiBudWxsIT10JiYoIm9iamVjdCI9PXJ8fCJmdW5jdGlvbiI9PXIpfXZhciB5PSJvYmplY3QiPT10eXBlb2YgZ2xvYmFsJiZnbG9iYWwmJmdsb2JhbC5PYmplY3Q9PT1PYmplY3QmJmdsb2JhbCxiPSJvYmplY3QiPT10eXBlb2Ygc2VsZiYmc2VsZiYmc2VsZi5PYmplY3Q9PT1PYmplY3QmJnNlbGYsaD15fHxifHxGdW5jdGlvbigicmV0dXJuIHRoaXMiKSgpLHY9aC5TeW1ib2wsZz1PYmplY3QucHJvdG90eXBlLGo9Zy5oYXNPd25Qcm9wZXJ0eSxTPWcudG9TdHJpbmcsZD12P3YudG9TdHJpbmdUYWc6dm9pZCAwO3ZhciBtPU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7dmFyIE89IltvYmplY3QgTnVsbF0iLHg9IltvYmplY3QgVW5kZWZpbmVkXSIsUj12P3YudG9TdHJpbmdUYWc6dm9pZCAwO2Z1bmN0aW9uIHcodCl7cmV0dXJuIG51bGw9PXQ/dm9pZCAwPT09dD94Ok86UiYmUiBpbiBPYmplY3QodCk/ZnVuY3Rpb24odCl7dmFyIHI9ai5jYWxsKHQsZCksZT10W2RdO3RyeXt0W2RdPXZvaWQgMDt2YXIgbj0hMH1jYXRjaCh0KXt9dmFyIGk9Uy5jYWxsKHQpO3JldHVybiBuJiYocj90W2RdPWU6ZGVsZXRlIHRbZF0pLGl9KHQpOmZ1bmN0aW9uKHQpe3JldHVybiBtLmNhbGwodCl9KHQpfXZhciBOPSJbb2JqZWN0IFN5bWJvbF0iO2Z1bmN0aW9uICQodCl7cmV0dXJuInN5bWJvbCI9PXR5cGVvZiB0fHxmdW5jdGlvbih0KXtyZXR1cm4gbnVsbCE9dCYmIm9iamVjdCI9PXR5cGVvZiB0fSh0KSYmdyh0KT09Tn12YXIgQT1OYU4saz0vXlstK10weFswLTlhLWZdKyQvaSxGPS9eMGJbMDFdKyQvaSxJPS9eMG9bMC03XSskL2kscT1wYXJzZUludDtmdW5jdGlvbiBFKHQpe2lmKCJudW1iZXIiPT10eXBlb2YgdClyZXR1cm4gdDtpZigkKHQpKXJldHVybiBBO2lmKHAodCkpe3ZhciByPSJmdW5jdGlvbiI9PXR5cGVvZiB0LnZhbHVlT2Y/dC52YWx1ZU9mKCk6dDt0PXAocik/cisiIjpyfWlmKCJzdHJpbmciIT10eXBlb2YgdClyZXR1cm4gMD09PXQ/dDordDt0PXModCk7dmFyIGU9Ri50ZXN0KHQpO3JldHVybiBlfHxJLnRlc3QodCk/cSh0LnNsaWNlKDIpLGU/Mjo4KTprLnRlc3QodCk/QTordH12YXIgTD0xLzAsTT0xNzk3NjkzMTM0ODYyMzE1N2UyOTI7ZnVuY3Rpb24gUCh0KXtyZXR1cm4gdD8odD1FKHQpKT09PUx8fHQ9PT0tTD8odDwwPy0xOjEpKk06dD09dD90OjA6MD09PXQ/dDowfWZ1bmN0aW9uIFQodCl7dmFyIHI9UCh0KSxlPXIlMTtyZXR1cm4gcj09cj9lP3ItZTpyOjB9ZnVuY3Rpb24gVSh0KXtsZXQgcj0hMTtpZihmKHQpKXI9IWlzTmFOKE51bWJlcih0KSk7ZWxzZSBpZihmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBOdW1iZXJdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCkpe2lmKHUodCkpcmV0dXJuITE7cj0hMH1yZXR1cm4gcn1mdW5jdGlvbiBEKHQpe2lmKCFVKHQpKXJldHVybiAwO3JldHVybiBQKHQpfWZ1bmN0aW9uIFcodCl7cmV0dXJuISFVKHQpJiYodD1EKHQpLCJudW1iZXIiPT10eXBlb2Yocj10KSYmcj09VChyKSk7dmFyIHJ9dmFyIF89QXJyYXkuaXNBcnJheSx6PTEvMCxCPXY/di5wcm90b3R5cGU6dm9pZCAwLEM9Qj9CLnRvU3RyaW5nOnZvaWQgMDtmdW5jdGlvbiBHKHQpe2lmKCJzdHJpbmciPT10eXBlb2YgdClyZXR1cm4gdDtpZihfKHQpKXJldHVybiBmdW5jdGlvbih0LHIpe2Zvcih2YXIgZT0tMSxuPW51bGw9PXQ/MDp0Lmxlbmd0aCxpPUFycmF5KG4pOysrZTxuOylpW2VdPXIodFtlXSxlLHQpO3JldHVybiBpfSh0LEcpKyIiO2lmKCQodCkpcmV0dXJuIEM/Qy5jYWxsKHQpOiIiO3ZhciByPXQrIiI7cmV0dXJuIjAiPT1yJiYxL3Q9PS16PyItMCI6cn1mdW5jdGlvbiBIKHQpe3JldHVybiBudWxsPT10PyIiOkcodCl9dmFyIEo9aC5pc0Zpbml0ZSxLPU1hdGgubWluO3ZhciBRLFY9KFE9TWF0aFsicm91bmQiXSxmdW5jdGlvbih0LHIpe2lmKHQ9RSh0KSwocj1udWxsPT1yPzA6SyhUKHIpLDI5MikpJiZKKHQpKXt2YXIgZT0oSCh0KSsiZSIpLnNwbGl0KCJlIik7cmV0dXJuKygoZT0oSChRKGVbMF0rImUiKygrZVsxXStyKSkpKyJlIikuc3BsaXQoImUiKSlbMF0rImUiKygrZVsxXS1yKSl9cmV0dXJuIFEodCl9KTtmdW5jdGlvbiBYKHQpe2lmKCFVKHQpKXJldHVybiAwO3Q9RCh0KTtsZXQgcj1WKHQpO3JldHVybiIwIj09PVN0cmluZyhyKT8wOnJ9ZnVuY3Rpb24gWSh0KXtpZighVyh0KSlyZXR1cm4hMTtyZXR1cm4gWCh0KT49MH1mdW5jdGlvbiBaKHQscil7aWYoIWYodCkpcmV0dXJuIiI7aWYoIVkocikpcmV0dXJuIiI7aWYoMD09PShyPVgocikpKXJldHVybiIiO2xldCBlPXQubGVuZ3RoLXI7cmV0dXJuIGU8MCYmKGU9MCksdC5zdWJzdHJpbmcoZSxlK3IpfWZ1bmN0aW9uIHR0KHQscil7cmV0dXJuIGYodCkmJlkocik/MD09PShyPVgocikpP3Q6ZnVuY3Rpb24odCxyKXtyZXR1cm4gZih0KSYmWShyKT8wPT09KHI9WChyKSk/IiI6dC5zdWJzdHJpbmcoMCxyKToiIn0odCx0Lmxlbmd0aC1yKToiIn1mdW5jdGlvbiBydCh0KXtpZighZih0KSlyZXR1cm57cGF0aDoiIixpc1Jvb3Q6ITF9O2Zvcig7dC5pbmRleE9mKCJcXFxcIik+PTA7KXQ9dC5yZXBsYWNlKCJcXFxcIiwiXFwiKTtmb3IoO3QuaW5kZXhPZigiLy8iKT49MDspdD10LnJlcGxhY2UoIi8vIiwiLyIpO2lmKCI6Ij09PVoodCwxKSlyZXR1cm57cGF0aDpgJHt0fVxcYCxpc1Jvb3Q6ITB9O2lmKCJcXCI9PT1aKHQsMSkpe2xldCByPXR0KHQsMSk7cmV0dXJuIjoiPT09WihyLDEpP3twYXRoOnQsaXNSb290OiEwfTp7cGF0aDpyLGlzUm9vdDohMX19aWYoIi8iPT09Wih0LDEpKXtsZXQgcj10dCh0LDEpO3JldHVybiAwPT09ci5sZW5ndGg/e3BhdGg6dCxpc1Jvb3Q6ITB9OntwYXRoOnIsaXNSb290OiExfX1yZXR1cm57cGF0aDp0LGlzUm9vdDohMX19ZnVuY3Rpb24gZXQodCl7aWYoIWYodCkpcmV0dXJuIiI7bGV0IHI9cnQodCk7aWYoci5pc1Jvb3QpcmV0dXJuIHIucGF0aDtsZXQgZT1mdW5jdGlvbih0KXtpZighZih0KSlyZXR1cm4iIjtsZXQgcj1ydCh0KTtpZihyLmlzUm9vdClyZXR1cm4gci5wYXRoO2xldCBlPXIucGF0aDt0cnl7ZT1lLnNwbGl0KCJcXCIpLnBvcCgpLnNwbGl0KCIvIikucG9wKCl9Y2F0Y2godCl7fXJldHVybiBlfSh0PXIucGF0aCk7aWYoIWYoZSkpcmV0dXJuIHQ7bGV0IG49cnQodD10dCh0LGUubGVuZ3RoKSk7cmV0dXJuIG4uaXNSb290LG4ucGF0aH1mdW5jdGlvbiBudCh0KXtyZXR1cm4hIXIuZXhpc3RzU3luYyh0KSYmKCFyLmxzdGF0U3luYyh0KS5pc0ZpbGUoKSYmIXIubHN0YXRTeW5jKHQpLmlzU3ltYm9saWNMaW5rKCkpfWZ1bmN0aW9uIGl0KHQpe3JldHVybiEhci5leGlzdHNTeW5jKHQpJiYoIXIubHN0YXRTeW5jKHQpLmlzRGlyZWN0b3J5KCkmJiFyLmxzdGF0U3luYyh0KS5pc1N5bWJvbGljTGluaygpKX1mdW5jdGlvbiBvdCh0KXtpZighci5leGlzdHNTeW5jKHQpKXJldHVybntzdWNjZXNzOiJmaWxlIGRvZXMgbm90IGV4aXN0OiAiK3R9O2lmKCFpdCh0KSlyZXR1cm57ZXJyb3I6ImlucHV0IHBhdGggaXMgbm90IGEgZmlsZTogIit0fTt0cnl7ci51bmxpbmtTeW5jKHQpfWNhdGNoKHQpe3JldHVybntlcnJvcjp0fX1yZXR1cm57c3VjY2VzczoiZG9uZTogIit0fX1hc3luYyBmdW5jdGlvbiB1dCh0LGksbyl7bGV0IHU9IiI7aWYoIW4oZj1pKXx8MD09PWYubGVuZ3RofHwxPT09Zi5sZW5ndGgmJmMoZlswXSkpdGhyb3cgbmV3IEVycm9yKCJmcHNJbiBpbiBub3QgYW4gZWZmZWN0aXZlIGFycmF5Iik7dmFyIGY7bGV0IGw9ZXQobyk7bnQobCl8fGZ1bmN0aW9uKHQpe2lmKG50KHQpKXJldHVybntzdWNjZXNzOiJpbnB1dCBmb2xkZXIgaXMgYWxyZWFkeSBleGlzdHM6ICIrdH07aWYoci5leGlzdHNTeW5jKHQpKXJldHVybntlcnJvcjoiaW5wdXQgcGF0aCBhbHJlYWR5IGV4aXN0czogIit0fTt0cnl7ci5ta2RpclN5bmModCx7cmVjdXJzaXZlOiEwfSl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fX0obCk7bGV0IGE9ZSgpO3RyeXtsZXQgbj1yLmNyZWF0ZVdyaXRlU3RyZWFtKG8pO2ZvcihsZXQgdD0wO3Q8aS5sZW5ndGg7dCsrKXtsZXQgbz1pW3RdO2lmKCFpdChvKSl0aHJvdyBuZXcgRXJyb3IoYGZwSW5bJHtvfV0gaXMgbm90IGEgZmlsZWApO2xldCBjPSgpPT57bGV0IHQ9ZSgpLGk9ci5jcmVhdGVSZWFkU3RyZWFtKG8pO3JldHVybiBpLm9uKCJlcnJvciIsKHI9Pnt1PXIubWVzc2FnZSx0LnJlamVjdChyKX0pKSxpLm9uKCJlbmQiLCgoKT0+e290KG8pLHQucmVzb2x2ZSgpfSkpLGkucGlwZShuLHtlbmQ6ITF9KSx0fTthd2FpdCBjKCl9bi5lbmQoKSxuLm9uKCJlcnJvciIsKHQ9Pnt1PXQubWVzc2FnZSxhLnJlamVjdCh1KX0pKSxuLm9uKCJmaW5pc2giLCgoKT0+e2xldCByPXtmaWxlbmFtZTp0LHBhdGg6b307YS5yZXNvbHZlKHIpfSkpfWNhdGNoKHQpe3U9dC5tZXNzYWdlLGEucmVqZWN0KHUpfXJldHVybiBhfWxldCBtZXJnZUZpbGVzPWFzeW5jKHIsZSxuLGkpPT57bGV0IG89W107Zm9yKGxldCBpPTA7aTxuO2krKyl7bGV0IG49dC5qb2luKHIsYCR7ZX1fJHtpfWApO28ucHVzaChuKX1sZXQgdT10LmpvaW4ocixlKTtyZXR1cm4gYXdhaXQgdXQoaSxvLHUpfTsKCgpsZXQgaW5zdGFuY2UgPSBudWxsCmZ1bmN0aW9uIGluaXQoaW5wdXQpewoKICAgIC8vaW5pdAogICAgbGV0IHIKICAgIAogICAgICAgIHIgPSB7CiAgICAgICAgICAgIG1haW46IG1lcmdlRmlsZXMKICAgICAgICB9CiAgICAgICAgCgogICAgLy9vbgogICAgCgogICAgLy9zYXZlCiAgICBpbnN0YW5jZSA9IHIKCn0KCmZ1bmN0aW9uIHNlbmRNZXNzYWdlKGRhdGEpIHsKICAgIAogICAgICAgIHBhcmVudFBvcnQucG9zdE1lc3NhZ2UoZGF0YSkKICAgICAgICAKfQoKYXN5bmMgZnVuY3Rpb24gcnVuKGRhdGEpIHsKICAgIC8vIGNvbnNvbGUubG9nKCdpbm5lciB3b3JrZXIgcnVuJyxkYXRhKQoKICAgIC8vbW9kZQogICAgbGV0IG1vZGUgPSBkYXRhLm1vZGUKCiAgICAvL2NoZWNrCiAgICBpZihtb2RlICE9PSAnaW5pdCcgJiYgbW9kZSAhPT0gJ2NhbGwnKXsKICAgICAgICByZXR1cm4KICAgIH0KCiAgICAvL2luaXQKICAgIGlmKG1vZGUgPT09ICdpbml0Jyl7CiAgICAgICAgCiAgICAgICAgdHJ5ewoKICAgICAgICAgICAgLy90eXBlCiAgICAgICAgICAgIGxldCB0eXBlID0gZGF0YS50eXBlCgogICAgICAgICAgICAvL2lucHV0CiAgICAgICAgICAgIGxldCBpbnB1dCA9IGRhdGEuaW5wdXQKICAgIAogICAgICAgICAgICAvL2luc3RhbmNlCiAgICAgICAgICAgIGlmKHR5cGUgPT09ICdmdW5jdGlvbicpewogICAgICAgICAgICAgICAgaW5pdCguLi5pbnB1dCkKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIGlmKHR5cGUgPT09ICdvYmplY3QnKXsKICAgICAgICAgICAgICAgIGluc3RhbmNlID0gbWVyZ2VGaWxlcwogICAgICAgICAgICB9CgogICAgICAgIH0KICAgICAgICBjYXRjaChlcnIpewogICAgICAgIAogICAgICAgICAgICAvL3NlbmRNZXNzYWdlCiAgICAgICAgICAgIGxldCByZXMgPSB7CiAgICAgICAgICAgICAgICBtb2RlOiAnZW1pdCcsCiAgICAgICAgICAgICAgICBldk5hbWU6ICdlcnJvcicsCiAgICAgICAgICAgICAgICBtc2c6IGVyciwKICAgICAgICAgICAgfQogICAgICAgICAgICBzZW5kTWVzc2FnZShyZXMpCgogICAgICAgIH0KICAgICAgICAgICAgCiAgICB9CgogICAgLy9jaGVjawogICAgaWYobW9kZSA9PT0gJ2NhbGwnKXsKICAgICAgICBsZXQgc3RhdGUgPSAnJwogICAgICAgIGxldCBtc2cgPSBudWxsCgogICAgICAgIHRyeXsKCiAgICAgICAgICAgIC8vZnVuCiAgICAgICAgICAgIGxldCBmdW4gPSBpbnN0YW5jZVtkYXRhLmZ1bl0KCiAgICAgICAgICAgIC8vaW5wdXQKICAgICAgICAgICAgbGV0IGlucHV0ID0gZGF0YS5pbnB1dAoKICAgICAgICAgICAgLy9leGVjCiAgICAgICAgICAgIGF3YWl0IGZ1biguLi5pbnB1dCkKICAgICAgICAgICAgICAgIC50aGVuKChzdWMpID0+IHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZT0nc3VjY2VzcycKICAgICAgICAgICAgICAgICAgICBtc2c9c3VjCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgICAgICAgICAgICBzdGF0ZT0nZXJyb3InCiAgICAgICAgICAgICAgICAgICAgbXNnPWVycgogICAgICAgICAgICAgICAgfSkKCiAgICAgICAgfQogICAgICAgIGNhdGNoKGVycil7CiAgICAgICAgICAgIHN0YXRlID0gJ2Vycm9yJwogICAgICAgICAgICBtc2cgPSBlcnIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgLy9zZW5kTWVzc2FnZQogICAgICAgIGxldCByZXMgPSB7CiAgICAgICAgICAgIG1vZGU6ICdyZXR1cm4nLAogICAgICAgICAgICBpZDogZGF0YS5pZCwKICAgICAgICAgICAgZnVuOiBkYXRhLmZ1biwKICAgICAgICAgICAgc3RhdGUsCiAgICAgICAgICAgIG1zZywKICAgICAgICB9CiAgICAgICAgc2VuZE1lc3NhZ2UocmVzKQoKICAgIH0KCn0KCmZ1bmN0aW9uIHJlY3ZNZXNzYWdlKGRhdGEpIHsKICAgIC8vIGNvbnNvbGUubG9nKCdpbm5lciB3b3JrZXIgcmVjdjonLCBkYXRhKQoKICAgIC8vZGF0YVJlY3YKICAgIGxldCBkYXRhUmVjdiA9IGRhdGEKCiAgICAvL3J1bgogICAgcnVuKGRhdGFSZWN2KQoKfQoKCiAgICAgICAgcGFyZW50UG9ydC5vbignbWVzc2FnZScsIHJlY3ZNZXNzYWdlKQogICAgICAgIAoKdHJ5ewogICAgcHJvY2Vzcy5vbigndW5oYW5kbGVkUmVqZWN0aW9uJywgKGVycikgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdpbm5lcjp1bmhhbmRsZWRSZWplY3Rpb24nLCBlcnIpCiAgICB9KQogICAgcHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb24nLCAoZXJyKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ2lubmVyOnVuY2F1Z2h0RXhjZXB0aW9uJywgZXJyKQogICAgfSkKICAgIHByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uTW9uaXRvcicsIChlcnIpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygnaW5uZXI6dW5jYXVnaHRFeGNlcHRpb25Nb25pdG9yJywgZXJyKQogICAgfSkKfQpjYXRjaChlcnIpe30KCg==",Buffer.from(o,"base64").toString("utf8"));var o;function i(){let r=new n,o=function(e){try{return new t.Worker(e,{eval:!0})}catch(t){c(t)}}(e);if(!o)return c("invalid worker"),null;function i(){let t=function(){let t,e,n=new Promise((function(){t=arguments[0],e=arguments[1]}));return n.resolve=t,n.reject=e,n}(),e=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=[],n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=n.length;for(let o=0;o<t;o++)e[o]=n[0|Math.random()*r];return e.join("")}(),n={mode:"call",id:e,fun:"main",input:[...arguments]};return o.postMessage(n),r.once(e,(e=>{"success"===e.state?t.resolve(e.msg):t.reject(e.msg)})),t}function c(t){r.emit("error",t)}return o.on("message",(function(t){let e=t,n=e.mode;"emit"!==n&&"return"!==n||("emit"===n&&r.emit(e.evName,e.msg),"return"===n&&r.emit(e.id,e))})),o.on("error",c),o.on("exit",(t=>{1!==t&&c("exit code["+t+"] !== 1")})),function(){let t={mode:"init",type:"function",input:[...arguments]};o.postMessage(t)}([...arguments]),r.main=i,r.main=i,r.terminate=function(){o?(o.terminate(),o=void 0):c("worker has been terminated")},r}r=async function(){let t=[...arguments],e=i();return await e.main(...t).finally((()=>{e.terminate()}))}}();try{process.on("unhandledRejection",(t=>{console.log("outer:unhandledRejection",t)})),process.on("uncaughtException",(t=>{console.log("outer:uncaughtException",t)})),process.on("uncaughtExceptionMonitor",(t=>{console.log("outer:uncaughtExceptionMonitor",t)}))}catch(t){}return r}(t)}({get exports(){return e},set exports(t){e=t}});var n=e,r={};!function(t,e){t.exports=function(){const t="function"==typeof Buffer,e="function"==typeof TextDecoder?new TextDecoder:void 0,n=(t=>{let e={};return t.forEach(((t,n)=>e[t]=n)),e})(("function"==typeof TextEncoder&&new TextEncoder,Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="))),r=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,o=String.fromCharCode.bind(String),i="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):t=>new Uint8Array(Array.prototype.slice.call(t,0)),c=t=>t.replace(/[^A-Za-z0-9\+\/]/g,""),a=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,u=t=>{switch(t.length){case 4:var e=((7&t.charCodeAt(0))<<18|(63&t.charCodeAt(1))<<12|(63&t.charCodeAt(2))<<6|63&t.charCodeAt(3))-65536;return o(55296+(e>>>10))+o(56320+(1023&e));case 3:return o((15&t.charCodeAt(0))<<12|(63&t.charCodeAt(1))<<6|63&t.charCodeAt(2));default:return o((31&t.charCodeAt(0))<<6|63&t.charCodeAt(1))}},l=t=>t.replace(a,u),s=t=>{if(t=t.replace(/\s+/g,""),!r.test(t))throw new TypeError("malformed base64.");t+="==".slice(2-(3&t.length));let e,i,c,a="";for(let r=0;r<t.length;)e=n[t.charAt(r++)]<<18|n[t.charAt(r++)]<<12|(i=n[t.charAt(r++)])<<6|(c=n[t.charAt(r++)]),a+=64===i?o(e>>16&255):64===c?o(e>>16&255,e>>8&255):o(e>>16&255,e>>8&255,255&e);return a},f="function"==typeof atob?t=>atob(c(t)):t?t=>Buffer.from(t,"base64").toString("binary"):s,g=t?t=>i(Buffer.from(t,"base64")):t=>i(f(t).split("").map((t=>t.charCodeAt(0)))),d=t?t=>Buffer.from(t,"base64").toString("utf8"):e?t=>e.decode(g(t)):t=>l(f(t)),p=t=>c(t.replace(/[-_]/g,(t=>"-"==t?"+":"/"))),I=t=>d(p(t)),h=I;var C={};!function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,c){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,c),u=n?n+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function c(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,c=new Array(i);o<i;o++)c[o]=r[o].fn;return c},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,o,i,c){var a=n?n+t:t;if(!this._events[a])return!1;var u,l,s=this._events[a],f=arguments.length;if(s.fn){switch(s.once&&this.removeListener(t,s.fn,void 0,!0),f){case 1:return s.fn.call(s.context),!0;case 2:return s.fn.call(s.context,e),!0;case 3:return s.fn.call(s.context,e,r),!0;case 4:return s.fn.call(s.context,e,r,o),!0;case 5:return s.fn.call(s.context,e,r,o,i),!0;case 6:return s.fn.call(s.context,e,r,o,i,c),!0}for(l=1,u=new Array(f-1);l<f;l++)u[l-1]=arguments[l];s.fn.apply(s.context,u)}else{var g,d=s.length;for(l=0;l<d;l++)switch(s[l].once&&this.removeListener(t,s[l].fn,void 0,!0),f){case 1:s[l].fn.call(s[l].context);break;case 2:s[l].fn.call(s[l].context,e);break;case 3:s[l].fn.call(s[l].context,e,r);break;case 4:s[l].fn.call(s[l].context,e,r,o);break;default:if(!u)for(g=1,u=new Array(f-1);g<f;g++)u[g-1]=arguments[g];s[l].fn.apply(s[l].context,u)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return c(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||c(this,i);else{for(var u=0,l=[],s=a.length;u<s;u++)(a[u].fn!==e||o&&!a[u].once||r&&a[u].context!==r)&&l.push(a[u]);l.length?this._events[i]=1===l.length?l[0]:l:c(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&c(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a}({get exports(){return C},set exports(t){C=t}});var y=C;let m;!function(){if("browser"!=("undefined"!=typeof window&&void 0!==window.document?"browser":"nodejs"))return null;let t=h("CgoKInVzZSBzdHJpY3QiO3ZhciB0PXJlcXVpcmUoInBhdGgiKSxyPXJlcXVpcmUoImZzIik7ZnVuY3Rpb24gZSgpe2xldCB0LHIsZT1uZXcgUHJvbWlzZSgoZnVuY3Rpb24oKXt0PWFyZ3VtZW50c1swXSxyPWFyZ3VtZW50c1sxXX0pKTtyZXR1cm4gZS5yZXNvbHZlPXQsZS5yZWplY3Q9cixlfWZ1bmN0aW9uIG4odCl7cmV0dXJuIltvYmplY3QgQXJyYXldIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX1mdW5jdGlvbiBpKHQpe2lmKGZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE9iamVjdF0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSh0KSl7Zm9yKGxldCByIGluIHQpcmV0dXJuITE7cmV0dXJuITB9cmV0dXJuITF9ZnVuY3Rpb24gbyh0KXtyZXR1cm4iW29iamVjdCBTdHJpbmddIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX1mdW5jdGlvbiB1KHQpe3JldHVybiB0IT10fWZ1bmN0aW9uIGModCl7cmV0dXJuISFmdW5jdGlvbih0KXtyZXR1cm4iW29iamVjdCBVbmRlZmluZWRdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCl8fCghIWZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE51bGxdIj09PU9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0KX0odCl8fCghIWkodCl8fCghIWZ1bmN0aW9uKHQpe3JldHVybiEoIW8odCl8fCIiIT09dCl9KHQpfHwoISFmdW5jdGlvbih0KXtyZXR1cm4hIW4odCkmJjA9PT10Lmxlbmd0aH0odCl8fCEhdSh0KSkpKSl9ZnVuY3Rpb24gZih0KXtyZXR1cm4hKCFvKHQpfHwiIj09PXQpfXZhciBsPS9ccy87dmFyIGE9L15ccysvO2Z1bmN0aW9uIHModCl7cmV0dXJuIHQ/dC5zbGljZSgwLGZ1bmN0aW9uKHQpe2Zvcih2YXIgcj10Lmxlbmd0aDtyLS0mJmwudGVzdCh0LmNoYXJBdChyKSk7KTtyZXR1cm4gcn0odCkrMSkucmVwbGFjZShhLCIiKTp0fWZ1bmN0aW9uIHAodCl7dmFyIHI9dHlwZW9mIHQ7cmV0dXJuIG51bGwhPXQmJigib2JqZWN0Ij09cnx8ImZ1bmN0aW9uIj09cil9dmFyIHk9Im9iamVjdCI9PXR5cGVvZiBnbG9iYWwmJmdsb2JhbCYmZ2xvYmFsLk9iamVjdD09PU9iamVjdCYmZ2xvYmFsLGI9Im9iamVjdCI9PXR5cGVvZiBzZWxmJiZzZWxmJiZzZWxmLk9iamVjdD09PU9iamVjdCYmc2VsZixoPXl8fGJ8fEZ1bmN0aW9uKCJyZXR1cm4gdGhpcyIpKCksdj1oLlN5bWJvbCxnPU9iamVjdC5wcm90b3R5cGUsaj1nLmhhc093blByb3BlcnR5LFM9Zy50b1N0cmluZyxkPXY/di50b1N0cmluZ1RhZzp2b2lkIDA7dmFyIG09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzt2YXIgTz0iW29iamVjdCBOdWxsXSIseD0iW29iamVjdCBVbmRlZmluZWRdIixSPXY/di50b1N0cmluZ1RhZzp2b2lkIDA7ZnVuY3Rpb24gdyh0KXtyZXR1cm4gbnVsbD09dD92b2lkIDA9PT10P3g6TzpSJiZSIGluIE9iamVjdCh0KT9mdW5jdGlvbih0KXt2YXIgcj1qLmNhbGwodCxkKSxlPXRbZF07dHJ5e3RbZF09dm9pZCAwO3ZhciBuPSEwfWNhdGNoKHQpe312YXIgaT1TLmNhbGwodCk7cmV0dXJuIG4mJihyP3RbZF09ZTpkZWxldGUgdFtkXSksaX0odCk6ZnVuY3Rpb24odCl7cmV0dXJuIG0uY2FsbCh0KX0odCl9dmFyIE49IltvYmplY3QgU3ltYm9sXSI7ZnVuY3Rpb24gJCh0KXtyZXR1cm4ic3ltYm9sIj09dHlwZW9mIHR8fGZ1bmN0aW9uKHQpe3JldHVybiBudWxsIT10JiYib2JqZWN0Ij09dHlwZW9mIHR9KHQpJiZ3KHQpPT1OfXZhciBBPU5hTixrPS9eWy0rXTB4WzAtOWEtZl0rJC9pLEY9L14wYlswMV0rJC9pLEk9L14wb1swLTddKyQvaSxxPXBhcnNlSW50O2Z1bmN0aW9uIEUodCl7aWYoIm51bWJlciI9PXR5cGVvZiB0KXJldHVybiB0O2lmKCQodCkpcmV0dXJuIEE7aWYocCh0KSl7dmFyIHI9ImZ1bmN0aW9uIj09dHlwZW9mIHQudmFsdWVPZj90LnZhbHVlT2YoKTp0O3Q9cChyKT9yKyIiOnJ9aWYoInN0cmluZyIhPXR5cGVvZiB0KXJldHVybiAwPT09dD90Oit0O3Q9cyh0KTt2YXIgZT1GLnRlc3QodCk7cmV0dXJuIGV8fEkudGVzdCh0KT9xKHQuc2xpY2UoMiksZT8yOjgpOmsudGVzdCh0KT9BOit0fXZhciBMPTEvMCxNPTE3OTc2OTMxMzQ4NjIzMTU3ZTI5MjtmdW5jdGlvbiBQKHQpe3JldHVybiB0Pyh0PUUodCkpPT09THx8dD09PS1MPyh0PDA/LTE6MSkqTTp0PT10P3Q6MDowPT09dD90OjB9ZnVuY3Rpb24gVCh0KXt2YXIgcj1QKHQpLGU9ciUxO3JldHVybiByPT1yP2U/ci1lOnI6MH1mdW5jdGlvbiBVKHQpe2xldCByPSExO2lmKGYodCkpcj0haXNOYU4oTnVtYmVyKHQpKTtlbHNlIGlmKGZ1bmN0aW9uKHQpe3JldHVybiJbb2JqZWN0IE51bWJlcl0iPT09T2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHQpfSh0KSl7aWYodSh0KSlyZXR1cm4hMTtyPSEwfXJldHVybiByfWZ1bmN0aW9uIEQodCl7aWYoIVUodCkpcmV0dXJuIDA7cmV0dXJuIFAodCl9ZnVuY3Rpb24gVyh0KXtyZXR1cm4hIVUodCkmJih0PUQodCksIm51bWJlciI9PXR5cGVvZihyPXQpJiZyPT1UKHIpKTt2YXIgcn12YXIgXz1BcnJheS5pc0FycmF5LHo9MS8wLEI9dj92LnByb3RvdHlwZTp2b2lkIDAsQz1CP0IudG9TdHJpbmc6dm9pZCAwO2Z1bmN0aW9uIEcodCl7aWYoInN0cmluZyI9PXR5cGVvZiB0KXJldHVybiB0O2lmKF8odCkpcmV0dXJuIGZ1bmN0aW9uKHQscil7Zm9yKHZhciBlPS0xLG49bnVsbD09dD8wOnQubGVuZ3RoLGk9QXJyYXkobik7KytlPG47KWlbZV09cih0W2VdLGUsdCk7cmV0dXJuIGl9KHQsRykrIiI7aWYoJCh0KSlyZXR1cm4gQz9DLmNhbGwodCk6IiI7dmFyIHI9dCsiIjtyZXR1cm4iMCI9PXImJjEvdD09LXo/Ii0wIjpyfWZ1bmN0aW9uIEgodCl7cmV0dXJuIG51bGw9PXQ/IiI6Ryh0KX12YXIgSj1oLmlzRmluaXRlLEs9TWF0aC5taW47dmFyIFEsVj0oUT1NYXRoWyJyb3VuZCJdLGZ1bmN0aW9uKHQscil7aWYodD1FKHQpLChyPW51bGw9PXI/MDpLKFQociksMjkyKSkmJkoodCkpe3ZhciBlPShIKHQpKyJlIikuc3BsaXQoImUiKTtyZXR1cm4rKChlPShIKFEoZVswXSsiZSIrKCtlWzFdK3IpKSkrImUiKS5zcGxpdCgiZSIpKVswXSsiZSIrKCtlWzFdLXIpKX1yZXR1cm4gUSh0KX0pO2Z1bmN0aW9uIFgodCl7aWYoIVUodCkpcmV0dXJuIDA7dD1EKHQpO2xldCByPVYodCk7cmV0dXJuIjAiPT09U3RyaW5nKHIpPzA6cn1mdW5jdGlvbiBZKHQpe2lmKCFXKHQpKXJldHVybiExO3JldHVybiBYKHQpPj0wfWZ1bmN0aW9uIFoodCxyKXtpZighZih0KSlyZXR1cm4iIjtpZighWShyKSlyZXR1cm4iIjtpZigwPT09KHI9WChyKSkpcmV0dXJuIiI7bGV0IGU9dC5sZW5ndGgtcjtyZXR1cm4gZTwwJiYoZT0wKSx0LnN1YnN0cmluZyhlLGUrcil9ZnVuY3Rpb24gdHQodCxyKXtyZXR1cm4gZih0KSYmWShyKT8wPT09KHI9WChyKSk/dDpmdW5jdGlvbih0LHIpe3JldHVybiBmKHQpJiZZKHIpPzA9PT0ocj1YKHIpKT8iIjp0LnN1YnN0cmluZygwLHIpOiIifSh0LHQubGVuZ3RoLXIpOiIifWZ1bmN0aW9uIHJ0KHQpe2lmKCFmKHQpKXJldHVybntwYXRoOiIiLGlzUm9vdDohMX07Zm9yKDt0LmluZGV4T2YoIlxcXFwiKT49MDspdD10LnJlcGxhY2UoIlxcXFwiLCJcXCIpO2Zvcig7dC5pbmRleE9mKCIvLyIpPj0wOyl0PXQucmVwbGFjZSgiLy8iLCIvIik7aWYoIjoiPT09Wih0LDEpKXJldHVybntwYXRoOmAke3R9XFxgLGlzUm9vdDohMH07aWYoIlxcIj09PVoodCwxKSl7bGV0IHI9dHQodCwxKTtyZXR1cm4iOiI9PT1aKHIsMSk/e3BhdGg6dCxpc1Jvb3Q6ITB9OntwYXRoOnIsaXNSb290OiExfX1pZigiLyI9PT1aKHQsMSkpe2xldCByPXR0KHQsMSk7cmV0dXJuIDA9PT1yLmxlbmd0aD97cGF0aDp0LGlzUm9vdDohMH06e3BhdGg6cixpc1Jvb3Q6ITF9fXJldHVybntwYXRoOnQsaXNSb290OiExfX1mdW5jdGlvbiBldCh0KXtpZighZih0KSlyZXR1cm4iIjtsZXQgcj1ydCh0KTtpZihyLmlzUm9vdClyZXR1cm4gci5wYXRoO2xldCBlPWZ1bmN0aW9uKHQpe2lmKCFmKHQpKXJldHVybiIiO2xldCByPXJ0KHQpO2lmKHIuaXNSb290KXJldHVybiByLnBhdGg7bGV0IGU9ci5wYXRoO3RyeXtlPWUuc3BsaXQoIlxcIikucG9wKCkuc3BsaXQoIi8iKS5wb3AoKX1jYXRjaCh0KXt9cmV0dXJuIGV9KHQ9ci5wYXRoKTtpZighZihlKSlyZXR1cm4gdDtsZXQgbj1ydCh0PXR0KHQsZS5sZW5ndGgpKTtyZXR1cm4gbi5pc1Jvb3Qsbi5wYXRofWZ1bmN0aW9uIG50KHQpe3JldHVybiEhci5leGlzdHNTeW5jKHQpJiYoIXIubHN0YXRTeW5jKHQpLmlzRmlsZSgpJiYhci5sc3RhdFN5bmModCkuaXNTeW1ib2xpY0xpbmsoKSl9ZnVuY3Rpb24gaXQodCl7cmV0dXJuISFyLmV4aXN0c1N5bmModCkmJighci5sc3RhdFN5bmModCkuaXNEaXJlY3RvcnkoKSYmIXIubHN0YXRTeW5jKHQpLmlzU3ltYm9saWNMaW5rKCkpfWZ1bmN0aW9uIG90KHQpe2lmKCFyLmV4aXN0c1N5bmModCkpcmV0dXJue3N1Y2Nlc3M6ImZpbGUgZG9lcyBub3QgZXhpc3Q6ICIrdH07aWYoIWl0KHQpKXJldHVybntlcnJvcjoiaW5wdXQgcGF0aCBpcyBub3QgYSBmaWxlOiAiK3R9O3RyeXtyLnVubGlua1N5bmModCl9Y2F0Y2godCl7cmV0dXJue2Vycm9yOnR9fXJldHVybntzdWNjZXNzOiJkb25lOiAiK3R9fWFzeW5jIGZ1bmN0aW9uIHV0KHQsaSxvKXtsZXQgdT0iIjtpZighbihmPWkpfHwwPT09Zi5sZW5ndGh8fDE9PT1mLmxlbmd0aCYmYyhmWzBdKSl0aHJvdyBuZXcgRXJyb3IoImZwc0luIGluIG5vdCBhbiBlZmZlY3RpdmUgYXJyYXkiKTt2YXIgZjtsZXQgbD1ldChvKTtudChsKXx8ZnVuY3Rpb24odCl7aWYobnQodCkpcmV0dXJue3N1Y2Nlc3M6ImlucHV0IGZvbGRlciBpcyBhbHJlYWR5IGV4aXN0czogIit0fTtpZihyLmV4aXN0c1N5bmModCkpcmV0dXJue2Vycm9yOiJpbnB1dCBwYXRoIGFscmVhZHkgZXhpc3RzOiAiK3R9O3RyeXtyLm1rZGlyU3luYyh0LHtyZWN1cnNpdmU6ITB9KX1jYXRjaCh0KXtyZXR1cm57ZXJyb3I6dH19fShsKTtsZXQgYT1lKCk7dHJ5e2xldCBuPXIuY3JlYXRlV3JpdGVTdHJlYW0obyk7Zm9yKGxldCB0PTA7dDxpLmxlbmd0aDt0Kyspe2xldCBvPWlbdF07aWYoIWl0KG8pKXRocm93IG5ldyBFcnJvcihgZnBJblske299XSBpcyBub3QgYSBmaWxlYCk7bGV0IGM9KCk9PntsZXQgdD1lKCksaT1yLmNyZWF0ZVJlYWRTdHJlYW0obyk7cmV0dXJuIGkub24oImVycm9yIiwocj0+e3U9ci5tZXNzYWdlLHQucmVqZWN0KHIpfSkpLGkub24oImVuZCIsKCgpPT57b3QobyksdC5yZXNvbHZlKCl9KSksaS5waXBlKG4se2VuZDohMX0pLHR9O2F3YWl0IGMoKX1uLmVuZCgpLG4ub24oImVycm9yIiwodD0+e3U9dC5tZXNzYWdlLGEucmVqZWN0KHUpfSkpLG4ub24oImZpbmlzaCIsKCgpPT57bGV0IHI9e2ZpbGVuYW1lOnQscGF0aDpvfTthLnJlc29sdmUocil9KSl9Y2F0Y2godCl7dT10Lm1lc3NhZ2UsYS5yZWplY3QodSl9cmV0dXJuIGF9bGV0IG1lcmdlRmlsZXM9YXN5bmMocixlLG4saSk9PntsZXQgbz1bXTtmb3IobGV0IGk9MDtpPG47aSsrKXtsZXQgbj10LmpvaW4ocixgJHtlfV8ke2l9YCk7by5wdXNoKG4pfWxldCB1PXQuam9pbihyLGUpO3JldHVybiBhd2FpdCB1dChpLG8sdSl9OwoKCmxldCBpbnN0YW5jZSA9IG51bGwKZnVuY3Rpb24gaW5pdChpbnB1dCl7CgogICAgLy9pbml0CiAgICBsZXQgcgogICAgCiAgICAgICAgciA9IHsKICAgICAgICAgICAgbWFpbjogbWVyZ2VGaWxlcwogICAgICAgIH0KICAgICAgICAKCiAgICAvL29uCiAgICAKCiAgICAvL3NhdmUKICAgIGluc3RhbmNlID0gcgoKfQoKZnVuY3Rpb24gc2VuZE1lc3NhZ2UoZGF0YSkgewogICAgCiAgICAgICAgc2VsZi5wb3N0TWVzc2FnZShkYXRhKQogICAgICAgIAp9Cgphc3luYyBmdW5jdGlvbiBydW4oZGF0YSkgewogICAgLy8gY29uc29sZS5sb2coJ2lubmVyIHdvcmtlciBydW4nLGRhdGEpCgogICAgLy9tb2RlCiAgICBsZXQgbW9kZSA9IGRhdGEubW9kZQoKICAgIC8vY2hlY2sKICAgIGlmKG1vZGUgIT09ICdpbml0JyAmJiBtb2RlICE9PSAnY2FsbCcpewogICAgICAgIHJldHVybgogICAgfQoKICAgIC8vaW5pdAogICAgaWYobW9kZSA9PT0gJ2luaXQnKXsKICAgICAgICAKICAgICAgICB0cnl7CgogICAgICAgICAgICAvL3R5cGUKICAgICAgICAgICAgbGV0IHR5cGUgPSBkYXRhLnR5cGUKCiAgICAgICAgICAgIC8vaW5wdXQKICAgICAgICAgICAgbGV0IGlucHV0ID0gZGF0YS5pbnB1dAogICAgCiAgICAgICAgICAgIC8vaW5zdGFuY2UKICAgICAgICAgICAgaWYodHlwZSA9PT0gJ2Z1bmN0aW9uJyl7CiAgICAgICAgICAgICAgICBpbml0KC4uLmlucHV0KQogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgaWYodHlwZSA9PT0gJ29iamVjdCcpewogICAgICAgICAgICAgICAgaW5zdGFuY2UgPSBtZXJnZUZpbGVzCiAgICAgICAgICAgIH0KCiAgICAgICAgfQogICAgICAgIGNhdGNoKGVycil7CiAgICAgICAgCiAgICAgICAgICAgIC8vc2VuZE1lc3NhZ2UKICAgICAgICAgICAgbGV0IHJlcyA9IHsKICAgICAgICAgICAgICAgIG1vZGU6ICdlbWl0JywKICAgICAgICAgICAgICAgIGV2TmFtZTogJ2Vycm9yJywKICAgICAgICAgICAgICAgIG1zZzogZXJyLAogICAgICAgICAgICB9CiAgICAgICAgICAgIHNlbmRNZXNzYWdlKHJlcykKCiAgICAgICAgfQogICAgICAgICAgICAKICAgIH0KCiAgICAvL2NoZWNrCiAgICBpZihtb2RlID09PSAnY2FsbCcpewogICAgICAgIGxldCBzdGF0ZSA9ICcnCiAgICAgICAgbGV0IG1zZyA9IG51bGwKCiAgICAgICAgdHJ5ewoKICAgICAgICAgICAgLy9mdW4KICAgICAgICAgICAgbGV0IGZ1biA9IGluc3RhbmNlW2RhdGEuZnVuXQoKICAgICAgICAgICAgLy9pbnB1dAogICAgICAgICAgICBsZXQgaW5wdXQgPSBkYXRhLmlucHV0CgogICAgICAgICAgICAvL2V4ZWMKICAgICAgICAgICAgYXdhaXQgZnVuKC4uLmlucHV0KQogICAgICAgICAgICAgICAgLnRoZW4oKHN1YykgPT4gewogICAgICAgICAgICAgICAgICAgIHN0YXRlPSdzdWNjZXNzJwogICAgICAgICAgICAgICAgICAgIG1zZz1zdWMKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgICAgICAgICAgIHN0YXRlPSdlcnJvcicKICAgICAgICAgICAgICAgICAgICBtc2c9ZXJyCiAgICAgICAgICAgICAgICB9KQoKICAgICAgICB9CiAgICAgICAgY2F0Y2goZXJyKXsKICAgICAgICAgICAgc3RhdGUgPSAnZXJyb3InCiAgICAgICAgICAgIG1zZyA9IGVycgogICAgICAgIH0KICAgICAgICAKICAgICAgICAvL3NlbmRNZXNzYWdlCiAgICAgICAgbGV0IHJlcyA9IHsKICAgICAgICAgICAgbW9kZTogJ3JldHVybicsCiAgICAgICAgICAgIGlkOiBkYXRhLmlkLAogICAgICAgICAgICBmdW46IGRhdGEuZnVuLAogICAgICAgICAgICBzdGF0ZSwKICAgICAgICAgICAgbXNnLAogICAgICAgIH0KICAgICAgICBzZW5kTWVzc2FnZShyZXMpCgogICAgfQoKfQoKZnVuY3Rpb24gcmVjdk1lc3NhZ2UoZGF0YSkgewogICAgLy8gY29uc29sZS5sb2coJ2lubmVyIHdvcmtlciByZWN2OicsIGRhdGEpCgogICAgLy9kYXRhUmVjdgogICAgbGV0IGRhdGFSZWN2ID0gZGF0YQoKICAgIC8vcnVuCiAgICBydW4oZGF0YVJlY3YpCgp9CgoKICAgICAgICBzZWxmLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIHJlY3ZNZXNzYWdlKGUuZGF0YSkKICAgICAgICB9CiAgICAgICAgCgp0cnl7CiAgICBwcm9jZXNzLm9uKCd1bmhhbmRsZWRSZWplY3Rpb24nLCAoZXJyKSA9PiB7CiAgICAgICAgY29uc29sZS5sb2coJ2lubmVyOnVuaGFuZGxlZFJlamVjdGlvbicsIGVycikKICAgIH0pCiAgICBwcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIChlcnIpID0+IHsKICAgICAgICBjb25zb2xlLmxvZygnaW5uZXI6dW5jYXVnaHRFeGNlcHRpb24nLCBlcnIpCiAgICB9KQogICAgcHJvY2Vzcy5vbigndW5jYXVnaHRFeGNlcHRpb25Nb25pdG9yJywgKGVycikgPT4gewogICAgICAgIGNvbnNvbGUubG9nKCdpbm5lcjp1bmNhdWdodEV4Y2VwdGlvbk1vbml0b3InLCBlcnIpCiAgICB9KQp9CmNhdGNoKGVycil7fQoK");function e(){let e=new y,n=function(t){try{let e=new Blob([t]),n=window.URL||window.webkitURL;return new Worker(n.createObjectURL(e))}catch(t){o(t)}}(t);if(!n)return o("invalid worker"),null;function r(){let t=function(){let t,e,n=new Promise((function(){t=arguments[0],e=arguments[1]}));return n.resolve=t,n.reject=e,n}(),r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=[],n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),r=n.length;for(let o=0;o<t;o++)e[o]=n[0|Math.random()*r];return e.join("")}(),o={mode:"call",id:r,fun:"main",input:[...arguments]};return n.postMessage(o),e.once(r,(e=>{"success"===e.state?t.resolve(e.msg):t.reject(e.msg)})),t}function o(t){e.emit("error",t)}return n.onmessage=function(t){!function(t){let n=t,r=n.mode;"emit"!==r&&"return"!==r||("emit"===r&&e.emit(n.evName,n.msg),"return"===r&&e.emit(n.id,n))}(t.data)},n.onerror=o,n.onmessageerror=function(t){o(t.data)},function(){let t={mode:"init",type:"function",input:[...arguments]};n.postMessage(t)}([...arguments]),e.main=r,e.main=r,e.terminate=function(){n?(n.terminate(),n=void 0):o("worker has been terminated")},e}m=async function(){let t=[...arguments],n=e();return await n.main(...t).finally((()=>{n.terminate()}))}}();try{process.on("unhandledRejection",(t=>{console.log("outer:unhandledRejection",t)})),process.on("uncaughtException",(t=>{console.log("outer:uncaughtException",t)})),process.on("uncaughtExceptionMonitor",(t=>{console.log("outer:uncaughtExceptionMonitor",t)}))}catch(t){}return m}()}({get exports(){return r},set exports(t){r=t}});var o=r;let i;return i="undefined"!=typeof window&&void 0!==window.document?o:n,i}(o)}({get exports(){return kn},set exports(t){kn=t}});var Rn=kn;function Nn(){let o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=bt(o,"port");Et(i)||(i=8080);let c=bt(o,"useInert");ae(c)||(c=!0);let a=bt(o,"pathStaticFiles");Rt(a)||(a="dist");let u=bt(o,"apiName");Rt(u)||(u="api");let l=`${u}slc`,s=`${u}dw`,f=bt(o,"pathUploadTemp");Rt(f)||(f="./uploadTemp"),On(f)||function(t){if(On(t))return{success:"input folder is already exists: "+t};if(n.existsSync(t))return{error:"input path already exists: "+t};try{n.mkdirSync(t,{recursive:!0})}catch(t){return{error:t}}}(f);let g=bt(o,"verifyConn");Xt(g)||(g=()=>!0);let d=bt(o,"corsOrigins",[]);ie(d)||(d=["*"]);let p=bt(o,"delayForBasic","");he(p)||(p=0),p=zt(p);let I=bt(o,"delayForSlice","");he(I)||(I=100),I=zt(I);let h=null;h=bt(o,"serverHapi")?o.serverHapi:t.server({port:i,routes:{timeout:{server:!1,socket:!1},cors:{origin:d,credentials:!1}}});let C=se(),b=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];setTimeout((()=>{C.emit(t,...n)}),1)};function v(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=new r.Readable;o._read=()=>{},o.push(e),o.push(null);let i=bt(n,"returnType",""),c=bt(n,"returnMsg","");return t.response(o).header("Return-Type",i).header("Return-Msg",c).header("Cache-Control","no-cache, no-store, must-revalidate").header("Content-Type","application/octet-stream").header("Content-Length",o.readableLength)}function A(t,e){return Rt(e)||(console.log("msg",e),console.log("msg is not an effective string, set msg=''"),e=""),v(t,Vn({error:e}),{returnType:"error",returnMsg:e})}let Z={path:`/${u}`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,output:"stream",parse:!1},timeout:{server:!1,socket:!1}},handler:async function(t,e){let n=bt(t,"headers");n=Ie(n)?n:"";let o=bt(t,"query");o=Ie(o)?o:"";let i=bt(n,"authorization","");i=Rt(i)?i:"";{let t=g({apiType:"main",authorization:i,headers:n,query:o});if(ge(t)&&(t=await t),!0!==t)return A(e,"permission denied")}b("handler",{api:"apiMain",headers:n,query:o});let c=await(()=>{let e=fe(),n=[],o=new r.Writable({write(t,e,r){n.push(t),setTimeout((()=>{r()}),p)}});return t.payload.pipe(o),t.payload.on("end",(()=>{let t=Buffer.concat(n);n=[],e.resolve(t)})),t.payload.on("error",(t=>{b("error","receive payload err"),e.reject(t.message)})),e})(),a=Bn(new Uint8Array(c)),u={},l="",s="";return await async function(t){let e=fe(),n=fe();n.then((n=>{t.output=n,delete t.input,e.resolve(t)})).catch((t=>{e.reject(t)}));{let e=bt(t,"func",""),r=bt(t,"input",null);b("execute",e,r,n)}return e}(a).then((function(t){u.success=t,l="success",s="need to parse"})).catch((function(t){u.error=t,l="error",s="need to parse"})),v(e,Vn(u),{returnType:l,returnMsg:s})}},X={path:`/${l}`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,output:"stream",parse:!1},timeout:{server:!1,socket:!1}},handler:async function(t,e){let r=bt(t,"headers");r=Ie(r)?r:"";let o=bt(t,"query");o=Ie(o)?o:"";let i=bt(r,"authorization","");i=Rt(i)?i:"";{let t=g({apiType:"upload-slice",authorization:i,headers:r,query:o});if(ge(t)&&(t=await t),!0!==t)return A(e,"permission denied")}b("handler",{api:"apiUploadSlice",headers:r,query:o});let c=bt(r,"chunk-index",""),a=bt(r,"chunk-total",""),u=bt(r,"package-id","");if(!he(c))return console.log("invalid chunkIndex in headers"),e.response({error:"invalid chunkIndex in headers"}).code(400);if(c=zt(c),!he(a))return console.log("invalid chunkTotal in headers"),e.response({error:"invalid chunkTotal in headers"}).code(400);if(a=zt(a),!Rt(u))return console.log("invalid packageId in headers"),e.response({error:"invalid packageId in headers"}).code(400);let l=`${f}/${u}_${c}`,s=n.createWriteStream(l),d={},p="",h="";return await(()=>{let e=fe();return t.payload.pipe(s),t.payload.on("end",(()=>{setTimeout((()=>{e.resolve(`chunk[${c}/${a}] of packageId[${u}] done`)}),I)})),t.payload.on("error",(()=>{b("error",`receive chunk[${c+1}/${a}] err`),e.reject(`chunk[${c}/${a}] of packageId[${u}] err`)})),e})().then((function(t){d.success=t,p="success",h="need to parse"})).catch((function(t){d.error=t,p="error",h="need to parse"})),v(e,Vn(d),{returnType:p,returnMsg:h})}},K={path:`/${l}m`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,parse:!0},timeout:{server:!1,socket:!1}},handler:async function(t,e){let n=bt(t,"headers");n=Ie(n)?n:"";let r=bt(t,"query");r=Ie(r)?r:"";let o=bt(n,"authorization","");o=Rt(o)?o:"";{let t=g({apiType:"upload-slice-merge",authorization:o,headers:n,query:r});if(ge(t)&&(t=await t),!0!==t)return A(e,"permission denied")}b("handler",{api:"apiUploadSliceMerge",headers:n,query:r});let i=bt(t,"payload.filename",""),c=bt(t,"payload.chunk-total",""),a=bt(t,"payload.package-id","");if(!Rt(i))return console.log("invalid filename in payload"),e.response({error:"invalid filename in payload"}).code(400);if(!he(c))return console.log("invalid chunkTotal in payload"),e.response({error:"invalid chunkTotal in payload"}).code(400);if(c=zt(c),!Rt(a))return console.log("invalid packageId in payload"),e.response({error:"invalid packageId in payload"}).code(400);let u={},l="",s="";return await(async()=>{let t=await Rn(f,a,c,i);return await async function(t){let e=fe(),n=fe();return n.then((t=>{e.resolve(t)})).catch((t=>{e.reject(t)})),b("upload",t,n),e}(t)})().then((function(t){u.success=t,l="success",s="need to parse"})).catch((function(t){u.error=t,l="error",s="need to parse"})),v(e,Vn(u),{returnType:l,returnMsg:s})}},w={path:`/${s}`,method:"POST",options:{payload:{maxBytes:1099511627776,maxParts:1e9,timeout:!1,parse:!0},timeout:{server:!1,socket:!1}},handler:async function(t,e){let n=bt(t,"headers");n=Ie(n)?n:"";let r=bt(t,"query");r=Ie(r)?r:"";let o=bt(n,"authorization","");o=Rt(o)?o:"";{let t=g({apiType:"download",authorization:o,headers:n,query:r});if(ge(t)&&(t=await t),!0!==t)return A(e,"permission denied")}b("handler",{api:"apiDownload",headers:n,query:r});let i=bt(t,"payload.fileId","");if(!Rt(i))return A(e,"invalid fileId in payload");let c={fileId:i},a={};if(await async function(t){let e=fe(),n=fe();return n.then((t=>{e.resolve(t)})).catch((t=>{e.reject(t)})),b("download",t,n),e}(c).then((function(t){a.success=t})).catch((function(t){a.error=t})),je(a,"error"))return A(e,"can not get file from fileId");let u=bt(a,"success"),l=bt(u,"streamRead"),s=bt(u,"fileName");if(!Rt(s))return A(e,"invalid fileName");s=we(s);let f=bt(u,"fileSize");if(!("number"==typeof(d=f)||m(d)&&y(d)==pe))return A(e,"invalid fileSize");var d;let p=bt(u,"fileType");return Rt(p)?(p=Ce(p),e.response(l).type(p).header("Content-Disposition",`attachment; filename="${s}"`).header("Content-Length",f)):A(e,"invalid fileType")}};bt(o,"serverHapi")?h.route([Z,X,K,w]):async function(){c&&await h.register(e);let t=[];if(c){let e={method:"GET",path:"/{file*}",handler:{directory:{path:`${a}/`}}};t=[...t,e]}t=[...t,Z,X,K,w],h.route(t),await h.start(),console.log(`Server running at: ${h.info.uri}`)}();return C.stop=()=>{h.stop()},C}function Pn(t){return Pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pn(t)}function Qn(t){var e=function(t,e){if("object"!==Pn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Pn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===Pn(e)?e:String(e)}function Ln(t,e,n){return(e=Qn(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _n=function(){return u.Date.now()},Fn="Expected a function",Un=Math.max,Mn=Math.min;function zn(t,e,n){var r,o,i,c,a,u,l=0,s=!1,f=!1,g=!0;if("function"!=typeof t)throw new TypeError(Fn);function d(e){var n=r,i=o;return r=o=void 0,l=e,c=t.apply(i,n)}function p(t){var n=t-u;return void 0===u||n>=e||n<0||f&&t-l>=i}function I(){var t=_n();if(p(t))return h(t);a=setTimeout(I,function(t){var n=e-(t-u);return f?Mn(n,i-(t-l)):n}(t))}function h(t){return a=void 0,g&&r?d(t):(r=o=void 0,c)}function C(){var t=_n(),n=p(t);if(r=arguments,o=this,u=t,n){if(void 0===a)return function(t){return l=t,a=setTimeout(I,e),s?d(t):c}(u);if(f)return clearTimeout(a),a=setTimeout(I,e),d(u)}return void 0===a&&(a=setTimeout(I,e)),c}return e=Yt(e)||0,K(n)&&(s=!!n.leading,i=(f="maxWait"in n)?Un(Yt(n.maxWait)||0,e):i,g="trailing"in n?!!n.trailing:g),C.cancel=function(){void 0!==a&&clearTimeout(a),l=0,r=u=o=a=void 0},C.flush=function(){return void 0===a?c:h(_n())},C}function En(t){var e=this.__data__=new D(t);this.size=e.size}En.prototype.clear=function(){this.__data__=new D,this.size=0},En.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},En.prototype.get=function(t){return this.__data__.get(t)},En.prototype.has=function(t){return this.__data__.has(t)},En.prototype.set=function(t,e){var n=this.__data__;if(n instanceof D){var r=n.__data__;if(!$||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new tt(r)}return n.set(t,e),this.size=n.size,this};var Dn=function(){try{var t=Q(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),$n=Dn;function qn(t,e,n){"__proto__"==e&&$n?$n(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function tr(t,e,n){(void 0!==n&&!M(t[e],n)||void 0===n&&!(e in t))&&qn(t,e,n)}var er="object"==typeof exports&&exports&&!exports.nodeType&&exports,nr=er&&"object"==typeof module&&module&&!module.nodeType&&module,rr=nr&&nr.exports===er?u.Buffer:void 0,or=rr?rr.allocUnsafe:void 0;function ir(t,e){if(e)return t.slice();var n=t.length,r=or?or(n):new t.constructor(n);return t.copy(r),r}var cr=u.Uint8Array;function ar(t){var e=new t.constructor(t.byteLength);return new cr(e).set(new cr(t)),e}function ur(t,e){var n=e?ar(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function lr(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var sr=Object.create,fr=function(){function t(){}return function(e){if(!K(e))return{};if(sr)return sr(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),gr=fr;function dr(t){return"function"!=typeof t.constructor||rn(t)?{}:gr(mn(t))}function pr(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Ir=Object.prototype.hasOwnProperty;function hr(t,e,n){var r=t[e];Ir.call(t,e)&&M(r,n)&&(void 0!==n||e in t)||qn(t,e,n)}function Cr(t,e,n,r){var o=!n;n||(n={});for(var i=-1,c=e.length;++i<c;){var a=e[i],u=r?r(n[a],t[a],a,n,t):void 0;void 0===u&&(u=t[a]),o?qn(n,a,u):hr(n,a,u)}return n}var yr=Object.prototype.hasOwnProperty;function mr(t){if(!K(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=rn(t),n=[];for(var r in t)("constructor"!=r||!e&&yr.call(t,r))&&n.push(r);return n}function br(t){return ln(t)?en(t,!0):mr(t)}function vr(t,e,n,r,o,c,a){var u=pr(t,n),l=pr(e,n),s=a.get(l);if(s)tr(t,n,s);else{var f,g=c?c(u,l,n+"",t,e,a):void 0,d=void 0===g;if(d){var p=i(l),I=!p&&Re(l),h=!p&&!I&&qe(l);g=l,p||I||h?i(u)?g=u:m(f=u)&&ln(f)?g=lr(u):I?(d=!1,g=ir(l,!0)):h?(d=!1,g=ur(l,!0)):g=[]:wn(l)||Te(l)?(g=u,Te(u)?g=function(t){return Cr(t,br(t))}(u):K(u)&&!S(u)||(g=dr(l))):d=!1}d&&(a.set(l,g),o(g,l,r,c,a),a.delete(l)),tr(t,n,g)}}function Ar(t,e,n,r,o){t!==e&&Se(e,(function(i,c){if(o||(o=new En),K(i))vr(t,e,c,n,Ar,r,o);else{var a=r?r(pr(t,c),i,c+"",t,e,o):void 0;void 0===a&&(a=i),tr(t,c,a)}}),br)}var Zr=Math.max;var Xr=$n?function(t,e){return $n(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:dn,Kr=Xr,wr=Date.now;var jr=function(t){var e=0,n=0;return function(){var r=wr(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Kr),Wr=jr;function Gr(t,e){return Wr(function(t,e,n){return e=Zr(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,i=Zr(r.length-e,0),c=Array(i);++o<i;)c[o]=r[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=r[o];return a[e]=n(c),function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}(t,this,a)}}(t,e,dn),t+"")}var Sr,Hr=(Sr=function(t,e,n){Ar(t,e,n)},Gr((function(t,e){var n=-1,r=e.length,o=r>1?e[r-1]:void 0,i=r>2?e[2]:void 0;for(o=Sr.length>3&&"function"==typeof o?(r--,o):void 0,i&&function(t,e,n){if(!K(n))return!1;var r=typeof e;return!!("number"==r?ln(n)&&Qe(e,n.length):"string"==r&&e in n)&&M(n[e],t)}(e[0],e[1],i)&&(o=r<3?void 0:o,r=1),t=Object(t);++n<r;){var c=e[n];c&&Sr(t,c,n,o)}return t})));function Vr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={};if(Ie(t)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),t=se()),!je(t,"emit"))throw new Error("instWConverServer is not an EventEmitter");let o=bt(e,"fpTableTags","");Rt(o)||(o="./tableTags.json");let i=bt(e,"genTag");Xt(i)||(i=()=>Kt()+"|"+qt(6));let c=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];setTimeout((()=>{t.emit(e,...r)}),1)};function a(){let t={};try{if(n.existsSync(o)){let e=function(t){if(!Rt(t))return{};let e={};try{e=JSON.parse(t)}catch(t){e={}}return e}(n.readFileSync(o,"utf8"));Ie(e)&&(t=e)}}catch(t){c("error",{msg:"readTableTags catch",err:t})}return t}function u(){try{let t=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(ee(t))return"";let n="";try{n=e?JSON.stringify(t,null,2):JSON.stringify(t)}catch(t){n=""}return n}(r);n.writeFileSync(o,t,"utf8")}catch(t){c("error",{msg:"writeTableTags catch",err:t})}}let l=zn((()=>{u(),c("changeTableTags",r)}),200);return t.readTableTags=a,t.writeTableTags=u,t.initTableTags=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"useInputFirst";if("useInputOnly"===e)r=t;else if("useStorageOnly"===e)r=a();else if("useInputFirst"===e)r=Hr(a(),t);else{if("useStorageFirst"!==e)throw new Error(`invalid mode[${e}]`);r=Hr(t,a())}u()},t.setTableTags=function(){r=Hr(r,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),u()},t.getTableTags=function(){return r},t.updateTableTag=function(t){r[t]=i(),l()},t}function xr(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new tt;++e<n;)this.add(t[e])}function Yr(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}function Jr(t,e){return t.has(e)}xr.prototype.add=xr.prototype.push=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this},xr.prototype.has=function(t){return this.__data__.has(t)};var Tr=1,Br=2;function Or(t,e,n,r,o,i){var c=n&Tr,a=t.length,u=e.length;if(a!=u&&!(c&&u>a))return!1;var l=i.get(t),s=i.get(e);if(l&&s)return l==e&&s==t;var f=-1,g=!0,d=n&Br?new xr:void 0;for(i.set(t,e),i.set(e,t);++f<a;){var p=t[f],I=e[f];if(r)var h=c?r(I,p,f,e,t,i):r(p,I,f,t,e,i);if(void 0!==h){if(h)continue;g=!1;break}if(d){if(!Yr(e,(function(t,e){if(!Jr(d,e)&&(p===t||o(p,t,n,r,i)))return d.push(e)}))){g=!1;break}}else if(p!==I&&!o(p,I,n,r,i)){g=!1;break}}return i.delete(t),i.delete(e),g}function kr(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function Rr(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}var Nr=1,Pr=2,Qr="[object Boolean]",Lr="[object Date]",_r="[object Error]",Fr="[object Map]",Ur="[object Number]",Mr="[object RegExp]",zr="[object Set]",Er="[object String]",Dr="[object Symbol]",$r="[object ArrayBuffer]",qr="[object DataView]",to=l?l.prototype:void 0,eo=to?to.valueOf:void 0;function no(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}function ro(t,e,n){var r=e(t);return i(t)?r:no(r,n(t))}function oo(){return[]}var io=Object.prototype.propertyIsEnumerable,co=Object.getOwnPropertySymbols,ao=co?function(t){return null==t?[]:(t=Object(t),function(t,e){for(var n=-1,r=null==t?0:t.length,o=0,i=[];++n<r;){var c=t[n];e(c,n,t)&&(i[o++]=c)}return i}(co(t),(function(e){return io.call(t,e)})))}:oo,uo=ao;function lo(t){return ro(t,sn,uo)}var so=1,fo=Object.prototype.hasOwnProperty;var go=Q(u,"DataView"),po=Q(u,"Promise"),Io=Q(u,"Set"),ho=Q(u,"WeakMap"),Co="[object Map]",yo="[object Promise]",mo="[object Set]",bo="[object WeakMap]",vo="[object DataView]",Ao=J(go),Zo=J($),Xo=J(po),Ko=J(Io),wo=J(ho),jo=y;(go&&jo(new go(new ArrayBuffer(1)))!=vo||$&&jo(new $)!=Co||po&&jo(po.resolve())!=yo||Io&&jo(new Io)!=mo||ho&&jo(new ho)!=bo)&&(jo=function(t){var e=y(t),n="[object Object]"==e?t.constructor:void 0,r=n?J(n):"";if(r)switch(r){case Ao:return vo;case Zo:return Co;case Xo:return yo;case Ko:return mo;case wo:return bo}return e});var Wo=jo,Go=1,So="[object Arguments]",Ho="[object Array]",Vo="[object Object]",xo=Object.prototype.hasOwnProperty;function Yo(t,e,n,r,o,c){var a=i(t),u=i(e),l=a?Ho:Wo(t),s=u?Ho:Wo(e),f=(l=l==So?Vo:l)==Vo,g=(s=s==So?Vo:s)==Vo,d=l==s;if(d&&Re(t)){if(!Re(e))return!1;a=!0,f=!1}if(d&&!f)return c||(c=new En),a||qe(t)?Or(t,e,n,r,o,c):function(t,e,n,r,o,i,c){switch(n){case qr:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case $r:return!(t.byteLength!=e.byteLength||!i(new cr(t),new cr(e)));case Qr:case Lr:case Ur:return M(+t,+e);case _r:return t.name==e.name&&t.message==e.message;case Mr:case Er:return t==e+"";case Fr:var a=kr;case zr:var u=r&Nr;if(a||(a=Rr),t.size!=e.size&&!u)return!1;var l=c.get(t);if(l)return l==e;r|=Pr,c.set(t,e);var s=Or(a(t),a(e),r,o,i,c);return c.delete(t),s;case Dr:if(eo)return eo.call(t)==eo.call(e)}return!1}(t,e,l,n,r,o,c);if(!(n&Go)){var p=f&&xo.call(t,"__wrapped__"),I=g&&xo.call(e,"__wrapped__");if(p||I){var h=p?t.value():t,C=I?e.value():e;return c||(c=new En),o(h,C,n,r,c)}}return!!d&&(c||(c=new En),function(t,e,n,r,o,i){var c=n&so,a=lo(t),u=a.length;if(u!=lo(e).length&&!c)return!1;for(var l=u;l--;){var s=a[l];if(!(c?s in e:fo.call(e,s)))return!1}var f=i.get(t),g=i.get(e);if(f&&g)return f==e&&g==t;var d=!0;i.set(t,e),i.set(e,t);for(var p=c;++l<u;){var I=t[s=a[l]],h=e[s];if(r)var C=c?r(h,I,s,e,t,i):r(I,h,s,t,e,i);if(!(void 0===C?I===h||o(I,h,n,r,i):C)){d=!1;break}p||(p="constructor"==s)}if(d&&!p){var y=t.constructor,m=e.constructor;y==m||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m||(d=!1)}return i.delete(t),i.delete(e),d}(t,e,n,r,o,c))}function Jo(t,e,n,r,o){return t===e||(null==t||null==e||!m(t)&&!m(e)?t!=t&&e!=e:Yo(t,e,n,r,Jo,o))}var To=1,Bo=2;function Oo(t){return t==t&&!K(t)}function ko(t,e){return function(n){return null!=n&&(n[t]===e&&(void 0!==e||t in Object(n)))}}function Ro(t){var e=function(t){for(var e=sn(t),n=e.length;n--;){var r=e[n],o=t[r];e[n]=[r,o,Oo(o)]}return e}(t);return 1==e.length&&e[0][2]?ko(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var o=n.length,i=o,c=!r;if(null==t)return!i;for(t=Object(t);o--;){var a=n[o];if(c&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++o<i;){var u=(a=n[o])[0],l=t[u],s=a[1];if(c&&a[2]){if(void 0===l&&!(u in t))return!1}else{var f=new En;if(r)var g=r(l,s,u,t,e,f);if(!(void 0===g?Jo(s,l,To|Bo,r,f):g))return!1}}return!0}(n,t,e)}}function No(t,e){return null!=t&&e in Object(t)}function Po(t,e){return null!=t&&function(t,e,n){for(var r=-1,o=(e=ht(e,t)).length,c=!1;++r<o;){var a=yt(e[r]);if(!(c=null!=t&&n(t,a)))break;t=t[a]}return c||++r!=o?c:!!(o=null==t?0:t.length)&&_e(o)&&Qe(a,o)&&(i(t)||Te(t))}(t,e,No)}var Qo=1,Lo=2;function _o(t){return function(e){return null==e?void 0:e[t]}}function Fo(t){return X(t)?_o(yt(t)):function(t){return function(e){return mt(e,t)}}(t)}function Uo(t){return"function"==typeof t?t:null==t?dn:"object"==typeof t?i(t)?(e=t[0],n=t[1],X(e)&&Oo(n)?ko(yt(e),n):function(t){var r=bt(t,e);return void 0===r&&r===n?Po(t,e):Jo(n,r,Qo|Lo)}):Ro(t):Fo(t);var e,n}function Mo(t,e){var n=-1,r=ln(t)?Array(t.length):[];return gn(t,(function(t,o,i){r[++n]=e(t,o,i)})),r}var zo=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)no(e,uo(t)),t=mn(t);return e}:oo,Eo=zo;function Do(t){return ro(t,br,Eo)}var $o=Object.prototype.hasOwnProperty;var qo=/\w*$/;var ti=l?l.prototype:void 0,ei=ti?ti.valueOf:void 0;var ni="[object Boolean]",ri="[object Date]",oi="[object Map]",ii="[object Number]",ci="[object RegExp]",ai="[object Set]",ui="[object String]",li="[object Symbol]",si="[object ArrayBuffer]",fi="[object DataView]",gi="[object Float32Array]",di="[object Float64Array]",pi="[object Int8Array]",Ii="[object Int16Array]",hi="[object Int32Array]",Ci="[object Uint8Array]",yi="[object Uint8ClampedArray]",mi="[object Uint16Array]",bi="[object Uint32Array]";function vi(t,e,n){var r,o=t.constructor;switch(e){case si:return ar(t);case ni:case ri:return new o(+t);case fi:return function(t,e){var n=e?ar(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case gi:case di:case pi:case Ii:case hi:case Ci:case yi:case mi:case bi:return ur(t,n);case oi:return new o;case ii:case ui:return new o(t);case ci:return function(t){var e=new t.constructor(t.source,qo.exec(t));return e.lastIndex=t.lastIndex,e}(t);case ai:return new o;case li:return r=t,ei?Object(ei.call(r)):{}}}var Ai=De&&De.isMap,Zi=Ai?Ue(Ai):function(t){return m(t)&&"[object Map]"==Wo(t)};var Xi=De&&De.isSet,Ki=Xi?Ue(Xi):function(t){return m(t)&&"[object Set]"==Wo(t)},wi=1,ji=2,Wi=4,Gi="[object Arguments]",Si="[object Function]",Hi="[object GeneratorFunction]",Vi="[object Object]",xi={};function Yi(t,e,n,r,o,c){var a,u=e&wi,l=e&ji,s=e&Wi;if(n&&(a=o?n(t,r,o,c):n(t)),void 0!==a)return a;if(!K(t))return t;var f=i(t);if(f){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&$o.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!u)return lr(t,a)}else{var g=Wo(t),d=g==Si||g==Hi;if(Re(t))return ir(t,u);if(g==Vi||g==Gi||d&&!o){if(a=l||d?{}:dr(t),!u)return l?function(t,e){return Cr(t,Eo(t),e)}(t,function(t,e){return t&&Cr(e,br(e),t)}(a,t)):function(t,e){return Cr(t,uo(t),e)}(t,function(t,e){return t&&Cr(e,sn(e),t)}(a,t))}else{if(!xi[g])return o?t:{};a=vi(t,g,u)}}c||(c=new En);var p=c.get(t);if(p)return p;c.set(t,a),Ki(t)?t.forEach((function(r){a.add(Yi(r,e,n,r,t,c))})):Zi(t)&&t.forEach((function(r,o){a.set(o,Yi(r,e,n,o,t,c))}));var I=f?void 0:(s?l?Do:lo:l?br:sn)(t);return We(I||t,(function(r,o){I&&(r=t[o=r]),hr(a,o,Yi(r,e,n,o,t,c))})),a}xi[Gi]=xi["[object Array]"]=xi["[object ArrayBuffer]"]=xi["[object DataView]"]=xi["[object Boolean]"]=xi["[object Date]"]=xi["[object Float32Array]"]=xi["[object Float64Array]"]=xi["[object Int8Array]"]=xi["[object Int16Array]"]=xi["[object Int32Array]"]=xi["[object Map]"]=xi["[object Number]"]=xi[Vi]=xi["[object RegExp]"]=xi["[object Set]"]=xi["[object String]"]=xi["[object Symbol]"]=xi["[object Uint8Array]"]=xi["[object Uint8ClampedArray]"]=xi["[object Uint16Array]"]=xi["[object Uint32Array]"]=!0,xi["[object Error]"]=xi[Si]=xi["[object WeakMap]"]=!1;var Ji=1,Ti=4;function Bi(t){return Yi(t,Ji|Ti)}var Oi="[object String]";var ki=_o("length"),Ri=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var Ni="\\ud800-\\udfff",Pi="["+Ni+"]",Qi="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Li="\\ud83c[\\udffb-\\udfff]",_i="[^"+Ni+"]",Fi="(?:\\ud83c[\\udde6-\\uddff]){2}",Ui="[\\ud800-\\udbff][\\udc00-\\udfff]",Mi="(?:"+Qi+"|"+Li+")"+"?",zi="[\\ufe0e\\ufe0f]?",Ei=zi+Mi+("(?:\\u200d(?:"+[_i,Fi,Ui].join("|")+")"+zi+Mi+")*"),Di="(?:"+[_i+Qi+"?",Qi,Fi,Ui,Pi].join("|")+")",$i=RegExp(Li+"(?="+Li+")|"+Di+Ei,"g");function qi(t){return function(t){return Ri.test(t)}(t)?function(t){for(var e=$i.lastIndex=0;$i.test(t);)++e;return e}(t):ki(t)}var tc="[object Map]",ec="[object Set]";function nc(t){if(null==t)return 0;if(ln(t))return"string"==typeof(e=t)||!i(e)&&m(e)&&y(e)==Oi?qi(t):t.length;var e,n=Wo(t);return n==tc||n==ec?t.size:un(t).length}function rc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=se(),n={},r=null,o=bt(t,"timeAlive");Et(o)||(o=1e4),o=zt(o);let i=bt(t,"timeDetect");return Et(i)||(i=50),i=zt(i),e.trigger=function(t,c){Rt(t)?(je(n,t)||setTimeout((()=>{e.emit("message",{eventName:"enter",key:t,data:c,now:nc(n)})}),1),n[t]={data:c,time:Date.now()},null===r&&(r=setInterval((()=>{pn(n,((t,r)=>{if(Date.now()-t.time>o){let t=Bi(n[r]);delete n[r],e.emit("message",{eventName:"leave",key:r,data:t.data,now:nc(n)})}})),Ie(n)||(clearInterval(r),r=null)}),i))):console.log("trigger need key")},e.get=function(){let t=[];return pn(n,((e,n)=>{t.push({key:n,data:e.data})})),t=Bi(t),t},e}function oc(t){let e={};if(Ie(t)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),t=se()),!je(t,"emit"))throw new Error("instWConverServer is not an EventEmitter");let n=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];setTimeout((()=>{t.emit(e,...r)}),1)},r=rc(),o=setInterval((()=>{let t=r.get(),n=(c="key",(i(o=t)?st:Mo)(o,Uo(c)));var o,c;let a={};pn(n,(t=>{a[t]=bt(e,t,[])})),e=a}),1e3);r.on("message",(function(t){let{eventName:e,key:r,data:o,now:i}=t;"enter"===e?n("clientEnter",r,o):"leave"===e&&n("clientLeave",r,o),n("clientChange",i)})),t.on("execute",(function(t,o,i){if("[sys:polling]"===t)try{let t=bt(o,"clientId",""),n=bt(e,t,[]);n=Bi(n),e[t]=[],r.trigger(t,o),i.resolve(n)}catch(t){n("error",t),i.reject("[sys:polling] error")}}));return t.getClients=r.get,t.getMessages=()=>Bi(e),t.broadcast=t=>{if(!Ie(e))return;let n={};pn(e,((e,r)=>{e.push({mode:"broadcast",data:t}),n[r]=e})),e=n},t.clearBroadcast=()=>{clearInterval(o)},t}let ic=(t,e)=>{let n={};return pn(t,(t=>{let r=t,o=bt(e,t,"");Rt(o)&&(n[r]=o)})),n};function cc(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(!Ie(t))throw new Error("invalid instWConverServer");if(0===nc(e))return t;if(!Ie(n))return t;let o=bt(r,"genTag");Xt(o)||(o=()=>Kt()+"|"+qt(6));let i={};return pn(e,(t=>{i[t]=o()})),t.initTableTags(i,"useInputOnly"),pn(e,(e=>{let r=n[e];if(!r)throw new Error(`invalid kpOrm[${e}]`);try{r.on("change",(()=>{t.updateTableTag(e)}))}catch(t){throw new Error(`kpOrm[${e}] can not listen to change events`)}})),t.on("changeTableTags",(n=>{t.broadcast({mode:"syncKpTable",data:ic(e,n)})})),t}function ac(t){return t!=t}function uc(t,e,n){return e==e?function(t,e,n){for(var r=n-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}(t,e,n):function(t,e,n,r){for(var o=t.length,i=n+(r?1:-1);r?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,ac,n)}function lc(t,e,n,r){for(var o=n-1,i=t.length;++o<i;)if(r(t[o],e))return o;return-1}var sc=Array.prototype.splice;function fc(t,e){return t&&t.length&&e&&e.length?function(t,e,n,r){var o=r?lc:uc,i=-1,c=e.length,a=t;for(t===e&&(e=lr(e)),n&&(a=st(t,Ue(n)));++i<c;)for(var u=0,l=e[i],s=n?n(l):l;(u=o(a,s,u,r))>-1;)a!==t&&sc.call(a,u,1),sc.call(t,u,1);return t}(t,e):t}let gc=function(t){if(!Xt(t))throw new Error("fn is not a function");return function(){let e=fe(),n=null,r=null;try{n=t.apply(this,arguments)}catch(t){r=t}return null!==r?e.resolve({state:"error",msg:r}):ge(n)?n.then((t=>{e.resolve({state:"success",msg:t})})).catch((t=>{"cancelled"===bt(t,"reason")?e.resolve({state:"cancelled",msg:""}):e.resolve({state:"error",msg:t})})):e.resolve({state:"success",msg:n}),e}};function dc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Ie(t))throw new Error("invalid instWConverServer");let n=bt(e,"getUserIdByToken",null);Xt(n)||(n=async()=>"");let r=bt(e,"useDbOrm",null);ae(r)||(r=!1);let o=null;if(r&&(o=bt(e,"operOrm",null),!Xt(o)))throw new Error("invalid opt.operOrm when useDbOrm=true");let i=[];if(r&&(i=bt(e,"tableNames",null),!te(i)))throw new Error("invalid opt.tableNames when useDbOrm=true");let c=[];r&&(c=bt(e,"methods",null),te(c)||(c=["select","insert","save","del"]));let a=bt(e,"kpFunExt",null);let u={};async function l(t,e,r){let o="";if(!je(e,"__sysToken__"))return r.resolve({state:"error",msg:"invalid token"}),r;if(o=Ce(e.__sysToken__),!je(e,"__sysInputArgs__"))return r.resolve({state:"error",msg:"invalid input"}),r;e=e.__sysInputArgs__;let i="";if(i=n(o),ge(i)&&(i=await i),Rt(i)||(i=""),"[sys:getFuncList]"===t){let t=sn(u);t=function(t,e){if(!ie(t))return[];if((ne(e)||Pt(e)||kt(e)||ae(e))&&(e=[e]),!ie(e))return t;let n=Bi(t);return fc(n,e),n}(t,"[sys:getTableTags]");let e={state:"success",msg:t};return r.resolve(e),r}if(!je(u,t))return r.resolve({state:"error",msg:`invalid func[${t}]`}),r;let c=u[t];try{let t=await gc(c)(i,...e);r.resolve(t)}catch(e){r.resolve({state:"error",msg:`call func[${t}] has an error: ${e.message}`})}return r}return r&&(i=Bi(i),u=function(t,e,n){let r={};return pn(t,(t=>{pn(e,(e=>{r[`${t}.${e}`]=async function(r,o){return await n(r,t,e,o)}}))})),r}(i,c,o)),Ie(a)&&pn(a,((t,e)=>{u[e]=t})),t.on("execute",(async function(e,n,r){await l(e,n,r).catch((n=>{t.emit("error",n),r.resolve({state:"error",msg:`execFun func[${e}] has an error: ${n.message}`})}))})),t}function pc(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ic(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pc(Object(n),!0).forEach((function(e){Ln(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pc(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Ie(t)||(console.log("instWConverServer is not an effective object, and set instWConverServer to an EventEmitter"),t=se()),!je(t,"emit"))throw new Error("instWConverServer is not an EventEmitter");let n=bt(e,"fpTableTags",null);Rt(n)||(n="./tableTags.json");let r=bt(e,"genTag");Xt(r)||(r=()=>Kt()+"|"+qt(6)),t=new oc(t=new Vr(t,{fpTableTags:n,genTag:r}));let o=bt(e,"useDbOrm",null);ae(o)||(o=!0);let i=bt(e,"kpOrm",null),c=bt(e,"operOrm",null),a=bt(e,"tableNamesExec",null),u=bt(e,"methodsExec",null),l=bt(e,"tableNamesSync",null),s=bt(e,"getUserIdByToken",null),f=bt(e,"kpFunExt",null);if(Ie(f)||(f={}),f=Ic(Ic({},f),{},{"[sys:getTableTags]":()=>{let e=t.getTableTags();return{mode:"syncKpTable",data:ic(l,e)}}}),t=new dc(t,{getUserIdByToken:s,useDbOrm:o,operOrm:c,tableNames:a,methods:u,kpFunExt:f}),o){if(!ne(i))return t.emit("error","invalid opt.kpOrm when useDbOrm=true"),t;t=new cc(t,l,i,{genTag:r})}return t}return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=se(),o=null,i=null,c=bt(n,"port");Lt(c)||(c=8080);let a=bt(n,"corsOrigins",[]);ie(a)||(a=["http://localhost"]);let u=bt(n,"useInert");ae(u)||(u=!0);let l=bt(n,"pathStaticFiles");Rt(l)||(l="dist");let s=bt(n,"apis");ie(s)||(s=[]);let f=bt(n,"verifyConn");Xt(f)||(f=()=>!0);let g=bt(n,"apiName");Rt(g)||(g="api");let d=bt(n,"getUserIdByToken",null),p=bt(n,"useDbOrm",null);ae(p)||(p=!0);let I=bt(n,"kpOrm",null),h=bt(n,"operOrm",null),C=bt(n,"tableNamesExec",null),y=bt(n,"methodsExec",null),m=bt(n,"tableNamesSync",null),b=bt(n,"kpFunExt",null),v=bt(n,"fnTableTags",null),A=bt(n,"genTag");Xt(A)||(A=()=>Kt()+"|"+qt(6));let Z=bt(n,"showLog");return ae(Z)||(Z=!0),(async()=>{await(async()=>{o=new t.Server({port:c,routes:{timeout:{server:!1,socket:!1},cors:{origin:a,credentials:!1}}}),u&&await o.register(e);let n=[];u&&(n=[{method:"GET",path:"/{file*}",handler:{directory:{path:`${l}/`}}}]),n=[...n,...s],o.route(n)})(),await(async()=>{i=new Nn({serverHapi:o,verifyConn:f,apiName:g}),i.on("open",(function(){Z&&console.log(`Server[port:${c}]: open`)})),i.on("clientChange",(function(t){Z&&console.log(`Server[port:${c}]: now clients: ${t}`)}))})(),await(async()=>{i=new hc(i,{getUserIdByToken:d,useDbOrm:p,kpOrm:I,operOrm:h,tableNamesExec:C,tableNamesSync:m,methodsExec:y,kpFunExt:b,fnTableTags:v,genTag:A}),i.on("error",(t=>{r.emit("error",t)}))})(),await o.start(),Z&&console.log(`Server running at: ${o.info.uri}`)})().catch((t=>{r.emit("error",t)})),process.on("unhandledRejection",(t=>{console.log("unhandledRejection",t),r.emit("error",{mode:"unhandledRejection",err:t})})),process.on("uncaughtException",(t=>{console.log("uncaughtException",t),r.emit("error",{mode:"uncaughtException",err:t})})),r.getServer=async()=>(await de((()=>null!==o)),o),r.getInstWConverServer=async()=>(await de((()=>null!==i)),i),r}}));
//# sourceMappingURL=w-serv-hapi-server.umd.js.map
